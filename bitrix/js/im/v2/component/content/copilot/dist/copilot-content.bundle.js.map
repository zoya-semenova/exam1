{"version":3,"file":"copilot-content.bundle.js","sources":["../src/components/add-to-chat-hint.js","../src/components/chat-header.js","../src/components/empty-state.js","../src/components/textarea.js","../src/classes/message-menu.js","../src/components/message-list.js","../src/components/dialog.js","../src/copilot-content.js"],"sourcesContent":["import { PopupOptions } from 'main.popup';\n\nimport { MessengerPopup } from 'im.v2.component.elements';\n\nimport '../css/add-to-chat-hint.css';\n\nconst POPUP_ID = 'im-add-to-chat-hint-popup';\n\n// @vue/component\nexport const AddToChatHint = {\n\tname: 'AddToChatHint',\n\tcomponents: { MessengerPopup },\n\tprops:\n\t{\n\t\tbindElement: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close', 'hide'],\n\tcomputed:\n\t{\n\t\tPOPUP_ID: () => POPUP_ID,\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tdarkMode: true,\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\tangle: true,\n\t\t\t\twidth: 346,\n\t\t\t\tcloseIcon: true,\n\t\t\t\toffsetLeft: 8,\n\t\t\t\tclassName: 'bx-im-copilot-add-to-chat-hint__scope',\n\t\t\t\tcontentBorderRadius: 0,\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessengerPopup\n\t\t\tv-slot=\"{enableAutoHide, disableAutoHide}\"\n\t\t\t:config=\"config\"\n\t\t\t@close=\"$emit('close')\"\n\t\t\t:id=\"POPUP_ID\"\n\t\t>\n\t\t\t<div class=\"bx-im-copilot-add-to-chat-hint__title\">\n\t\t\t\t{{ loc('IM_CONTENT_COPILOT_ADD_TO_CHAT_HINT_TITLE') }}\n\t\t\t</div>\n\t\t\t<br />\n\t\t\t<div class=\"bx-im-copilot-add-to-chat-hint__description\">\n\t\t\t\t{{ loc('IM_CONTENT_COPILOT_ADD_TO_CHAT_HINT_DESCRIPTION') }}\n\t\t\t</div>\n\t\t\t<br />\n\t\t\t<button class=\"bx-im-copilot-add-to-chat-hint__hide\" @click=\"$emit('hide')\">\n\t\t\t\t{{ loc('IM_CONTENT_COPILOT_ADD_TO_CHAT_HINT_HIDE') }}\n\t\t\t</button>\n\t\t</MessengerPopup>\n\t`,\n};\n","import 'ui.notification';\nimport { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { PromoManager } from 'im.v2.lib.promo';\nimport { ChatService } from 'im.v2.provider.service';\nimport { AddToChat } from 'im.v2.component.entity-selector';\nimport { EditableChatTitle, AvatarSize, ChatAvatar } from 'im.v2.component.elements';\nimport { EventType, PromoId, SidebarDetailBlock } from 'im.v2.const';\n\nimport { AddToChatHint } from './add-to-chat-hint';\n\nimport '../css/chat-header.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat } from 'im.v2.model';\n\n// @vue/component\nexport const ChatHeader = {\n\tname: 'ChatHeader',\n\tcomponents: { EditableChatTitle, AddToChat, ChatAvatar, AddToChatHint },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcurrentSidebarPanel: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t\tshowAddToChatHint: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tuserCounter(): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural('IM_CONTENT_COPILOT_HEADER_USER_COUNT', this.dialog.userCounter, {\n\t\t\t\t'#COUNT#': this.dialog.userCounter,\n\t\t\t});\n\t\t},\n\t\tisInited(): boolean\n\t\t{\n\t\t\treturn this.dialog.inited;\n\t\t},\n\t\tisGroupCopilotChat(): boolean\n\t\t{\n\t\t\treturn this.dialog.userCounter > 2;\n\t\t},\n\t\tisSidebarOpened(): boolean\n\t\t{\n\t\t\treturn this.currentSidebarPanel.length > 0;\n\t\t},\n\t\tcopilotRole(): string\n\t\t{\n\t\t\tconst role = this.$store.getters['copilot/chats/getRole'](this.dialogId);\n\t\t\tif (!role)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn role.name;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.showAddToChatHint = PromoManager.getInstance().needToShow(PromoId.addUsersToCopilotChat);\n\t},\n\tmethods:\n\t{\n\t\tonNewTitleSubmit(newTitle: string)\n\t\t{\n\t\t\tthis.getChatService().renameChat(this.dialogId, newTitle).catch(() => {\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('IM_CONTENT_COPILOT_HEADER_RENAME_ERROR'),\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\topenAddToChatPopup()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t\tonMembersClick()\n\t\t{\n\t\t\tif (!this.isInited)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.currentSidebarPanel === SidebarDetailBlock.members)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.sidebar.close, { panel: SidebarDetailBlock.members });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\tpanel: SidebarDetailBlock.members,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\ttoggleRightPanel()\n\t\t{\n\t\t\tif (this.currentSidebarPanel)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.sidebar.close, { panel: '' });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\tpanel: SidebarDetailBlock.main,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\tonHintHide()\n\t\t{\n\t\t\tvoid PromoManager.getInstance().markAsWatched(PromoId.addUsersToCopilotChat);\n\t\t\tthis.showAddToChatHint = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-copilot-header__container\">\n\t\t\t<div class=\"bx-im-copilot-header__left\">\n\t\t\t\t<div class=\"bx-im-copilot-header__avatar\">\n\t\t\t\t\t<ChatAvatar\n\t\t\t\t\t\t:avatarDialogId=\"dialogId\"\n\t\t\t\t\t\t:contextDialogId=\"dialogId\"\n\t\t\t\t\t\t:withSpecialTypes=\"false\"\n\t\t\t\t\t\t:size=\"AvatarSize.L\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-copilot-header__info\">\n\t\t\t\t\t<EditableChatTitle :dialogId=\"dialogId\" @newTitleSubmit=\"onNewTitleSubmit\" />\n\t\t\t\t\t<div \n\t\t\t\t\t\tv-if=\"isGroupCopilotChat\"\n\t\t\t\t\t\t:title=\"loc('IM_CONTENT_COPILOT_HEADER_OPEN_MEMBERS_TITLE')\"\n\t\t\t\t\t\t@click=\"onMembersClick\"\n\t\t\t\t\t\tclass=\"bx-im-copilot-header__subtitle --click\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ userCounter }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else class=\"bx-im-copilot-header__subtitle\">\n\t\t\t\t\t\t{{ copilotRole }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-copilot-header__right\">\n\t\t\t\t<div\n\t\t\t\t\t:title=\"loc('IM_CONTENT_COPILOT_HEADER_OPEN_INVITE_POPUP_TITLE')\"\n\t\t\t\t\t:class=\"{'--active': showAddToChatPopup}\"\n\t\t\t\t\tclass=\"bx-im-copilot-header__icon --add-users\"\n\t\t\t\t\t@click=\"openAddToChatPopup\"\n\t\t\t\t\tref=\"add-users\"\n\t\t\t\t>\n\t\t\t\t\t<AddToChatHint\n\t\t\t\t\t\tv-if=\"showAddToChatHint\"\n\t\t\t\t\t\t:bindElement=\"$refs['add-users']\"\n\t\t\t\t\t\t@close=\"showAddToChatHint = false\"\n\t\t\t\t\t\t@hide=\"onHintHide\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"bx-im-copilot-header__icon --panel\"\n\t\t\t\t\t:title=\"loc('IM_CONTENT_CHAT_HEADER_OPEN_SIDEBAR')\"\n\t\t\t\t\t:class=\"{'--active': isSidebarOpened}\"\n\t\t\t\t\t@click=\"toggleRightPanel\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-users'] || {}\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: 15, offsetLeft: -300}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Messenger } from 'im.public';\nimport { Button as ChatButton, ButtonSize, CopilotRolesDialog } from 'im.v2.component.elements';\nimport { Color } from 'im.v2.const';\nimport { CopilotService } from 'im.v2.provider.service';\n\nimport '../css/empty-state.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { CustomColorScheme } from 'im.v2.component.elements';\n\nconst BUTTON_BACKGROUND_COLOR = '#fff';\nconst BUTTON_HOVER_COLOR = '#eee';\nconst BUTTON_TEXT_COLOR = 'rgba(82, 92, 105, 0.9)';\n\n// @vue/component\nexport const EmptyState = {\n\tname: 'EmptyState',\n\tcomponents: { ChatButton, CopilotRolesDialog },\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCreatingChat: false,\n\t\t\tshowRolesDialog: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tpreparedText(): string\n\t\t{\n\t\t\treturn this.loc('IM_CONTENT_COPILOT_EMPTY_STATE_MESSAGE_MSGVER_1', {\n\t\t\t\t'#BR#': '\\n',\n\t\t\t});\n\t\t},\n\t\tbuttonColorScheme(): CustomColorScheme\n\t\t{\n\t\t\treturn {\n\t\t\t\tborderColor: Color.transparent,\n\t\t\t\tbackgroundColor: BUTTON_BACKGROUND_COLOR,\n\t\t\t\ticonColor: BUTTON_TEXT_COLOR,\n\t\t\t\ttextColor: BUTTON_TEXT_COLOR,\n\t\t\t\thoverColor: BUTTON_HOVER_COLOR,\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonCreateChatClick()\n\t\t{\n\t\t\tthis.showRolesDialog = true;\n\t\t},\n\t\tasync createChat(role): Promise<void>\n\t\t{\n\t\t\tconst roleCode = role.code;\n\t\t\tthis.isCreatingChat = true;\n\t\t\tthis.showRolesDialog = false;\n\n\t\t\tconst newDialogId = await this.getCopilotService().createChat({ roleCode })\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.isCreatingChat = false;\n\t\t\t\t\tthis.showCreateChatError();\n\t\t\t\t});\n\n\t\t\tthis.isCreatingChat = false;\n\t\t\tvoid Messenger.openCopilot(newDialogId);\n\t\t},\n\t\tshowCreateChatError()\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: this.loc('IM_CONTENT_COPILOT_EMPTY_STATE_ERROR_CREATING_CHAT'),\n\t\t\t});\n\t\t},\n\t\tgetCopilotService(): CopilotService\n\t\t{\n\t\t\tif (!this.copilotService)\n\t\t\t{\n\t\t\t\tthis.copilotService = new CopilotService();\n\t\t\t}\n\n\t\t\treturn this.copilotService;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-copilot-empty-state__container\">\n\t\t\t<div class=\"bx-im-content-copilot-empty-state__content\">\n\t\t\t\t<div class=\"bx-im-content-copilot-empty-state__icon\"></div>\n\t\t\t\t<div class=\"bx-im-content-copilot-empty-state__text\">{{ preparedText }}</div>\n\t\t\t\t<ChatButton\n\t\t\t\t\tclass=\"--black-loader\"\n\t\t\t\t\t:size=\"ButtonSize.XL\"\n\t\t\t\t\t:customColorScheme=\"buttonColorScheme\"\n\t\t\t\t\t:text=\"loc('IM_CONTENT_COPILOT_EMPTY_STATE_ASK_QUESTION')\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:isLoading=\"isCreatingChat\"\n\t\t\t\t\t@click=\"onCreateChatClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<CopilotRolesDialog \n\t\t\t\tv-if=\"showRolesDialog\"\n\t\t\t\t@selectRole=\"createChat\"\n\t\t\t\t@close=\"showRolesDialog = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { ChatTextarea } from 'im.v2.component.textarea';\nimport { CopilotDraftManager } from 'im.v2.lib.draft';\n\n// @vue/component\nexport const CopilotTextarea = {\n\tname: 'CopilotTextarea',\n\tcomponents: { ChatTextarea },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tCopilotDraftManager: () => CopilotDraftManager,\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ChatTextarea\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:placeholder=\"this.loc('IM_CONTENT_COPILOT_TEXTAREA_PLACEHOLDER')\"\n\t\t\t:withCreateMenu=\"false\"\n\t\t\t:withMarket=\"false\"\n\t\t\t:withEdit=\"false\"\n\t\t\t:withUploadMenu=\"false\"\n\t\t\t:withSmileSelector=\"false\"\n\t\t\t:draftManagerClass=\"CopilotDraftManager\"\n\t\t/>\n\t`,\n};\n","import { Loc, Runtime } from 'main.core';\n\nimport { MessageMenu } from 'im.v2.component.message-list';\nimport { CopilotManager } from 'im.v2.lib.copilot';\n\nimport type { ImModelChat } from 'im.v2.model';\nimport type { MenuItem } from 'im.v2.lib.menu';\n\nconst CopilotChatContext = Object.freeze({\n\tpersonal: 'chat_copilot_tab_one_by_one',\n\tgroup: 'chat_copilot_tab_multi',\n});\n\nexport class CopilotMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getForwardItem(),\n\t\t\tthis.getSendFeedbackItem(),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n\n\tgetSendFeedbackItem(): MenuItem\n\t{\n\t\tconst copilotManager = new CopilotManager();\n\t\tif (!copilotManager.isCopilotBot(this.context.authorId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_CONTENT_COPILOT_CONTEXT_MENU_FEEDBACK'),\n\t\t\tonclick: () => {\n\t\t\t\tvoid this.openForm();\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tasync openForm()\n\t{\n\t\tconst formId = Math.round(Math.random() * 1000);\n\n\t\tawait Runtime.loadExtension(['ui.feedback.form']);\n\t\tBX.UI.Feedback.Form.open({\n\t\t\tid: `im.copilot.feedback-${formId}`,\n\t\t\tforms: [\n\t\t\t\t{ zones: ['es'], id: 684, lang: 'es', sec: 'svvq1x' },\n\t\t\t\t{ zones: ['en'], id: 686, lang: 'en', sec: 'tjwodz' },\n\t\t\t\t{ zones: ['de'], id: 688, lang: 'de', sec: 'nrwksg' },\n\t\t\t\t{ zones: ['com.br'], id: 690, lang: 'com.br', sec: 'kpte6m' },\n\t\t\t\t{ zones: ['ru', 'by', 'kz'], id: 692, lang: 'ru', sec: 'jbujn0' },\n\t\t\t],\n\t\t\tpresets: {\n\t\t\t\tsender_page: this.getCopilotChatContext(),\n\t\t\t\tlanguage: Loc.getMessage('LANGUAGE_ID'),\n\t\t\t\tcp_answer: this.context.text,\n\t\t\t},\n\t\t});\n\t}\n\n\tgetCopilotChatContext(): $Values<typeof CopilotChatContext>\n\t{\n\t\tconst chat: ImModelChat = this.store.getters['chats/get'](this.context.dialogId);\n\t\tif (chat.userCounter <= 2)\n\t\t{\n\t\t\treturn CopilotChatContext.personal;\n\t\t}\n\n\t\treturn CopilotChatContext.group;\n\t}\n}\n","import { DialogStatus } from 'im.v2.component.elements';\nimport { MessageList } from 'im.v2.component.message-list';\n\nimport { CopilotMessageMenu } from '../classes/message-menu';\n\n// @vue/component\nexport const CopilotMessageList = {\n\tname: 'CopilotMessageList',\n\tcomponents: { MessageList, DialogStatus },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tCopilotMessageMenu: () => CopilotMessageMenu,\n\t},\n\ttemplate: `\n\t\t<MessageList :dialogId=\"dialogId\" :messageMenuClass=\"CopilotMessageMenu\" />\n\t`,\n};\n","import { BitrixVue } from 'ui.vue3';\n\nimport { ChatDialog } from 'im.v2.component.dialog.chat';\n\nimport { CopilotMessageList } from './message-list';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\n// @vue/component\nexport const CopilotDialog = BitrixVue.cloneComponent(ChatDialog, {\n\tname: 'CopilotDialog',\n\tcomputed:\n\t{\n\t\tmessageListComponent(): BitrixVueComponentProps\n\t\t{\n\t\t\treturn CopilotMessageList;\n\t\t},\n\t},\n});\n","import 'ui.notification';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { Messenger } from 'im.public';\nimport { ChatService } from 'im.v2.provider.service';\nimport { Logger } from 'im.v2.lib.logger';\nimport { ThemeManager } from 'im.v2.lib.theme';\nimport { ResizeManager } from 'im.v2.lib.textarea';\nimport { EventType, Settings, SidebarDetailBlock } from 'im.v2.const';\nimport { ChatSidebar } from 'im.v2.component.sidebar';\nimport { Analytics } from 'im.v2.lib.analytics';\n\nimport { ChatHeader } from './components/chat-header';\nimport { EmptyState } from './components/empty-state';\nimport { CopilotTextarea } from './components/textarea';\nimport { CopilotDialog } from './components/dialog';\n\nimport './css/copilot-content.css';\n\nimport type { ImModelChat, ImModelLayout } from 'im.v2.model';\nimport type { BackgroundStyle } from 'im.v2.lib.theme';\n\n// @vue/component\nexport const CopilotContent = {\n\tname: 'CopilotContent',\n\tcomponents: { EmptyState, ChatHeader, CopilotDialog, CopilotTextarea, ChatSidebar },\n\tdirectives:\n\t{\n\t\t'textarea-observer': {\n\t\t\tmounted(element, binding)\n\t\t\t{\n\t\t\t\tbinding.instance.textareaResizeManager.observeTextarea(element);\n\t\t\t},\n\t\t\tbeforeUnmount(element, binding)\n\t\t\t{\n\t\t\t\tbinding.instance.textareaResizeManager.unobserveTextarea(element);\n\t\t\t},\n\t\t},\n\t},\n\tprops:\n\t{\n\t\tentityId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcontextMessageId: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttextareaHeight: 0,\n\t\t\tcurrentSidebarPanel: '',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tlayout(): ImModelLayout\n\t\t{\n\t\t\treturn this.$store.getters['application/getLayout'];\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.entityId, true);\n\t\t},\n\t\tcontainerClasses(): string[]\n\t\t{\n\t\t\tconst alignment = this.$store.getters['application/settings/get'](Settings.appearance.alignment);\n\n\t\t\treturn [`--${alignment}-align`];\n\t\t},\n\t\tbackgroundStyle(): BackgroundStyle\n\t\t{\n\t\t\tconst COPILOT_BACKGROUND_ID = 4;\n\n\t\t\treturn ThemeManager.getBackgroundStyleById(COPILOT_BACKGROUND_ID);\n\t\t},\n\t\tdialogContainerStyle(): Object\n\t\t{\n\t\t\tconst CHAT_HEADER_HEIGHT = 64;\n\n\t\t\treturn {\n\t\t\t\theight: `calc(100% - ${CHAT_HEADER_HEIGHT}px - ${this.textareaHeight}px)`,\n\t\t\t};\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tentityId(newValue, oldValue)\n\t\t{\n\t\t\tLogger.warn(`CopilotContent: switching from ${oldValue || 'empty'} to ${newValue}`);\n\t\t\tthis.onChatChange();\n\t\t},\n\t\ttextareaHeight(newValue, oldValue)\n\t\t{\n\t\t\tif (!this.dialog.inited || oldValue === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {\n\t\t\t\tchatId: this.dialog.chatId,\n\t\t\t\tanimation: false,\n\t\t\t});\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tif (this.entityId)\n\t\t{\n\t\t\tthis.onChatChange();\n\t\t}\n\n\t\tthis.initTextareaResizeManager();\n\t},\n\tmethods:\n\t{\n\t\tasync onChatChange()\n\t\t{\n\t\t\tif (this.entityId === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.dialog.inited)\n\t\t\t{\n\t\t\t\tLogger.warn(`CopilotContent: chat ${this.entityId} is already loaded`);\n\n\t\t\t\tAnalytics.getInstance().onOpenChat(this.dialog);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.dialog.loading)\n\t\t\t{\n\t\t\t\tLogger.warn(`CopilotContent: chat ${this.entityId} is loading`);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.layout.contextId)\n\t\t\t{\n\t\t\t\tawait this.loadChatWithContext();\n\t\t\t\tAnalytics.getInstance().onOpenChat(this.dialog);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.loadChat();\n\t\t\tAnalytics.getInstance().onOpenChat(this.dialog);\n\t\t},\n\t\tonTextareaMount()\n\t\t{\n\t\t\tconst textareaContainer: HTMLDivElement = this.$refs['textarea-container'];\n\t\t\tthis.textareaHeight = textareaContainer.clientHeight;\n\t\t},\n\t\tloadChatWithContext(): Promise\n\t\t{\n\t\t\tLogger.warn(`CopilotContent: loading chat ${this.entityId} with context - ${this.layout.contextId}`);\n\n\t\t\treturn this.getChatService().loadChatWithContext(this.entityId, this.layout.contextId).then(() => {\n\t\t\t\tLogger.warn(`CopilotContent: chat ${this.entityId} is loaded with context of ${this.layout.contextId}`);\n\t\t\t}).catch((error) => {\n\t\t\t\tif (error.code === 'ACCESS_ERROR')\n\t\t\t\t{\n\t\t\t\t\tthis.showNotification(this.loc('IM_CONTENT_CHAT_ACCESS_ERROR'));\n\t\t\t\t}\n\t\t\t\tLogger.error(error);\n\t\t\t\tMessenger.openCopilot();\n\t\t\t});\n\t\t},\n\t\tloadChat(): Promise\n\t\t{\n\t\t\tLogger.warn(`CopilotContent: loading chat ${this.entityId}`);\n\n\t\t\treturn this.getChatService().loadChatWithMessages(this.entityId).then(() => {\n\t\t\t\tLogger.warn(`CopilotContent: chat ${this.entityId} is loaded`);\n\t\t\t}).catch((error) => {\n\t\t\t\tconst [firstError] = error;\n\t\t\t\tif (firstError.code === 'ACCESS_DENIED')\n\t\t\t\t{\n\t\t\t\t\tthis.showNotification(this.loc('IM_CONTENT_CHAT_ACCESS_ERROR'));\n\t\t\t\t}\n\t\t\t\tMessenger.openCopilot();\n\t\t\t});\n\t\t},\n\t\tinitTextareaResizeManager()\n\t\t{\n\t\t\tthis.textareaResizeManager = new ResizeManager();\n\t\t\tthis.textareaResizeManager.subscribe(\n\t\t\t\tResizeManager.events.onHeightChange,\n\t\t\t\t(event: BaseEvent<{newHeight: number}>) => {\n\t\t\t\t\tconst { newHeight } = event.getData();\n\t\t\t\t\tthis.textareaHeight = newHeight;\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tshowNotification(text: string)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({ content: text });\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tonChangeSidebarPanel({ panel }: {panel: $Keys<typeof SidebarDetailBlock>})\n\t\t{\n\t\t\tthis.currentSidebarPanel = panel;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__container bx-im-content-copilot__container\" :class=\"containerClasses\" :style=\"backgroundStyle\">\n\t\t\t<div v-if=\"entityId\" class=\"bx-im-content-copilot__content\">\n\t\t\t\t<ChatHeader :dialogId=\"entityId\" :key=\"entityId\" :currentSidebarPanel=\"currentSidebarPanel\" />\n\t\t\t\t<div :style=\"dialogContainerStyle\" class=\"bx-im-content-copilot__dialog_container\">\n\t\t\t\t\t<div class=\"bx-im-content-copilot__dialog_content\">\n\t\t\t\t\t\t<CopilotDialog :dialogId=\"entityId\" :key=\"entityId\" :textareaHeight=\"textareaHeight\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-textarea-observer class=\"bx-im-content-copilot__textarea_container\" ref=\"textarea-container\">\n\t\t\t\t\t<CopilotTextarea :dialogId=\"entityId\" :key=\"entityId\" @mounted=\"onTextareaMount\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<EmptyState v-else />\n\t\t\t<ChatSidebar\n\t\t\t\tv-if=\"entityId.length > 0\"\n\t\t\t\t:originDialogId=\"entityId\"\n\t\t\t\t@changePanel=\"onChangeSidebarPanel\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n"],"names":["POPUP_ID","AddToChatHint","name","components","MessengerPopup","props","bindElement","type","Object","required","emits","computed","config","darkMode","angle","width","closeIcon","offsetLeft","className","contentBorderRadius","methods","loc","phraseCode","$Bitrix","Loc","getMessage","template","ChatHeader","EditableChatTitle","AddToChat","ChatAvatar","dialogId","String","default","currentSidebarPanel","data","showAddToChatPopup","showAddToChatHint","AvatarSize","dialog","$store","getters","chatId","userCounter","getMessagePlural","isInited","inited","isGroupCopilotChat","isSidebarOpened","length","copilotRole","role","mounted","PromoManager","getInstance","needToShow","PromoId","addUsersToCopilotChat","onNewTitleSubmit","newTitle","getChatService","renameChat","catch","BX","UI","Notification","Center","notify","content","chatService","ChatService","replacements","openAddToChatPopup","onMembersClick","SidebarDetailBlock","members","EventEmitter","emit","EventType","sidebar","close","panel","open","toggleRightPanel","main","onHintHide","markAsWatched","BUTTON_BACKGROUND_COLOR","BUTTON_HOVER_COLOR","BUTTON_TEXT_COLOR","EmptyState","ChatButton","CopilotRolesDialog","isCreatingChat","showRolesDialog","ButtonSize","preparedText","buttonColorScheme","borderColor","Color","transparent","backgroundColor","iconColor","textColor","hoverColor","onCreateChatClick","createChat","roleCode","code","newDialogId","getCopilotService","showCreateChatError","Messenger","openCopilot","copilotService","CopilotService","CopilotTextarea","ChatTextarea","CopilotDraftManager","CopilotChatContext","freeze","personal","group","CopilotMessageMenu","MessageMenu","getMenuItems","getCopyItem","getFavoriteItem","getForwardItem","getSendFeedbackItem","getDeleteItem","copilotManager","CopilotManager","isCopilotBot","context","authorId","text","onclick","openForm","menuInstance","formId","Math","round","random","Runtime","loadExtension","Feedback","Form","id","forms","zones","lang","sec","presets","sender_page","getCopilotChatContext","language","cp_answer","chat","store","CopilotMessageList","MessageList","DialogStatus","CopilotDialog","BitrixVue","cloneComponent","ChatDialog","messageListComponent","CopilotContent","ChatSidebar","directives","element","binding","instance","textareaResizeManager","observeTextarea","beforeUnmount","unobserveTextarea","entityId","contextMessageId","Number","textareaHeight","layout","containerClasses","alignment","Settings","appearance","backgroundStyle","COPILOT_BACKGROUND_ID","ThemeManager","getBackgroundStyleById","dialogContainerStyle","CHAT_HEADER_HEIGHT","height","watch","newValue","oldValue","Logger","warn","onChatChange","scrollToBottom","animation","created","initTextareaResizeManager","Analytics","onOpenChat","loading","contextId","loadChatWithContext","loadChat","onTextareaMount","textareaContainer","$refs","clientHeight","then","error","showNotification","loadChatWithMessages","firstError","ResizeManager","subscribe","events","onHeightChange","event","newHeight","getData","onChangeSidebarPanel"],"mappings":"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"}