{"version":3,"file":"accessrights.bundle.js","sources":["../src/grid.js","../src/item/base.js","../src/item/title.js","../src/item/hint.js","../src/item/member.js","../src/item/role.js","../src/item/changer.js","../src/item/toggler.js","../src/item/controller.js","../src/item/variableselector.js","../src/item/usergrouptitle.js","../src/item/multivariable/footer.js","../src/item/multivariable/multiselector.js","../src/columnitem.js","../src/column.js","../src/section.js"],"sourcesContent":["import {BaseEvent, EventEmitter} from \"main.core.events\";\nimport {Dom, Reflection, Type, Tag, Loc, Text} from 'main.core';\nimport {Loader} from \"main.loader\";\nimport Section from \"./section\";\nimport 'ui.notification';\n\nconst BX = Reflection.namespace('BX');\n\ntype GridOptions = {\n\toptions: GridOptions;\n\trenderTo: HTMLElement;\n\tbuttonPanel: BX.UI.ButtonPanel;\n\tcomponent: string;\n\tactionSave: null;\n\tactionDelete: null;\n\tactionLoad: null;\n\tmode: 'string';\n\topenPopupEvent: null;\n\tpopupContainer: null;\n\tadditionalSaveParams: {};\n\tuserGroups: [];\n\taccessRights: [];\n\tloadParams: {};\n\tneedToLoadUserGroups?: boolean;\n};\n\nexport default class Grid {\n\tstatic ACTION_SAVE = 'save';\n\tstatic ACTION_DELETE = 'delete';\n\tstatic ACTION_LOAD = 'load';\n\tstatic MODE = 'ajax';\n\n\tconstructor(options: GridOptions)\n\t{\n\t\toptions = options || {};\n\t\tthis.options = options;\n\t\tthis.renderTo = options.renderTo;\n\t\tthis.buttonPanel = BX.UI.ButtonPanel || null;\n\n\t\tthis.layout = {\n\t\t\tcontainer: null\n\t\t};\n\t\tthis.component = options.component ? options.component : null;\n\t\tthis.actionSave = options.actionSave || Grid.ACTION_SAVE;\n\t\tthis.actionDelete = options.actionDelete || Grid.ACTION_DELETE;\n\t\tthis.actionLoad = options.actionLoad || Grid.ACTION_LOAD;\n\t\tthis.mode = options.mode || Grid.MODE;\n\t\tthis.openPopupEvent = options.openPopupEvent ? options.openPopupEvent : null;\n\t\tthis.popupContainer = options.popupContainer ? options.popupContainer : null;\n\t\tthis.additionalSaveParams = options.additionalSaveParams ? options.additionalSaveParams : null;\n\t\tthis.loadParams = options.loadParams ? options.loadParams : null;\n\t\tthis.loader = null;\n\t\tthis.timer = null;\n\t\tthis.needToLoadUserGroups = options.needToLoadUserGroups ?? true;\n\n\t\tthis.initData();\n\t\tif (options.userGroups)\n\t\t{\n\t\t\tthis.userGroups = options.userGroups;\n\t\t}\n\t\tif (options.accessRights)\n\t\t{\n\t\t\tthis.accessRights = options.accessRights;\n\t\t}\n\n\t\tthis.isRequested = false;\n\n\t\tthis.loadData();\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:updateRole', this.updateRole.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:selectAccessItems', this.updateAccessVariationRight.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:accessOn', this.updateAccessRight.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:accessOff', this.updateAccessRight.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:update', this.adjustButtonPanel.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:addRole', this.addUserGroup.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:addRole', this.addRoleColumn.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:copyRole', this.addRoleColumn.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:copyRole', this.addUserGroup.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:removeRole', this.removeRoleColumn.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:removeRole', this.adjustButtonPanel.bind(this));\n\t\tEventEmitter.subscribe('BX.Main.SelectorV2:onGetEntityTypes', this.onGetEntityTypes.bind(this));\n\t}\n\n\tinitData(): void\n\t{\n\t\tthis.accessRights = [];\n\t\tthis.userGroups = [];\n\t\tthis.accessRightsSections = [];\n\t\tthis.headSection = null;\n\t\tthis.members = [];\n\t\tthis.columns = [];\n\t}\n\n\tfireEventReset(): void\n\t{\n\t\tEventEmitter.emit('BX.UI.AccessRights:reset', this);\n\t}\n\n\tfireEventRefresh(): void\n\t{\n\t\tEventEmitter.emit( 'BX.UI.AccessRights:refresh', this);\n\t}\n\n\tgetButtonPanel(): BX.UI.ButtonPanel\n\t{\n\t\treturn this.buttonPanel;\n\t}\n\n\tshowNotification(title): void\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: title,\n\t\t\tposition: 'top-right',\n\t\t\tautoHideDelay: 3000,\n\t\t});\n\t}\n\n\tsendActionRequest(): void\n\t{\n\t\tif (this.isRequested)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isRequested = true;\n\t\tEventEmitter.emit(this, 'onBeforeSave', this);\n\n\t\tthis.timer = setTimeout(\n\t\t\t() => {\n\t\t\t\tthis.blockGrid();\n\t\t\t},\n\t\t\t1000\n\t\t);\n\n\t\tlet needReload = false;\n\t\tconst dataToSave = [];\n\t\tfor (let i = 0; i < this.userGroups.length; i++)\n\t\t{\n\t\t\tif (Text.toNumber(this.userGroups[i].id) === 0)\n\t\t\t{\n\t\t\t\tneedReload = true;\n\t\t\t}\n\n\t\t\tdataToSave.push({\n\t\t\t\taccessCodes: this.userGroups[i].accessCodes,\n\t\t\t\tid: this.userGroups[i].id,\n\t\t\t\ttitle: this.userGroups[i].title,\n\t\t\t\ttype: this.userGroups[i].type,\n\t\t\t\taccessRights: this.userGroups[i].accessRights\n\t\t\t})\n\t\t}\n\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.component,\n\t\t\tthis.actionSave,\n\t\t\t{\n\t\t\t\tmode: this.mode,\n\t\t\t\tdata: {\n\t\t\t\t\tuserGroups: dataToSave,\n\t\t\t\t\tparameters: this.additionalSaveParams\n\t\t\t\t},\n\t\t\t\t// analyticsLabel: {\n\t\t\t\t// \tviewMode: 'grid',\n\t\t\t\t// \tfilterState: 'closed'\n\t\t\t\t// }\n\t\t\t}\n\t\t).then(\n\t\t\t() => {\n\t\t\t\tif (needReload)\n\t\t\t\t{\n\t\t\t\t\tthis.reloadGrid();\n\t\t\t\t}\n\n\t\t\t\tthis.isRequested = false;\n\t\t\t\tthis.showNotification(Loc.getMessage('JS_UI_ACCESSRIGHTS_STTINGS_HAVE_BEEN_SAVED'));\n\t\t\t\tthis.unBlockGrid();\n\t\t\t\tthis.fireEventRefresh();\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.adjustButtonPanel()\n\t\t\t\t});\n\t\t\t\tclearTimeout(this.timer);\n\t\t\t\tconst waitContainer = this.buttonPanel.getContainer().querySelector('.ui-btn-wait');\n\t\t\t\tDom.removeClass(waitContainer, 'ui-btn-wait');\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tlet errorMessage = 'Error message';\n\t\t\t\tif (response.errors)\n\t\t\t\t{\n\t\t\t\t\terrorMessage = response.errors[0].message;\n\t\t\t\t}\n\t\t\t\tthis.isRequested = false;\n\t\t\t\tthis.showNotification(errorMessage);\n\t\t\t\tthis.unBlockGrid();\n\t\t\t\tclearTimeout(this.timer);\n\t\t\t\tconst waitContainer = this.buttonPanel.getContainer().querySelector('.ui-btn-wait');\n\t\t\t\tDom.removeClass(waitContainer, 'ui-btn-wait');\n\t\t\t}\n\t\t);\n\n\t\tEventEmitter.emit( 'BX.UI.AccessRights:preservation', this);\n\t}\n\n\tlock(): void\n\t{\n\t\tDom.addClass(this.getMainContainer(), '--lock');\n\t}\n\n\tunlock(): void\n\t{\n\t\tDom.removeClass(this.getMainContainer(), '--lock');\n\t}\n\n\tdeleteActionRequest(roleId): void\n\t{\n\t\tif (this.isRequested)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isRequested = true;\n\n\t\tthis.timer = setTimeout(\n\t\t\t() => {\n\t\t\t\tthis.blockGrid();\n\t\t\t\t},\n\t\t\t1000\n\t\t);\n\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.component,\n\t\t\tthis.actionDelete,\n\t\t\t{\n\t\t\t\tmode: this.mode,\n\t\t\t\tdata: {\n\t\t\t\t\troleId: roleId\n\t\t\t\t},\n\t\t\t\t// analyticsLabel: {\n\t\t\t\t// \tviewMode: 'grid',\n\t\t\t\t// \tfilterState: 'closed'\n\t\t\t\t// }\n\t\t\t}\n\t\t).then(\n\t\t\t() => {\n\t\t\t\tthis.isRequested = false;\n\t\t\t\tthis.showNotification(Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLE_REMOVE'));\n\t\t\t\tthis.unBlockGrid();\n\t\t\t\tclearTimeout(this.timer);\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tlet errorMessage = 'Error message';\n\t\t\t\tif (response.errors)\n\t\t\t\t{\n\t\t\t\t\terrorMessage = response.errors[0].message;\n\t\t\t\t}\n\t\t\t\tthis.isRequested = false;\n\t\t\t\tthis.showNotification(errorMessage);\n\t\t\t\tthis.unBlockGrid();\n\t\t\t\tclearTimeout(this.timer);\n\t\t\t}\n\t\t);\n\t}\n\n\treloadGrid(): void\n\t{\n\t\tthis.initData();\n\n\t\tBX.ajax.runComponentAction(\n\t\t\tthis.component,\n\t\t\tthis.actionLoad,\n\t\t\t{\n\t\t\t\tmode: this.mode,\n\t\t\t\tdata: {\n\t\t\t\t\tparameters: this.loadParams\n\t\t\t\t},\n\t\t\t}\n\t\t).then(\n\t\t\t(response) => {\n\t\t\t\tif (\n\t\t\t\t\tresponse.data['ACCESS_RIGHTS']\n\t\t\t\t\t&& response.data['USER_GROUPS']\n\t\t\t\t) {\n\t\t\t\t\tthis.accessRights = response.data.ACCESS_RIGHTS;\n\t\t\t\t\tthis.userGroups = response.data.USER_GROUPS;\n\t\t\t\t\tthis.loadData();\n\t\t\t\t\tthis.draw();\n\t\t\t\t}\n\t\t\t\tthis.unBlockGrid();\n\t\t\t},\n\t\t\t() => this.unBlockGrid\n\t\t);\n\t}\n\n\tblockGrid(): void\n\t{\n\t\tconst offsetTop =\n\t\t\tthis.layout.container.getBoundingClientRect().top < 0\n\t\t\t\t? '0'\n\t\t\t\t: this.layout.container.getBoundingClientRect().top\n\t\t;\n\n\t\tDom.addClass(this.layout.container, 'ui-access-rights-block');\n\t\tDom.style(this.layout.container, 'height', 'calc(100vh - ' + offsetTop  + 'px)')\n\n\t\tsetTimeout(() => {\n\t\t\tDom.style(this.layout.container, 'height', 'calc(100vh - ' + offsetTop  + 'px)')\n\t\t});\n\n\t\tthis\n\t\t\t.getLoader()\n\t\t\t.show()\n\t\t;\n\t}\n\n\tunBlockGrid(): void\n\t{\n\t\tDom.removeClass(this.layout.container, 'ui-access-rights-block');\n\t\tDom.style(this.layout.container, 'height', null)\n\n\t\tthis\n\t\t\t.getLoader()\n\t\t\t.hide()\n\t\t;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (!this.loader)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.layout.container\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tremoveRoleColumn(param): void\n\t{\n\t\tthis.headSection.removeColumn(param.data);\n\t\tthis.accessRightsSections.map(\n\t\t\t(data) => {\n\t\t\t\tdata.removeColumn(param.data);\n\t\t\t}\n\t\t);\n\n\t\tconst targetIndex = this.userGroups.indexOf(param.data.userGroup);\n\t\tthis.userGroups.splice(targetIndex, 1);\n\n\t\tconst roleId = param.data.userGroup.id;\n\t\tif (roleId > 0)\n\t\t{\n\t\t\tthis.deleteActionRequest(roleId);\n\t\t}\n\t}\n\n\taddRoleColumn(event: BaseEvent): void\n\t{\n\t\tconst [param] = event.getData();\n\t\tif (!param)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sections = this.accessRightsSections;\n\n\t\tfor (let i = 0; i < sections.length; i++)\n\t\t{\n\t\t\tparam.headSection = false;\n\t\t\tparam.newColumn = true;\n\t\t\tsections[i].addColumn(param);\n\t\t\tsections[i].scrollToRight(sections[i].getColumnsContainer().scrollWidth - sections[i].getColumnsContainer().offsetWidth, 'stop');\n\t\t}\n\n\t\tparam.headSection = true;\n\t\tparam.newColumn = true;\n\t\tthis.headSection.addColumn(param);\n\t}\n\n\taddUserGroup(event: BaseEvent): void\n\t{\n\t\tlet [options] = event.getData();\n\t\toptions = options || {};\n\t\tthis.userGroups.push(options);\n\t}\n\n\tupdateRole(event: BaseEvent): void\n\t{\n\t\tconst item = event.getData();\n\t\tconst index = this.userGroups.indexOf(item.userGroup);\n\t\tif (index >= 0)\n\t\t{\n\t\t\tthis.userGroups[index].title = item.text;\n\t\t}\n\t}\n\n\tadjustButtonPanel(): void\n\t{\n\t\tconst modifiedItems = this.getMainContainer().querySelectorAll('.ui-access-rights-column-item-changer-on');\n\t\tconst modifiedRoles = this.getMainContainer().querySelectorAll('.ui-access-rights-column-new');\n\t\tconst modifiedUsers = this.getMainContainer().querySelectorAll('.ui-access-rights-members-item-new');\n\t\tconst modifiedVariables = this.getMainContainer().querySelectorAll('.ui-tag-selector-container');\n\n\t\tif(modifiedItems.length > 0 || modifiedRoles.length > 0 || modifiedUsers.length > 0 || modifiedVariables.length > 0)\n\t\t{\n\t\t\tthis.buttonPanel.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buttonPanel.hide();\n\t\t}\n\t}\n\n\tupdateAccessRight(event: BaseEvent): void\n\t{\n\t\tconst data = event.getData();\n\t\tconst userGroup = this.userGroups[this.userGroups.indexOf(data.userGroup)];\n\t\tconst accessId = data.access.id;\n\n\t\tfor (let i = 0; i < userGroup.accessRights.length; i++)\n\t\t{\n\t\t\tconst item = userGroup.accessRights[i];\n\t\t\tif (item && item.id === accessId)\n\t\t\t{\n\t\t\t\titem.value = (item.value === '0') ? '1' : '0';\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tuserGroup.accessRights.push({\n\t\t\tid: accessId,\n\t\t\tvalue: data.switcher.isChecked() ? '1' : '0'\n\t\t});\n\t}\n\n\tupdateAccessVariationRight(event: BaseEvent): void\n\t{\n\t\tconst item = event.getData();\n\t\tconst userGroup = this.userGroups[this.userGroups.indexOf(item.userGroup)];\n\t\tconst accessId = item.access.id;\n\n\t\tconst deleteIds = [];\n\t\tfor (let i = 0; i < userGroup.accessRights.length; i++)\n\t\t{\n\t\t\tconst item = userGroup.accessRights[i];\n\t\t\tif (item && item.id === accessId)\n\t\t\t{\n\t\t\t\tdeleteIds.push(i);\n\t\t\t}\n\t\t}\n\n\t\tdeleteIds.forEach((i) => {\n\t\t\tdelete (userGroup.accessRights[i]);\n\t\t});\n\t\tconst values = item.selectedValues || [];\n\t\tvalues.forEach((value) => {\n\t\t\tuserGroup.accessRights.push({\n\t\t\t\tid: accessId,\n\t\t\t\tvalue: value\n\t\t\t});\n\t\t});\n\t}\n\n\tloadData()\n\t{\n\t\tthis.accessRights.map(\n\t\t\t(data, index) => {\n\t\t\t\tdata.id = index;\n\t\t\t\tthis.accessRightsSections.push(this.addSection(data));\n\t\t\t}\n\t\t);\n\t}\n\n\tgetColumns(): Column[]\n\t{\n\t\treturn this.columns;\n\t}\n\n\tgetSections(): Section[]\n\t{\n\t\treturn this.accessRightsSections;\n\t}\n\n\tgetUserGroups(): []\n\t{\n\t\tthis.userGroups.forEach(\n\t\t\t(item) => {\n\t\t\t\tif (item.accessCodes)\n\t\t\t\t{\n\t\t\t\t\tfor (const user in item.members)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.accessCodes[user] = item.members[user].type\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\treturn this.userGroups;\n\t}\n\n\tgetHeadSection(): Section\n\t{\n\t\tif (!this.headSection)\n\t\t{\n\t\t\tthis.headSection = new Section({\n\t\t\t\theadSection: true,\n\t\t\t\tuserGroups: this.userGroups,\n\t\t\t\tgrid: this\n\t\t\t});\n\t\t}\n\n\t\treturn this.headSection;\n\t}\n\n\taddSection(options): Section\n\t{\n\t\toptions = options || {};\n\t\treturn new Section({\n\t\t\tid: options.id,\n\t\t\thint: options.sectionHint,\n\t\t\ttitle: options.sectionTitle,\n\t\t\trights: options.rights ? options.rights : [],\n\t\t\tgrid: this\n\t\t});\n\t}\n\n\tgetSectionNode(): HTMLElement\n\t{\n\t\treturn Tag.render`<div class='ui-access-rights-section'></div>`;\n\t}\n\n\tgetMainContainer(): HTMLElement\n\t{\n\t\tif (!this.layout.container)\n\t\t{\n\t\t\tthis.layout.container = Tag.render`<div class='ui-access-rights'></div>`;\n\t\t}\n\n\t\treturn this.layout.container;\n\t}\n\n\tdraw(): void\n\t{\n\t\tconst docFragmentSections = document.createDocumentFragment();\n\t\tDom.append(this.getHeadSection().render(), docFragmentSections);\n\n\t\tthis\n\t\t\t.getSections()\n\t\t\t.map((data) => {\n\t\t\t\tDom.append(data.render(), docFragmentSections);\n\t\t\t})\n\t\t;\n\n\t\tthis.layout.container = null;\n\t\tDom.append(docFragmentSections, this.getMainContainer());\n\n\t\tthis.renderTo.innerHTML = '';\n\t\tDom.append(this.getMainContainer(), this.renderTo);\n\n\t\tthis.afterRender();\n\t}\n\n\tafterRender(): void\n\t{\n\t\tthis.getHeadSection().adjustEars();\n\t\tthis\n\t\t\t.getSections()\n\t\t\t.map((data) => {\n\t\t\t\tdata.adjustEars();\n\t\t\t})\n\t\t;\n\t}\n\n\tonMemberSelect(params): void\n\t{\n\t\tconst option = Grid.buildOption(params);\n\t\tif (!option)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (params.state === 'select')\n\t\t{\n\t\t\tEventEmitter.emit('BX.UI.AccessRights:addToAccessCodes', option);\n\t\t}\n\t}\n\n\tonMemberUnselect(params)\n\t{\n\t\tconst option = Grid.buildOption(params);\n\n\t\tif (!option)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEventEmitter.emit('BX.UI.AccessRights:removeFromAccessCodes', option);\n\t}\n\n\tonGetEntityTypes(): void\n\t{\n\t\tif (!this.needToLoadUserGroups)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst controls = BX.Main\n\t\t\t.selectorManagerV2\n\t\t\t.controls\n\t\t;\n\t\tconst selectorInstance = controls[Object.keys(controls)[0]];\n\n\t\tselectorInstance.entityTypes.USERGROUPS = {\n\t\t\toptions: {\n\t\t\t\tenableSearch: 'Y',\n\t\t\t\tsearchById: 'Y',\n\t\t\t\taddTab: 'Y',\n\t\t\t\treturnItemUrl: (selectorInstance.getOption('returnItemUrl') === 'N' ? 'N' : 'Y')\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic buildOption(params): {}\n\t{\n\t\tconst controls = BX.Main\n\t\t\t.selectorManagerV2\n\t\t\t.controls\n\t\t;\n\t\tconst selectorInstance = controls[Object.keys(controls)[0]].selectorInstance;\n\t\tconst dataColumnAttribute = 'bx-data-column-id';\n\n\t\tconst node = selectorInstance.bindOptions.node;\n\n\t\tif (!node.hasAttribute(dataColumnAttribute) || Type.isUndefined(params.item))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst columnId =  node.getAttribute(dataColumnAttribute);\n\n\t\tconst accessItem = params.item.id;\n\t\tconst entityType = params.entityType;\n\t\tconst accessCodesResult = {};\n\t\taccessCodesResult[accessItem] = entityType;\n\n\t\treturn {\n\t\t\taccessCodes: accessCodesResult,\n\t\t\tcolumnId: columnId,\n\t\t\titem: params.item\n\t\t};\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.UI');\nnamespace.AccessRights = Grid;\n","import ColumnItemOptions from \"../columnitem\";\nimport {Tag} from 'main.core';\n\nexport default class Base {\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tthis.currentValue = options.currentValue || null;\n\t\tthis.identificator = 'col-' + Math.random();\n\t\tthis.parentContainer = options.container;\n\t\tthis.grid = options.grid;\n\t\tthis.text = options.text;\n\t\tthis.userGroup = options.userGroup;\n\t\tthis.access = options.access;\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`<div></div>`;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.identificator;\n\t}\n}\n","import {Dom, Event, Text, Tag} from \"main.core\";\nimport {PopupWindowManager} from \"main.popup\";\nimport Base from \"./base\";\n\nexport default class Title extends Base\n{\n\tstatic TYPE = 'title';\n\n\trender(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div \n\t\t\t\tclass='ui-access-rights-column-item-text'\n\t\t\t\tdata-id='${this.getId()}'\n\t\t\t>\n\t\t\t\t${Text.encode(this.text)}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'mouseenter', this.adjustPopupHelper.bind(this));\n\n\t\tEvent.bind(node, 'mouseleave', () => {\n\t\t\tif (this.popupHelper)\n\t\t\t{\n\t\t\t\tthis.popupHelper.close();\n\t\t\t}\n\t\t});\n\n\t\treturn node;\n\t}\n\n\tadjustPopupHelper(): void\n\t{\n\t\tconst set = this.parentContainer.cloneNode(true);\n\n\t\tDom.style(set, 'position', 'absolute');\n\t\tDom.style(set, 'display', 'inline');\n\t\tDom.style(set, 'visibility', 'hidden');\n\t\tDom.style(set, 'height', '0');\n\n\t\tDom.append(set, document.body);\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(set);\n\t\t});\n\n\t\tif (set.offsetWidth > this.parentContainer.offsetWidth)\n\t\t{\n\t\t\tDom.style(set, 'visibility', 'visible');\n\t\t\tthis.getPopupHelper().show();\n\t\t}\n\t}\n\n\tgetPopupHelper(): Popup\n\t{\n\t\tif (!this.popupHelper)\n\t\t{\n\t\t\tthis.popupHelper = PopupWindowManager.create(\n\t\t\t\tnull,\n\t\t\t\tthis.parentContainer,\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tcontent: this.text,\n\t\t\t\t\tmaxWidth: this.parentContainer.offsetWidth,\n\t\t\t\t\toffsetTop: -9,\n\t\t\t\t\toffsetLeft: 5,\n\t\t\t\t\tanimation: 'fading-slide'\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.popupHelper;\n\t}\n}","import {Tag} from 'main.core';\nimport ColumnItemOptions from \"../columnitem\";\nimport Base from \"./base\";\n\nexport default class Hint extends Base\n{\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.hint = options.hint;\n\t\tthis.className = options.className;\n\n\t\tthis.hintNode = null;\n\t}\n\n\trender(): ?HTMLElement\n\t{\n\t\tif (!this.hintNode && this.hint)\n\t\t{\n\t\t\tconst hintManager = BX.UI.Hint.createInstance({\n\t\t\t\tid: 'access-rights-ui-hint-' + this.getId(),\n\t\t\t\tpopupParameters: {\n\t\t\t\t\tclassName: 'ui-access-rights-popup-pointer-events ui-hint-popup',\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tmaxWidth: 280,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 8,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.hintNode = Tag.render`<span class='${this.className}'></span>`;\n\t\t\tthis.hintNode.setAttribute(hintManager.attributeName, this.hint);\n\t\t\tthis.hintNode.setAttribute(hintManager.attributeHtmlName, true);\n\t\t\tthis.hintNode.setAttribute(hintManager.attributeInteractivityName, true);\n\n\t\t\thintManager.initNode(this.hintNode);\n\t\t}\n\n\t\treturn this.hintNode;\n\t}\n}\n","import {Dom, Event, Text, Tag, Type, Loc, Reflection} from 'main.core';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport {PopupWindowManager} from \"main.popup\";\nimport Base from \"./base\";\nimport ColumnItemOptions from \"../columnitem\";\n\nconst BX = Reflection.namespace('BX');\n\nexport default class Member extends Base\n{\n\tstatic TYPE = 'members';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.openPopupEvent = options.openPopupEvent;\n\t\tthis.popupContainer = options.popupContainer\n\t\tthis.accessCodes = options.accessCodes || [];\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:addToAccessCodes', this.addToAccessCodes.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:removeFromAccessCodes', this.removeFromAccessCodes.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:reset', this.resetNewMembers.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.resetNewMembers.bind(this));\n\t}\n\n\tgetMember(): HTMLElement\n\t{\n\t\tif (!this.member)\n\t\t{\n\t\t\tconst members = this.userGroup.members || {};\n\t\t\tconst membersFragment = document.createDocumentFragment();\n\t\t\tlet counter = 0;\n\t\t\tthis.validateVariables();\n\n\t\t\tObject.keys(members).reverse().forEach(\n\t\t\t\t(item) => {\n\t\t\t\t\tcounter++;\n\t\t\t\t\tif (counter < 7)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst user = members[item];\n\n\t\t\t\t\t\tconst userNode = Tag.render`\n\t\t\t\t\t\t\t<div class='ui-access-rights-members-item'></div>\n\t\t\t\t\t\t`;\n\n\t\t\t\t\t\tif (user.new)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.addClass(userNode, 'ui-access-rights-members-item-new');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (user.avatar)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst userAvatar = Tag.render`<a class='ui-access-rights-members-item-avatar' title=\"${Text.encode(user.name)}\"></a>`;\n\t\t\t\t\t\t\tDom.style(userAvatar, 'backgroundImage', 'url(\\'' + encodeURI(user.avatar) + '\\')');\n\t\t\t\t\t\t\tDom.style(userAvatar, 'backgroundSize', 'cover');\n\t\t\t\t\t\t\tDom.append(userAvatar, userNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet avatarClass = 'ui-icon-common-user';\n\n\t\t\t\t\t\t\tif (user.type === 'groups')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tavatarClass = 'ui-icon-common-user-group';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (user.type === 'sonetgroups')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tavatarClass = 'ui-icon-common-company';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (user.type === 'usergroups')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tavatarClass = 'ui-icon-common-user-group';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst emptyAvatar = Tag.render`<a class='ui-icon ui-icon-xs' title=\"${Text.encode(user.name)}\"><i></i></a>`;\n\t\t\t\t\t\t\tDom.addClass(emptyAvatar, avatarClass);\n\t\t\t\t\t\t\tDom.append(emptyAvatar, userNode);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tDom.append(userNode, membersFragment);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tDom.append(this.getAddUserToRole(), membersFragment);\n\n\t\t\tthis.member = Tag.render`<div class='ui-access-rights-members'>${membersFragment}</div>`;\n\t\t\tEvent.bind(this.member, 'click', this.adjustPopupUserControl.bind(this));\n\t\t}\n\n\t\treturn this.member;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.getMember();\n\t}\n\n\tresetNewMembers(): void\n\t{\n\t\tconst newMembers = this.getMember().querySelectorAll('.ui-access-rights-members-item-new');\n\n\t\tnewMembers.forEach((item) => {\n\t\t\tDom.removeClass(item, 'ui-access-rights-members-item-new');\n\t\t})\n\t}\n\n\tvalidateVariables(): void\n\t{\n\t\tif (Type.isUndefined(this.userGroup.accessCodes))\n\t\t{\n\t\t\tthis.userGroup.accessCodes = [];\n\t\t}\n\t}\n\n\tupdateMembers(): void\n\t{\n\t\tDom.remove(this.member);\n\t\tthis.member = null;\n\n\t\tDom.append(this.getMember(), this.parentContainer);\n\t\tthis.grid.getButtonPanel().show();\n\t}\n\n\taddToAccessCodes(event: BaseEvent): void\n\t{\n\t\tconst params = event.getData();\n\n\t\tif (params.columnId !== this.getId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstKey = Object.keys(params.accessCodes)[0];\n\t\tconst type = params.accessCodes[firstKey].toUpperCase();\n\t\tthis.userGroup.accessCodes = Object.keys(this.accessCodes);\n\n\t\tconst item = params.item;\n\n\t\tif (!Type.isUndefined(item) && Object.keys(item).length)\n\t\t{\n\t\t\tthis.userGroup.members[firstKey] = {\n\t\t\t\tid: item.entityId,\n\t\t\t\tname: item.name,\n\t\t\t\tavatar: item.avatar,\n\t\t\t\turl: '',\n\t\t\t\tnew: true,\n\t\t\t\ttype: type.toLowerCase()\n\t\t\t};\n\n\t\t\tthis.updateMembers();\n\t\t}\n\n\t\tthis.userGroup.accessCodes = [];\n\n\t\tfor (const key in this.userGroup.members)\n\t\t{\n\t\t\tthis.userGroup.accessCodes[key] = this.userGroup.members[key].type;\n\t\t}\n\t}\n\n\tremoveFromAccessCodes(event): void\n\t{\n\t\tconst params = event.data;\n\n\t\tif (params.columnId !== this.identificator)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstKey = Object.keys(params.accessCodes)[0];\n\n\t\tdelete this.userGroup.members[firstKey];\n\t\tthis.updateMembers();\n\n\t\tthis.userGroup.accessCodes = [];\n\n\t\tfor (const key in this.userGroup.members)\n\t\t{\n\t\t\tthis.userGroup.accessCodes[key] = this.userGroup.members[key].type;\n\t\t}\n\t}\n\n\tadjustPopupUserControl(): void\n\t{\n\t\tconst users = [];\n\t\tconst groups = [];\n\t\tconst departments = [];\n\t\tconst sonetgroups = [];\n\n\t\tfor (const item in this.userGroup.members)\n\t\t{\n\t\t\tthis.userGroup.members[item].key = item;\n\n\t\t\tif (this.userGroup.members[item].type === 'users')\n\t\t\t{\n\t\t\t\tusers.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t\telse if (this.userGroup.members[item].type === 'groups')\n\t\t\t{\n\t\t\t\tgroups.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t\telse if (this.userGroup.members[item].type === 'usergroups')\n\t\t\t{\n\t\t\t\tgroups.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t\telse if (this.userGroup.members[item].type === 'departments')\n\t\t\t{\n\t\t\t\tdepartments.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t\telse if (this.userGroup.members[item].type === 'sonetgroups')\n\t\t\t{\n\t\t\t\tsonetgroups.push(this.userGroup.members[item]);\n\t\t\t}\n\t\t}\n\n\t\tconst counterUsers = [];\n\n\t\tfor (const key in this.userGroup.members)\n\t\t{\n\t\t\tcounterUsers.push(this.userGroup.members[key])\n\t\t}\n\n\t\tif (counterUsers.length === 0)\n\t\t{\n\t\t\tthis.showUserSelectorPopup();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getUserPopup(users, groups, departments, sonetgroups).show();\n\t}\n\n\tgetAddUserToRole(): HTMLElement\n\t{\n\t\tif (!this.addUserToRole)\n\t\t{\n\t\t\tthis.addUserToRole = Tag.render`\n\t\t\t\t<span \n\t\t\t\t\tclass='ui-access-rights-members-item ui-access-rights-members-item-add'\n\t\t\t\t\tbx-data-column-id='${this.getId()}'\n\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.addUserToRole;\n\t}\n\n\tgetUserPopup(users, groups, departments, sonetgroups): Popup\n\t{\n\t\tif (!this.popupUsers)\n\t\t{\n\t\t\tusers = users || [];\n\t\t\tgroups = groups || [];\n\t\t\tdepartments = departments || [];\n\t\t\tsonetgroups = sonetgroups || [];\n\n\t\t\tconst content = Tag.render`<div class='ui-access-rights-popup-toggler'></div>`;\n\n\t\t\tconst contentTitle = Tag.render`<div class='ui-access-rights-popup-toggler-title'></div>`;\n\n\t\t\tconst onTitleClick = (event: BaseEvent) => {\n\t\t\t\tconst node = event.target;\n\t\t\t\tactivate(node);\n\t\t\t\tadjustSlicker(node);\n\t\t\t};\n\n\t\t\tif (groups.length > 0)\n\t\t\t{\n\t\t\t\tconst groupTitleItem = Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-title-item ui-access-rights-popup-toggler-title-item-active'\n\t\t\t\t\t\tdata-role='ui-access-rights-popup-toggler-content-groups'\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_USER_GROUPS')}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(groupTitleItem, 'click', onTitleClick.bind(this));\n\n\t\t\t\tDom.append(groupTitleItem, contentTitle);\n\t\t\t}\n\n\t\t\tif (departments.length > 0)\n\t\t\t{\n\t\t\t\tconst groupTitleItem = Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-title-item'\n\t\t\t\t\t\tdata-role='ui-access-rights-popup-toggler-content-departments'\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_DEPARTMENTS')}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(groupTitleItem, 'click', onTitleClick.bind(this));\n\n\t\t\t\tDom.append(groupTitleItem, contentTitle);\n\t\t\t}\n\n\t\t\tif (users.length > 0)\n\t\t\t{\n\t\t\t\tconst groupTitleItem = Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-title-item'\n\t\t\t\t\t\tdata-role='ui-access-rights-popup-toggler-content-users'\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_STAFF')}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(groupTitleItem, 'click', onTitleClick.bind(this));\n\n\t\t\t\tDom.append(groupTitleItem, contentTitle);\n\t\t\t}\n\n\t\t\tif (sonetgroups.length > 0)\n\t\t\t{\n\t\t\t\tconst groupTitleItem = Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-title-item'\n\t\t\t\t\t\tdata-role='ui-access-rights-popup-toggler-content-sonetgroups'\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_SOCNETGROUP')}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tEvent.bind(groupTitleItem, 'click', onTitleClick.bind(this));\n\n\t\t\t\tDom.append(groupTitleItem, contentTitle);\n\t\t\t}\n\n\t\t\tDom.append(Tag.render`<div class='ui-access-rights-popup-toggler-title-slicker'></div>`, contentTitle);\n\n\t\t\tDom.append(contentTitle, content);\n\n\t\t\tif (groups.length > 0)\n\t\t\t{\n\t\t\t\tDom.append(this.getUserPopupTogglerGroup(groups, 'groups'), content);\n\t\t\t}\n\n\t\t\tif (departments.length > 0)\n\t\t\t{\n\t\t\t\tDom.append(this.getUserPopupTogglerGroup(departments, 'departments'), content);\n\t\t\t}\n\n\t\t\tif (users.length > 0)\n\t\t\t{\n\t\t\t\tDom.append(this.getUserPopupTogglerGroup(users, 'users'), content);\n\t\t\t}\n\n\t\t\tif (sonetgroups.length > 0)\n\t\t\t{\n\t\t\t\tDom.append(this.getUserPopupTogglerGroup(sonetgroups, 'sonetgroups'), content);\n\t\t\t}\n\n\t\t\tconst footer = Tag.render`<div class='ui-access-rights-popup-toggler-footer'></div>`;\n\n\t\t\tconst footerLink = Tag.render`\n\t\t\t\t<div class='ui-access-rights-popup-toggler-footer-link'>\n\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_ADD')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tEvent.bind(footerLink, 'click', (event: Event) => {\n\t\t\t\tthis.popupUsers.close();\n\t\t\t\tthis.showUserSelectorPopup();\n\t\t\t\tevent.preventDefault()\n\t\t\t});\n\n\t\t\tDom.append(footerLink, footer);\n\t\t\tDom.append(footer, content);\n\n\t\t\tconst adjustSlicker = (node) => {\n\t\t\t\tif (!Type.isDomNode(node))\n\t\t\t\t{\n\t\t\t\t\tnode = content.querySelector('.ui-access-rights-popup-toggler-title-item-active');\n\t\t\t\t}\n\t\t\t\tconst slicker = content.querySelector('.ui-access-rights-popup-toggler-title-slicker');\n\t\t\t\tDom.style(slicker, 'left', node.offsetLeft + 'px');\n\t\t\t\tDom.style(slicker, 'width', node.offsetWidth + 'px');\n\t\t\t};\n\n\t\t\tconst activate = (node) => {\n\t\t\t\tconst titles = content.querySelectorAll('.ui-access-rights-popup-toggler-title-item');\n\t\t\t\tconst contents = content.querySelectorAll('.ui-access-rights-popup-toggler-content');\n\n\t\t\t\tconst target = content.querySelector('.' + node.getAttribute('data-role'));\n\n\t\t\t\ttitles.forEach((item) => {\n\t\t\t\t\tDom.removeClass(item, 'ui-access-rights-popup-toggler-title-item-active');\n\t\t\t\t});\n\n\t\t\t\tcontents.forEach((item) => {\n\t\t\t\t\tDom.style(item, 'display', 'none');\n\t\t\t\t});\n\n\t\t\t\tDom.style(target, 'display', 'block');\n\t\t\t\tDom.addClass(node, 'ui-access-rights-popup-toggler-title-item-active');\n\t\t\t};\n\n\t\t\tthis.popupUsers = PopupWindowManager.create(\n\t\t\t\tnull,\n\t\t\t\tthis.getAddUserToRole(),\n\t\t\t\t{\n\t\t\t\t\tcontentPadding: 10,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\tcontent,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\toffsetTop: 5,\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t\toffset: 35,\n\t\t\t\t\t},\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcloseEsc: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupShow: () => {\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst firstActiveNode = content.querySelector('.ui-access-rights-popup-toggler-title-item');\n\n\t\t\t\t\t\t\t\tif (!firstActiveNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tDom.addClass(firstActiveNode, 'ui-access-rights-popup-toggler-title-item-active');\n\t\t\t\t\t\t\t\tadjustSlicker(firstActiveNode);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\t\tthis.popupUsers.destroy();\n\t\t\t\t\t\t\tthis.popupUsers = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.popupUsers;\n\t}\n\n\tgetUserPopupTogglerGroup(array, type)\n\t{\n\t\tconst node = Tag.render`<div class='ui-access-rights-popup-toggler-content'></div>`;\n\t\tDom.addClass(node, 'ui-access-rights-popup-toggler-content-' + type);\n\n\t\tarray.forEach((item) => {\n\t\t\tconst toggler = Tag.render`<div class='ui-access-rights-popup-toggler-content-item'></div>`;\n\n\t\t\tif (item.avatar)\n\t\t\t{\n\t\t\t\tconst avatar = Tag.render`\n\t\t\t\t\t<a \n\t\t\t\t\t\tclass='ui-access-rights-popup-toggler-content-item-userpic'\n\t\t\t\t\t\ttitle=\"${Text.encode(item.name)}\"\n\t\t\t\t\t></a>\n\t\t\t\t`;\n\t\t\t\tDom.style(avatar, 'backgroundImage', 'url(\\'' + encodeURI(item.avatar) + '\\')');\n\t\t\t\tDom.style(avatar, 'backgroundSize', 'cover');\n\t\t\t\tDom.append(avatar, toggler);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet iconClass = '';\n\n\t\t\t\tif (type === 'users')\n\t\t\t\t{\n\t\t\t\t\ticonClass = 'ui-icon-common-user';\n\t\t\t\t}\n\t\t\t\telse if (type === 'groups')\n\t\t\t\t{\n\t\t\t\t\ticonClass = 'ui-icon-common-user-group';\n\t\t\t\t}\n\t\t\t\telse if (type === 'sonetgroups' || type === 'departments')\n\t\t\t\t{\n\t\t\t\t\ticonClass = 'ui-icon-common-company';\n\t\t\t\t}\n\n\t\t\t\tconst emptyAvatar = Tag.render`<a class='ui-icon ui-icon-sm' title=\"${Text.encode(item.name)}\"><i></i></a>`;\n\t\t\t\tDom.addClass(emptyAvatar, iconClass);\n\t\t\t\tDom.style(emptyAvatar, 'margin', '5px 10px');\n\t\t\t\tDom.append(emptyAvatar, toggler);\n\t\t\t}\n\n\t\t\tDom.append(\n\t\t\t\tTag.render`<div class='ui-access-rights-popup-toggler-content-item-name'>${Text.encode(item.name)}</div>`,\n\t\t\t\ttoggler\n\t\t\t);\n\n\t\t\tconst removeButton = Tag.render`\n\t\t\t\t<div class='ui-access-rights-popup-toggler-content-item-remove'>${Loc.getMessage('JS_UI_ACCESSRIGHTS_REMOVE')}</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(removeButton, 'click', () => {\n\t\t\t\tthis.userGroup.accessCodes.splice(this.userGroup.accessCodes.indexOf(item.key), 1);\n\n\t\t\t\tdelete this.userGroup.accessCodes[item.key];\n\t\t\t\tdelete this.userGroup.members[item.key];\n\n\t\t\t\tDom.remove(toggler);\n\n\t\t\t\tthis.updateMembers();\n\t\t\t\tthis.adjustPopupUserControl();\n\t\t\t\tthis.grid.getButtonPanel().show();\n\t\t\t});\n\n\t\t\tDom.append(removeButton, toggler);\n\n\t\t\tDom.append(toggler, node);\n\t\t});\n\n\t\treturn node;\n\t}\n\n\tshowUserSelectorPopup(): void\n\t{\n\t\tconst selectorInstance = BX.Main\n\t\t\t.selectorManagerV2.controls[this.popupContainer]\n\t\t\t?.selectorInstance\n\t\t;\n\n\t\tif (selectorInstance)\n\t\t{\n\t\t\tselectorInstance.itemsSelected = {};\n\t\t}\n\n\t\tBX.onCustomEvent(this.openPopupEvent, [{\n\t\t\tid: this.popupContainer,\n\t\t\tbindNode: this.getAddUserToRole()\n\t\t}]);\n\n\t\tBX.onCustomEvent('BX.Main.SelectorV2:reInitDialog', [{\n\t\t\tselectorId: this.popupContainer,\n\t\t\tselectedItems: this.userGroup.accessCodes\n\t\t}]);\n\t}\n}\n","import {EventEmitter} from \"main.core.events\";\nimport {Dom, Event, Text, Tag, Loc} from 'main.core';\nimport Base from \"./base\";\n\nimport {PopupWindowManager} from \"main.popup\";\nimport ColumnItemOptions from \"../columnitem\";\n\nexport default class Role extends Base\n{\n\tstatic TYPE = 'role';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.column = options.column;\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEvent.bind(window, 'click', (event: Event) => {\n\t\t\tif (\n\t\t\t\tevent.target === this.getRole()\n\t\t\t\t|| event.target.closest('.ui-access-rights-role')\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.updateRole();\n\t\t\tthis.offRoleEditMode();\n\t\t});\n\n\t\tEventEmitter.subscribe(this.grid, 'onBeforeSave', () => {\n\t\t\tthis.updateRole();\n\t\t\tthis.offRoleEditMode();\n\t\t});\n\t}\n\n\tgetRole(): HTMLElement\n\t{\n\t\tif (this.role)\n\t\t{\n\t\t\treturn this.role;\n\t\t}\n\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:preservation', this.updateRole.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:preservation', this.offRoleEditMode.bind(this));\n\n\t\tthis.roleInput = Tag.render`\n\t\t\t\t<input\n\t\t\t\t\ttype='text'\n\t\t\t\t\tclass='ui-access-rights-role-input'\n\t\t\t\t\tvalue='${Text.encode(this.text)}'\n\t\t\t\t\tplaceholder='${Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLE_NAME')}'\n\t\t\t\t/>\n\t\t\t`;\n\n\t\tEvent.bind(this.roleInput, 'keydown', (event: Event) => {\n\t\t\tif (event.keyCode === 13)\n\t\t\t{\n\t\t\t\tthis.updateRole();\n\t\t\t\tthis.offRoleEditMode();\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(this.roleInput, 'input', () => {\n\t\t\tthis.grid.getButtonPanel().show();\n\t\t});\n\n\t\tthis.roleValue = Tag.render`<div class='ui-access-rights-role-value'>${Text.encode(this.text)}</div>`;\n\n\t\tconst editControl = Tag.render`<div class='ui-access-rights-role-edit'></div>`;\n\t\tEvent.bind(editControl, 'click', this.onRoleEditMode.bind(this));\n\n\t\tconst removeControl = Tag.render`<div class='ui-access-rights-role-remove'></div>`;\n\t\tEvent.bind(removeControl, 'click', this.showPopupConfirm.bind(this));\n\n\t\tconst roleControlWrapper = Tag.render`\n\t\t\t\t<div class='ui-access-rights-role-controls'>\n\t\t\t\t\t${editControl}\n\t\t\t\t\t${removeControl}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\tthis.role = Tag.render`\n\t\t\t\t<div class='ui-access-rights-role'>\n\t\t\t\t\t${this.roleInput}\n\t\t\t\t\t${this.roleValue}\n\t\t\t\t\t${roleControlWrapper}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\treturn this.role;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.getRole();\n\t}\n\n\tonRoleEditMode()\n\t{\n\t\tDom.addClass(this.getRole(), 'ui-access-rights-role-edit-mode');\n\t\tthis.roleInput.focus();\n\t}\n\n\tshowPopupConfirm()\n\t{\n\t\tif (!this.popupConfirm)\n\t\t{\n\t\t\t/**@ToDO check role*/\n\t\t\tthis.popupConfirm = PopupWindowManager.create(\n\t\t\t\tnull,\n\t\t\t\tthis.getRole(),\n\t\t\t\t{\n\t\t\t\t\twidth: 250,\n\t\t\t\t\toverlay: true,\n\t\t\t\t\tcontentPadding: 10,\n\t\t\t\t\tcontent: Loc.getMessage('JS_UI_ACCESSRIGHTS_POPUP_REMOVE_THIS_ROLE'),\n\t\t\t\t\tanimation: 'fading-slide'\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.popupConfirm.setButtons([\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_POPUP_REMOVE'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-sm ui-btn-primary',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.popupConfirm.close();\n\t\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:removeRole', this);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_POPUP_CANCEL'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-sm ui-btn-link',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.popupConfirm.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]);\n\t\t}\n\n\t\tthis.popupConfirm.show();\n\t}\n\n\tupdateRole(): void\n\t{\n\t\tif (this.roleValue.innerHTML === this.roleInput.value || this.roleInput.value === '')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.text = this.roleInput.value;\n\t\tthis.userGroup = this.column.getUserGroup();\n\n\t\tthis.roleValue.innerText = this.roleInput.value;\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:updateRole', this);\n\t}\n\n\toffRoleEditMode(): void\n\t{\n\t\tDom.removeClass(this.getRole(), 'ui-access-rights-role-edit-mode')\n\t}\n}\n","import {EventEmitter} from \"main.core.events\";\nimport {Dom, Tag} from \"main.core\";\nimport Base from \"./base\";\nimport ColumnItemOptions from \"../columnitem\";\n\nexport default class Changer extends Base\n{\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.isModify = false;\n\t}\n\n\tgetChanger(): HTMLElement\n\t{\n\t\tif (!this.changer)\n\t\t{\n\t\t\tthis.changer = Tag.render`<a class='ui-access-rights-column-item-changer'></a>`\n\t\t}\n\n\t\treturn this.changer;\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:reset', this.offChanger.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.refreshStatus.bind(this));\n\t}\n\n\trefreshStatus(): void\n\t{\n\t\tDom.removeClass(this.getChanger(), 'ui-access-rights-column-item-changer-on')\n\t}\n\n\toffChanger(): void\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.refreshStatus();\n\t\t\t});\n\t\t}\n\t}\n\n\tadjustChanger(): void\n\t{\n\t\tthis.isModify = !this.isModify;\n\n\t\tDom.toggleClass(this.getChanger(), 'ui-access-rights-column-item-changer-on');\n\t}\n}\n","import ColumnItemOptions from \"../columnitem\";\nimport {EventEmitter} from \"main.core.events\";\nimport \"ui.switcher\";\nimport {Dom} from \"main.core\";\nimport Changer from \"./changer\";\n\nexport default class Toggler extends Changer\n{\n\tstatic TYPE = 'toggler';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.switcher = new BX.UI.Switcher(\n\t\t\t{\n\t\t\t\tsize: 'small',\n\t\t\t\tchecked: this.currentValue === '1',\n\t\t\t\thandlers: {\n\t\t\t\t\tchecked: () => {\n\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:accessOn', this);\n\t\t\t\t\t},\n\t\t\t\t\tunchecked: () => {\n\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:accessOff', this);\n\t\t\t\t\t},\n\t\t\t\t\ttoggled: () => {\n\t\t\t\t\t\tthis.adjustChanger();\n\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\toffChanger(): void\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.switcher.check(!this.switcher.isChecked());\n\t\t}\n\n\t\tsuper.offChanger();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tDom.append(this.switcher.getNode(), this.getChanger());\n\n\t\treturn this.getChanger();\n\t}\n}\n","import {EventEmitter} from \"main.core.events\";\nimport {Event, Text, Tag, Loc, Dom} from 'main.core';\nimport Base from \"./base\";\n\nimport { Menu} from \"main.popup\";\nimport Role from \"./role\";\n\nexport default class Controller extends Base\n{\n\trender(): HTMLElement\n\t{\n\t\tif (!this.controller)\n\t\t{\n\t\t\tthis.controllerLink = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-controller-link'>\n\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_CREATE_ROLE')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.controllerMenu = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-controller-link'>\n\t\t\t\t\t${Loc.getMessage('JS_UI_ACCESSRIGHTS_COPY_ROLE')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.controllerMenu, 'click', () => {\n\t\t\t\tif (this.popupMenu)\n\t\t\t\t{\n\t\t\t\t\tthis.popupMenu.close();\n\t\t\t\t}\n\t\t\t\telse if (this.grid.getUserGroups().length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.getPopupMenu(this.grid.getUserGroups()).show();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.toggleControllerMenu();\n\n\t\t\tthis.controller = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-controller'>\n\t\t\t\t\t${this.controllerLink}\n\t\t\t\t\t${this.controllerMenu}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.controllerLink, 'click', () => {\n\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:addRole', [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: '0',\n\t\t\t\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLE_NAME'),\n\t\t\t\t\t\taccessRights: [],\n\t\t\t\t\t\tmembers: [],\n\t\t\t\t\t\taccessCodes: [],\n\t\t\t\t\t\ttype: Role.TYPE\n\t\t\t\t\t}\n\t\t\t\t]);\n\n\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\n\t\t\t\tthis.toggleControllerMenu();\n\t\t\t\tthis.grid.lock();\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('BX.UI.AccessRights.ColumnItem:removeRole', this.toggleControllerMenu.bind(this));\n\t\t}\n\n\t\treturn this.controller;\n\t}\n\n\tgetPopupMenu(options): Menu\n\t{\n\t\tif (!options)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\toptions.map(\n\t\t\t(data) => {\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Text.encode(data.title),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tconst accessRightsCopy = Object.assign([], data.accessRights);\n\t\t\t\t\t\tconst accessCodesCopy =  Object.assign([], data.accessCodes);\n\n\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\t'BX.UI.AccessRights.ColumnItem:copyRole',\n\t\t\t\t\t\t\t[{\n\t\t\t\t\t\t\t\tid: '0',\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLE_NAME'),\n\t\t\t\t\t\t\t\taccessRights: accessRightsCopy,\n\t\t\t\t\t\t\t\taccessCodes: accessCodesCopy,\n\t\t\t\t\t\t\t\ttype: Role.TYPE,\n\t\t\t\t\t\t\t\tmembers: data.members\n\t\t\t\t\t\t\t}]\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\t\t\t\t\t\tthis.popupMenu.destroy();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\n\t\treturn this.popupMenu = new Menu(\n\t\t\t'ui_accessrights_copy_role_list',\n\t\t\tthis.controllerMenu,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.popupMenu.destroy();\n\t\t\t\t\t\tthis.popupMenu = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\ttoggleControllerMenu()\n\t{\n\t\tif (this.grid.getUserGroups().length === 0)\n\t\t{\n\t\t\tDom.addClass(this.controllerMenu, 'ui-access-rights-column-item-controller-link--disabled');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.controllerMenu, 'ui-access-rights-column-item-controller-link--disabled');\n\t\t}\n\t}\n}\n","import ColumnItemOptions from \"../columnitem\";\nimport {Event, Text, Tag, Dom, Loc} from 'main.core';\n\nimport {PopupMenu} from \"main.popup\";\nimport Changer from \"./changer\";\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\n\ntype VariableItem = {\n\tid: number,\n\ttitle: string,\n}\n\nexport default class VariableSelector extends Changer\n{\n\tstatic TYPE = 'variables';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\n\t\tthis.selectedValues = [this.currentValue];\n\n\t\tthis.variables = options.variables || [];\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:reset', this.reset.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.refresh.bind(this));\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst title = this.getSelected()?.title ?? Loc.getMessage('JS_UI_ACCESSRIGHTS_ADD');\n\t\tconst variablesValue = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-text-link'>\n\t\t\t\t\t${Text.encode(title)}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\tEvent.bind(variablesValue, 'click', this.showVariablesPopup.bind(this));\n\n\t\tDom.append(variablesValue, this.getChanger());\n\n\t\treturn this.getChanger();\n\t}\n\n\trefresh(): HTMLElement\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.currentValue = this.selectedValues[0];\n\t\t\tthis.reset();\n\t\t}\n\t}\n\n\treset(): HTMLElement\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.selectedValues = [this.currentValue];\n\t\t\tthis.getChanger().innerHTML = '';\n\t\t\tthis.adjustChanger();\n\t\t\tthis.render();\n\t\t}\n\t}\n\n\tgetSelected(): VariableItem\n\t{\n\t\tconst selected = this.variables.filter(variable => this.selectedValues.includes(variable.id));\n\n\t\treturn selected[0];\n\t}\n\n\tshowVariablesPopup(event: Event): void\n\t{\n\t\tconst menuItems = [];\n\n\t\tthis.variables.map((data) => {\n\t\t\tmenuItems.push({\n\t\t\t\tid: data.id,\n\t\t\t\ttext: data.title,\n\t\t\t\tonclick: this.select.bind(this),\n\t\t\t});\n\t\t});\n\n\t\tPopupMenu.show(\n\t\t\t'ui-access-rights-column-item-popup-variables',\n\t\t\tevent.target,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tevents : {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tPopupMenu.destroy('ui-access-rights-column-item-popup-variables');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tselect(event: BaseEvent, item: MenuItem)\n\t{\n\t\tthis.selectedValues = [item.id];\n\n\t\titem\n\t\t\t.getMenuWindow()\n\t\t\t?.close()\n\t\t;\n\n\t\tthis.getChanger().innerHTML = '';\n\t\tthis.render();\n\t\tthis.adjustChanger();\n\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:selectAccessItems', this);\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\t}\n}\n","import {Tag, Text} from \"main.core\";\nimport Title from \"./title\";\n\nexport default class UserGroupTitle extends Title\n{\n\tstatic TYPE = 'userGroupTitle';\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div \n\t\t\t\tclass='ui-access-rights-column-item-text'\n\t\t\t\tdata-id='${this.getId()}'\n\t\t\t>\n\t\t\t\t${Text.encode(this.text)}\n\t\t\t</div>\n\t\t`;\n\t}\n}","import {DefaultFooter, Dialog, Item} from 'ui.entity-selector';\nimport {Dom, Loc, Tag, Event} from 'main.core';\n\nexport default class Footer extends DefaultFooter\n{\n\tconstructor(dialog: Dialog, options: { [option: string]: any })\n\t{\n\t\tsuper(dialog, options);\n\n\t\tthis.selectAllButton = Tag.render`<div class=\"ui-selector-footer-link ui-selector-search-footer-label--hide\">${Loc.getMessage('JS_UI_ACCESSRIGHTS_ALL_SELECT_LABEL')}</div>`;\n\t\tEvent.bind(this.selectAllButton, 'click', this.selectAll.bind(this));\n\t\tthis.deselectAllButton = Tag.render`<div class=\"ui-selector-footer-link ui-selector-search-footer-label--hide\">${Loc.getMessage('JS_UI_ACCESSRIGHTS_ALL_DESELECT_LABEL')}</div>`;\n\t\tEvent.bind(this.deselectAllButton, 'click', this.deselectAll.bind(this));\n\n\t\tthis.getDialog().subscribe('Item:onSelect', this.onItemStatusChange.bind(this));\n\t\tthis.getDialog().subscribe('Item:onDeselect', this.onItemStatusChange.bind(this));\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tthis.toggleSelectButtons();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t${this.selectAllButton}\n\t\t\t\t${this.deselectAllButton}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\ttoggleSelectButtons(): void\n\t{\n\t\tif (this.getDialog().getSelectedItems().length === this.getDialog().getItems().length)\n\t\t{\n\t\t\tif (Dom.hasClass(this.deselectAllButton, 'ui-selector-search-footer-label--hide'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.selectAllButton, 'ui-selector-search-footer-label--hide');\n\t\t\t\tDom.removeClass(this.deselectAllButton, 'ui-selector-search-footer-label--hide');\n\t\t\t}\n\t\t}\n\t\telse if (Dom.hasClass(this.selectAllButton, 'ui-selector-search-footer-label--hide'))\n\t\t{\n\t\t\tDom.addClass(this.deselectAllButton, 'ui-selector-search-footer-label--hide');\n\t\t\tDom.removeClass(this.selectAllButton, 'ui-selector-search-footer-label--hide');\n\t\t}\n\t}\n\n\tselectAll(): void\n\t{\n\t\tif (this.getDialog().getSelectedItems().length === this.getDialog().getItems().length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis\n\t\t\t.getDialog()\n\t\t\t.getItems()\n\t\t\t.forEach((item: Item) => {\n\t\t\t\titem.select();\n\t\t\t})\n\t\t;\n\t}\n\n\tdeselectAll(): void\n\t{\n\t\tthis\n\t\t\t.getDialog()\n\t\t\t.getSelectedItems()\n\t\t\t.forEach((item: Item) => {\n\t\t\t\titem.deselect();\n\t\t\t})\n\t\t;\n\t}\n\n\tonItemStatusChange(): void\n\t{\n\t\tthis.toggleSelectButtons();\n\t}\n}","import ColumnItemOptions from \"../../columnitem\";\nimport {Event, Text, Tag, Dom, Type, Loc} from 'main.core';\nimport {Dialog, Item} from 'ui.entity-selector';\n\nimport Changer from \"../changer\";\nimport {EventEmitter} from \"main.core.events\";\nimport Footer from \"./footer\";\nimport 'ui.hint';\n\ntype VariableItem = {\n\tid: number,\n\ttitle: string,\n}\n\nexport default class MultiSelector extends Changer\n{\n\tstatic TYPE = 'multivariables';\n\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tsuper(options);\n\t\tthis.variables = options.variables || [];\n\t\tthis.enableSearch = options.enableSearch ?? false;\n\t\tthis.placeholder = options.placeholder || '';\n\t\tthis.hintTitle = options.hintTitle || '';\n\t\tthis.allSelectedCode = Text.toNumber(options.allSelectedCode || -1);\n\t\tthis.showAvatars = options.showAvatars ?? true;\n\t\tthis.compactView = options.compactView ?? false;\n\t\tthis.currentValue = Type.isArray(options.currentValue) ? options.currentValue : [];\n\t\tthis.currentValue = this.currentValue.map(value => Text.toNumber(value));\n\t\tthis.selectedValues = this.currentValue;\n\n\t\tthis.variables = this.variables.map((item) => {\n\t\t\titem.entityId = item.entityId || 'editor-right-item';\n\t\t\titem.tabs = 'recents';\n\t\t\treturn item;\n\t\t});\n\n\t\tthis.selector = this.createSelector();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:reset', this.reset.bind(this));\n\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.refresh.bind(this));\n\t}\n\n\tcreateSelector(): Dialog\n\t{\n\t\treturn new Dialog({\n\t\t\theight: 300,\n\t\t\tid: this.getId(),\n\t\t\tcontext: 'editor-right-items',\n\t\t\tenableSearch: this.enableSearch,\n\t\t\tmultiple: true,\n\t\t\tdropdownMode: true,\n\t\t\tcompactView: this.compactView,\n\t\t\tshowAvatars: this.showAvatars,\n\t\t\tselectedItems: this.getSelected(),\n\t\t\tsearchOptions: {\n\t\t\t\tallowCreateItem: false\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': this.setSelectedInputs.bind(this),\n\t\t\t\t'Item:onDeselect': this.setSelectedInputs.bind(this),\n\t\t\t},\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'editor-right-item',\n\t\t\t\t}\n\t\t\t],\n\t\t\titems: this.variables,\n\t\t\tfooter: Footer,\n\t\t});\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet title = '';\n\t\tif (this.includesSelected(this.allSelectedCode))\n\t\t{\n\t\t\ttitle = Loc.getMessage('JS_UI_ACCESSRIGHTS_ALL_ACCEPTED');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst titles = [];\n\t\t\tthis.getSelected()?.forEach((item) => {\n\t\t\t\ttitles.push(item.title)\n\t\t\t});\n\n\t\t\tif (titles.length > 0 )\n\t\t\t{\n\t\t\t\tconst firstItem = titles[0];\n\t\t\t\ttitle =\n\t\t\t\t\ttitles.length - 1 > 0\n\t\t\t\t\t\t? Loc.getMessage(\n\t\t\t\t\t\t\t'JS_UI_ACCESSRIGHTS_HAS_SELECTED_ITEMS',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'#FIRST_ITEM_NAME#':\n\t\t\t\t\t\t\t\t\tfirstItem.length > 10\n\t\t\t\t\t\t\t\t\t\t? firstItem.slice(0, 10) + '...'\n\t\t\t\t\t\t\t\t\t\t: firstItem\n\t\t\t\t\t\t\t\t,\n\t\t\t\t\t\t\t\t'#COUNT_REST_ITEMS#': titles.length - 1,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t\t: firstItem\n\t\t\t\t;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttitle = Loc.getMessage('JS_UI_ACCESSRIGHTS_ADD');\n\t\t\t}\n\t\t}\n\n\t\tlet hint = '';\n\t\tif (this.selector.getSelectedItems().length > 0)\n\t\t{\n\t\t\tconst hintTitle =\n\t\t\t\tType.isStringFilled(this.hintTitle)\n\t\t\t\t\t? this.hintTitle\n\t\t\t\t\t: Loc.getMessage('JS_UI_ACCESSRIGHTS_SELECTED_ITEMS_TITLE_MSGVER_1')\n\t\t\t;\n\t\t\thint += '<p>' + hintTitle + '</p>';\n\t\t\thint += '<ul>';\n\t\t\tthis.selector.getSelectedItems().forEach((item: Item) => hint += '<li>' + Text.encode(item.getTitle()))\n\t\t\thint += '</ul>';\n\t\t}\n\n\t\tconst variablesValue = Tag.render`\n\t\t\t\t<div class='ui-access-rights-column-item-text-link' data-hint-html data-hint-no-icon data-hint=\"${Text.encode(hint)}\">\n\t\t\t\t\t${Text.encode(title)}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\tEvent.bind(variablesValue, 'click', this.showSelector.bind(this));\n\n\t\tDom.append(variablesValue, this.getChanger());\n\n\t\tBX.UI.Hint.init(this.getChanger());\n\t\treturn this.getChanger();\n\t}\n\n\trefresh(): HTMLElement\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.currentValue = this.selectedValues;\n\t\t\tthis.reset();\n\t\t}\n\t}\n\n\treset(): HTMLElement\n\t{\n\t\tif (this.isModify)\n\t\t{\n\t\t\tthis.selectedValues = this.currentValue;\n\t\t\tthis.selector = this.createSelector();\n\t\t\tthis.getChanger().innerHTML = '';\n\t\t\tthis.adjustChanger();\n\t\t\tthis.render();\n\t\t}\n\t}\n\n\tgetSelected(): ?VariableItem[]\n\t{\n\t\tif (this.includesSelected(this.allSelectedCode))\n\t\t{\n\t\t\treturn this.variables;\n\t\t}\n\n\t\treturn this.variables.filter(variable => this.includesSelected(variable.id));\n\t}\n\n\tincludesSelected(item): boolean\n\t{\n\t\treturn this.selectedValues.includes(Text.toNumber(item));\n\t}\n\n\tshowSelector(event: Event): void\n\t{\n\t\tthis.selector.show();\n\t}\n\n\tsetSelectedInputs(): void\n\t{\n\t\tconst selected = this.selector.getSelectedItems();\n\t\tthis.selectedValues = [];\n\t\tif (selected.length === this.variables.length)\n\t\t{\n\t\t\tthis.selectedValues.push(this.allSelectedCode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tselected.forEach((item) => {\n\t\t\t\tthis.selectedValues.push(Text.toNumber(item.id));\n\t\t\t});\n\t\t}\n\n\t\tthis.getChanger().innerHTML = '';\n\t\tif (!this.isModify)\n\t\t{\n\t\t\tthis.adjustChanger();\n\t\t}\n\n\t\tthis.render();\n\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:update', this);\n\t\tEventEmitter.emit('BX.UI.AccessRights.ColumnItem:selectAccessItems', this);\n\t}\n}\n","import Column from \"./column\";\nimport Grid from \"./grid\";\nimport {Dom, Reflection, Tag} from 'main.core';\nimport Title from './item/title';\nimport Hint from './item/hint';\nimport Member from './item/member';\nimport Role from './item/role';\nimport Toggler from './item/toggler';\nimport Controller from './item/controller';\nimport VariableSelector from './item/variableselector';\nimport UserGroupTitle from './item/usergrouptitle';\nimport MultiSelector from \"./item/multivariable/multiselector\";\n\ntype ColumnItemOptions = {\n\tgrid: Grid;\n\tid: number;\n\ttype: string;\n\ttext: string;\n\tplaceholder: string;\n\thintTitle: string;\n\thint: string;\n\tvariables: [];\n\tenableSearch: boolean;\n\tshowAvatars: boolean;\n\tcompactView: boolean;\n\tuserGroup: null;\n\taccess: null;\n\tcurrentValue: null;\n\tcontroller: null;\n\topenPopupEvent: null;\n\tpopupContainer: null;\n\taccessCodes: null;\n\tallSelectedCode: number;\n\tcontainer: HTMLElement;\n\tcolumn: Column;\n};\n\nexport default class ColumnItem {\n\tconstructor(options: ColumnItemOptions)\n\t{\n\t\tthis.options = options;\n\t\tthis.type = options.type ? options.type : null;\n\t\tthis.hint = options.hint ? options.hint : null;\n\t\tthis.controller = options.controller ? options.controller : null;\n\t\tthis.column = options.column;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tlet item = null;\n\t\tconst container = Tag.render`<div class='ui-access-rights-column-item'></div>`;\n\t\tthis.options.container = container;\n\t\tif (this.type === Role.TYPE)\n\t\t{\n\t\t\titem = new Role(this.options);\n\t\t\tif (this.column.newColumn)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\titem.onRoleEditMode();\n\t\t\t\t\titem.roleInput.value = '';\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\telse if (this.type === Member.TYPE)\n\t\t{\n\t\t\titem = new Member(this.options);\n\t\t}\n\t\telse if (this.type === Title.TYPE)\n\t\t{\n\t\t\titem = new Title(this.options);\n\t\t}\n\t\telse if (this.type === VariableSelector.TYPE)\n\t\t{\n\t\t\titem = new VariableSelector(this.options);\n\t\t}\n\t\telse if (this.type === MultiSelector.TYPE)\n\t\t{\n\t\t\titem = new MultiSelector(this.options);\n\t\t}\n\t\telse if (this.type === Toggler.TYPE)\n\t\t{\n\t\t\titem = new Toggler(this.options);\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tDom.append(item.render(), container);\n\t\t}\n\n\t\tif (this.hint)\n\t\t{\n\t\t\tconst hintOptions = {\n\t\t\t\tclassName: 'ui-access-rights-column-item-notify',\n\t\t\t\t...this.options\n\t\t\t};\n\t\t\tDom.append((new Hint(hintOptions)).render(), container);\n\t\t}\n\n\t\tif (this.type === UserGroupTitle.TYPE)\n\t\t{\n\t\t\tDom.append((new UserGroupTitle(this.options)).render(), container);\n\t\t}\n\n\t\tif (this.controller)\n\t\t{\n\t\t\tDom.append((new Controller(this.options)).render(), container);\n\t\t}\n\n\t\treturn container;\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.UI.AccessRights');\nnamespace.ColumnItem = ColumnItem;\n","import {EventEmitter} from \"main.core.events\";\nimport {Dom, Event, Reflection, Tag} from 'main.core';\n\nimport Section from \"./section\";\nimport ColumnItem from \"./columnitem\";\nimport Role from \"./item/role\";\nimport Member from \"./item/member\";\nimport Title from \"./item/title\";\nimport UserGroupTitle from \"./item/usergrouptitle\";\nimport Toggler from \"./item/toggler\";\nimport VariableSelector from \"./item/variableselector\";\nimport MultiSelector from \"./item/multivariable/multiselector\";\n\ntype ColumnOptions = {\n\tgrid: Grid;\n\titems: [];\n\tuserGroup: [];\n\taccessCodes: [];\n\tsection: Section;\n\theadSection: Section;\n\tnewColumn: Column;\n\topenPopupEvent: string;\n\tpopupContainer: HTMLElement;\n};\n\nexport default class Column {\n\tconstructor(options: ColumnOptions)\n\t{\n\t\tthis.layout = {\n\t\t\tcontainer: null\n\t\t};\n\t\tthis.grid = options.grid ? options.grid : null;\n\t\tthis.items = options.items ? options.items : [];\n\t\tthis.userGroup = options.userGroup ? options.userGroup : null;\n\t\tthis.accessCodes = options.accessCodes ? options.accessCodes : null;\n\t\tthis.section = options.section ? options.section : null;\n\t\tthis.headSection = options.headSection;\n\t\tthis.newColumn = options.newColumn ? options.newColumn : null;\n\t\tthis.openPopupEvent = options.grid.openPopupEvent ? options.grid.openPopupEvent : null;\n\t\tthis.popupContainer = options.grid.popupContainer ? options.grid.popupContainer : null;\n\t}\n\n\tgetItem(options): ColumnItem\n\t{\n\t\toptions = options || {};\n\n\t\tlet param = {};\n\n\t\tif (options.type === UserGroupTitle.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\ttext: options.title,\n\t\t\t\tcontroller: options.controller\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === Title.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\tid: options.id,\n\t\t\t\ttype: options.type,\n\t\t\t\thint: options.hint,\n\t\t\t\ttext: options.title,\n\t\t\t\tcontroller: options.controller\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === Toggler.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\taccess: options.access\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === VariableSelector.TYPE || options.type === MultiSelector.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\ttext: options.title,\n\t\t\t\tvariables: options.variables,\n\t\t\t\taccess: options.access\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === MultiSelector.TYPE)\n\t\t{\n\t\t\tparam.allSelectedCode = options.allSelectedCode;\n\t\t\tparam.enableSearch = options.enableSearch;\n\t\t\tparam.showAvatars = options.showAvatars;\n\t\t\tparam.compactView = options.compactView;\n\t\t\tparam.hintTitle = options.hintTitle;\n\t\t}\n\n\t\tif (options.type === Role.TYPE)\n\t\t{\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\ttext: options.title\n\t\t\t}\n\t\t}\n\n\t\tif (options.type === Member.TYPE)\n\t\t{\n\t\t\tconst accessCodes = [];\n\n\t\t\tfor (const item in options.members)\n\t\t\t{\n\t\t\t\taccessCodes[item] = options.members[item].type;\n\t\t\t}\n\n\t\t\tparam = {\n\t\t\t\ttype: options.type,\n\t\t\t\taccessCodes: accessCodes\n\t\t\t}\n\t\t}\n\n\t\tparam.column = this;\n\t\tparam.userGroup = this.userGroup;\n\t\tparam.openPopupEvent = this.openPopupEvent;\n\t\tparam.popupContainer = this.popupContainer;\n\t\tparam.currentValue = null;\n\n\t\tparam.grid = this.grid;\n\n\t\tif (\n\t\t\toptions.type === VariableSelector.TYPE\n\t\t\t|| options.type === MultiSelector.TYPE\n\t\t\t|| options.type === Toggler.TYPE\n\t\t)\n\t\t{\n\t\t\tconst accessId = param.access.id.toString();\n\t\t\tconst accessRights = param.userGroup?.accessRights ?? [];\n\n\t\t\tfor (let i = 0; i < accessRights.length; i++)\n\t\t\t{\n\t\t\t\tif (accessId === accessRights[i].id.toString())\n\t\t\t\t{\n\t\t\t\t\tif (options.type === MultiSelector.TYPE)\n\t\t\t\t\t{\n\t\t\t\t\t\tparam.currentValue = param.currentValue ?? [];\n\t\t\t\t\t\tparam.currentValue.push(accessRights[i].value);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tparam.currentValue = accessRights[i].value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn new ColumnItem(param);\n\t}\n\n\tgetUserGroup(): []\n\t{\n\t\treturn this.userGroup;\n\t}\n\n\tremove(): void\n\t{\n\t\tif (Dom.hasClass(this.layout.container, 'ui-access-rights-column-new'))\n\t\t{\n\t\t\tthis.resetClassNew();\n\t\t}\n\n\t\tDom.addClass(this.layout.container,'ui-access-rights-column-remove')\n\t\tDom.style(this.layout.container, 'width', this.layout.container.offsetWidth + 'px')\n\n\t\tEvent.bind(this.layout.container, 'animationend', () => {\n\t\t\tDom.style(this.layout.container, 'minWidth', '0px')\n\t\t\tDom.style(this.layout.container, 'maxWidth', '0px')\n\t\t});\n\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(this.layout.container);\n\t\t}, 500);\n\t}\n\n\tresetClassNew(): void\n\t{\n\t\tDom.removeClass(this.layout.container,'ui-access-rights-column-new');\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.layout.container)\n\t\t{\n\t\t\tconst itemsFragment = document.createDocumentFragment();\n\n\t\t\tif (this.headSection)\n\t\t\t{\n\t\t\t\tthis.userGroup.type = Role.TYPE;\n\t\t\t\tDom.append(this.getItem(this.userGroup).render(), itemsFragment);\n\n\t\t\t\tthis.userGroup.type = Member.TYPE;\n\t\t\t\tDom.append(this.getItem(this.userGroup).render(), itemsFragment);\n\t\t\t}\n\n\t\t\tthis.items.map(\n\t\t\t\t(data) => {\n\t\t\t\t\tconst item = this.getItem(data);\n\t\t\t\t\tDom.append(item.render(), itemsFragment);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.layout.container = Tag.render`<div class='ui-access-rights-column'></div>`;\n\t\t\tif (this.newColumn)\n\t\t\t{\n\t\t\t\tDom.addClass('ui-access-rights-column-new', this.layout.container)\n\t\t\t}\n\n\t\t\tEventEmitter.subscribe('BX.UI.AccessRights:refresh', this.resetClassNew.bind(this));\n\n\t\t\tDom.append(itemsFragment, this.layout.container);\n\n\t\t\treturn this.layout.container;\n\t\t}\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.UI.AccessRights');\nnamespace.Column = Column;","import {EventEmitter, BaseEvent} from \"main.core.events\";\nimport {PopupMenu} from 'main.popup';\nimport {Dom, Event, Reflection, Text, Tag, Loc} from 'main.core';\nimport Grid from \"./grid\";\nimport Column from \"./column\";\nimport Title from \"./item/title\";\nimport UserGroupTitle from \"./item/usergrouptitle\";\nimport VariableSelector from \"./item/variableselector\";\nimport MultiSelector from \"./item/multivariable/multiselector\";\nimport Hint from \"./item/hint\";\n\ntype SectionOptions = {\n\tid: string;\n\theadSection: Section;\n\ttitle: string;\n\thint: string;\n\trights: [];\n\tuserGroups: [];\n\tgrid: Grid;\n};\n\nexport default class Section {\n\tconstructor(options: SectionOptions)\n\t{\n\t\tthis.id = options.id ?? null;\n\t\tthis.headSection = options.headSection ? options.headSection : null;\n\t\tthis.title = options.title;\n\t\tthis.hint = options.hint;\n\t\tthis.rights = options.rights ? options.rights : [];\n\t\tthis.userGroups = options.userGroups ? options.userGroups : [];\n\t\tthis.grid = options.grid ? options.grid : null;\n\n\t\tthis.layout = {\n\t\t\ttitle: null,\n\t\t\theadColumn: null,\n\t\t\tcolumns: null,\n\t\t\tcontent: null,\n\t\t\tearLeft: null,\n\t\t\tearRight: null\n\t\t};\n\n\t\tthis.scroll = 0;\n\t\tthis.earTimer = null;\n\t\tthis.earLeftTimer = null;\n\t\tthis.earRightTimer = null;\n\t\tthis.columns = [];\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe(this.grid, 'AccessRights.Section:scroll', (event: BaseEvent) => {\n\t\t\tconst [object] = event.getData();\n\t\t\tif (this.title !== object.title)\n\t\t\t{\n\t\t\t\tthis.getColumnsContainer().scrollLeft = object.getScroll()\n\t\t\t}\n\t\t\tobject.adjustEars();\n\t\t\tPopupMenu.destroy('ui-access-rights-column-item-popup-variables');\n\t\t});\n\n\t\tEvent.bind(window, 'resize', this.adjustEars.bind(this));\n\t}\n\n\tgetGrid(): Grid\n\t{\n\t\treturn this.grid;\n\t}\n\n\taddColumn(param): void\n\t{\n\t\tif(!param)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst options = Object.assign({}, param);\n\t\toptions.userGroup = param;\n\t\tconst column = this.getColumn(options);\n\n\t\tDom.append(column.render(), this.layout.columns)\n\t\tthis.columns.push(column);\n\t}\n\n\tgetColumn(options): Column\n\t{\n\t\tconst controls = [];\n\n\t\tthis.rights.map(\n\t\t\t(data) => {\n\t\t\t\tconst isVariable = (data.type === VariableSelector.TYPE || data.type === MultiSelector.TYPE);\n\n\t\t\t\tcontrols.push({\n\t\t\t\t\ttype: data.type,\n\t\t\t\t\ttitle: isVariable ? data.title : null,\n\t\t\t\t\thint: data.hint,\n\t\t\t\t\tvariables: isVariable ? data.variables : [],\n\t\t\t\t\tenableSearch: isVariable ? data.enableSearch : null,\n\t\t\t\t\tshowAvatars: isVariable ? data.showAvatars : false,\n\t\t\t\t\tcompactView: isVariable ? data.compactView : false,\n\t\t\t\t\thintTitle: isVariable ? data.hintTitle : null,\n\t\t\t\t\tallSelectedCode: isVariable ? data.allSelectedCode : null,\n\t\t\t\t\taccess: data\n\t\t\t\t})\n\t\t\t}\n\t\t);\n\n\t\treturn new Column({\n\t\t\titems: controls,\n\t\t\tuserGroup: options.userGroup ? options.userGroup : null,\n\t\t\tsection: this,\n\t\t\theadSection: options.headSection,\n\t\t\tgrid: this.grid,\n\t\t\tnewColumn: options.newColumn ? options.newColumn : null\n\t\t});\n\t}\n\n\tremoveColumn(param): void\n\t{\n\t\tif (!param)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < this.columns.length; i++)\n\t\t{\n\t\t\tif (param.userGroup === this.columns[i].userGroup)\n\t\t\t{\n\t\t\t\tthis.columns[i].remove();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\taddHeadColumn(): Column\n\t{\n\t\tlet titles = [];\n\n\t\tif(!this.headSection)\n\t\t{\n\t\t\tthis.rights.map((data) => {\n\t\t\t\ttitles.push({\n\t\t\t\t\tid: data.id,\n\t\t\t\t\ttype: Title.TYPE,\n\t\t\t\t\ttitle: data.title,\n\t\t\t\t\thint: data.hint\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\n\t\tif (this.headSection)\n\t\t{\n\t\t\ttitles = [\n\t\t\t\t{\n\t\t\t\t\ttype: UserGroupTitle.TYPE,\n\t\t\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_ROLES'),\n\t\t\t\t\tcontroller: true\n\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: UserGroupTitle.TYPE,\n\t\t\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_EMPLOYEES_AND_DEPARTMENTS'),\n\t\t\t\t\tcontroller: false\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\n\t\tconst column = new Column({\n\t\t\titems: titles,\n\t\t\tsection: this,\n\t\t\tgrid: this.grid\n\t\t});\n\n\t\tDom.append(column.render(), this.layout.headColumn);\n\n\t\treturn column;\n\t}\n\n\tgetColumnsContainer(): HTMLElement\n\t{\n\t\tif (!this.layout.columns)\n\t\t{\n\t\t\tconst column = Tag.render`<div class='ui-access-rights-section-wrapper'></div>`;\n\t\t\tEvent.bind(column, 'scroll', this.adjustScroll.bind(this));\n\t\t\tthis.layout.columns = column;\n\t\t}\n\n\t\treturn this.layout.columns;\n\t}\n\n\tgetTitleNode(): HTMLElement\n\t{\n\t\tconst node = Tag.render`<div class='ui-access-rights-section-title'>${Text.encode(this.title)}</div>`;\n\n\t\tif (this.hint)\n\t\t{\n\t\t\tconst hintNode = new Hint({\n\t\t\t\thint: this.hint,\n\t\t\t\tclassName: 'ui-access-rights-section-title-hint'\n\t\t\t});\n\t\t\tnode.appendChild(hintNode.render());\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tadjustScroll(): void\n\t{\n\t\tif (Text.toNumber(this.scroll) !== Text.toNumber(this.getColumnsContainer().scrollLeft))\n\t\t{\n\t\t\tthis.scroll = this.getColumnsContainer().scrollLeft;\n\t\t\tEventEmitter.emit(this.grid, \"AccessRights.Section:scroll\", [this]);\n\t\t}\n\t}\n\n\tadjustEars(): void\n\t{\n\t\tconst container = this.getColumnsContainer();\n\t\tconst scroll = container.scrollLeft;\n\n\t\tconst isLeftVisible = scroll > 0;\n\t\tconst isRightVisible = container.scrollWidth > (Math.round(scroll + container.offsetWidth));\n\n\t\tthis.getContentContainer().classList[isLeftVisible ? 'add' : 'remove']('ui-access-rights-section-ear-left-shown');\n\t\tthis.getContentContainer().classList[isRightVisible ? 'add' : 'remove']('ui-access-rights-section-ear-right-shown');\n\t}\n\n\tgetContentContainer(): HTMLElement\n\t{\n\t\tif (!this.layout.content)\n\t\t{\n\t\t\tthis.layout.content = Tag.render`\n\t\t\t\t<div class='ui-access-rights-section-content'>\n\t\t\t\t\t${this.getColumnsContainer()}\n\t\t\t\t\t${this.getEarLeft()}\n\t\t\t\t\t${this.getEarRight()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.content;\n\t}\n\n\tgetEarLeft(): HTMLElement\n\t{\n\t\tif (!this.layout.earLeft)\n\t\t{\n\t\t\tthis.layout.earLeft = Tag.render`<div class='ui-access-rights-section-ear-left'></div>`;\n\t\t\tEvent.bind(this.layout.earLeft, 'mouseenter', () => {\n\t\t\t\tthis.stopAutoScroll();\n\t\t\t\tthis.earLeftTimer =\tsetTimeout(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.scrollToLeft()\n\t\t\t\t\t},\n\t\t\t\t\t110\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tEvent.bind(this.layout.earLeft, 'mouseleave', () => {\n\t\t\t\tclearTimeout(this.earLeftTimer);\n\t\t\t\tthis.stopAutoScroll()\n\t\t\t});\n\t\t}\n\n\t\treturn this.layout.earLeft;\n\t}\n\n\tgetEarRight(): HTMLElement\n\t{\n\t\tif (!this.layout.earRight)\n\t\t{\n\t\t\tthis.layout.earRight = Tag.render`<div class='ui-access-rights-section-ear-right'></div>`;\n\t\t\tEvent.bind(this.layout.earRight, 'mouseenter', () => {\n\t\t\t\tthis.stopAutoScroll();\n\t\t\t\tthis.earRightTimer = setTimeout(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tthis.scrollToRight()\n\t\t\t\t\t},\n\t\t\t\t\t110\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tEvent.bind(this.layout.earRight, 'mouseleave', () => {\n\t\t\t\tclearTimeout(this.earRightTimer);\n\t\t\t\tthis.stopAutoScroll()\n\t\t\t});\n\t\t}\n\n\t\treturn this.layout.earRight;\n\t}\n\n\tscrollToRight(param: number, stop): void\n\t{\n\t\tconst interval = param ? 2 : 20;\n\n\t\tthis.earTimer = setInterval(\n\t\t\t() => {\n\t\t\t\tthis.getColumnsContainer().scrollLeft += 10;\n\t\t\t\tif(param && param <= this.getColumnsContainer().scrollLeft)\n\t\t\t\t{\n\t\t\t\t\t this.stopAutoScroll();\n\t\t\t\t}\n\t\t\t},\n\t\t\tinterval\n\t\t);\n\n\t\tif(stop === 'stop')\n\t\t{\n\t\t\tsetTimeout(\n\t\t\t\t() => {\n\t\t\t\t\tthis.stopAutoScroll();\n\t\t\t\t\tthis.getGrid().unlock();\n\t\t\t\t},\n\t\t\t\tparam * 2\n\t\t\t)\n\t\t}\n\t}\n\n\tscrollToLeft(): void\n\t{\n\t\tthis.earTimer = setInterval(\n\t\t\t() => {\n\t\t\t\tthis.getColumnsContainer().scrollLeft -= 10;\n\t\t\t},\n\t\t\t20\n\t\t)\n\t}\n\n\tstopAutoScroll(): void\n\t{\n\t\tclearInterval(this.earTimer);\n\t}\n\n\tgetScroll(): number\n\t{\n\t\treturn this.scroll;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst title = this.title ? this.getTitleNode() : null;\n\n\t\tconst sectionContainer = Tag.render`\n\t\t\t<div class='ui-access-rights-section'>\n\t\t\t\t${title}\n\t\t\t\t${this.getMainContainer()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.headSection)\n\t\t{\n\t\t\tDom.addClass(sectionContainer, 'ui-access-rights--head-section')\n\t\t}\n\n\t\tthis.addHeadColumn();\n\n\t\tconst columnsFragment = document.createDocumentFragment();\n\n\t\tconst userGroups = this.grid.getUserGroups() ?? [];\n\t\tfor (let i = 0; i < userGroups.length; i++)\n\t\t{\n\t\t\tconst column = this.getColumn(\n\t\t\t\t{\n\t\t\t\t\theadSection: this.headSection ? this.headSection : null,\n\t\t\t\t\tuserGroup: userGroups[i]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.columns.push(column);\n\t\t\tDom.append(column.render(), columnsFragment);\n\t\t}\n\n\t\tDom.append(columnsFragment, this.getColumnsContainer());\n\n\t\treturn sectionContainer;\n\t}\n\n\tgetMainContainer(): HTMLElement\n\t{\n\t\tthis.layout.headColumn = Tag.render`<div class='ui-access-rights-section-head'></div>`;\n\t\treturn Tag.render`\n\t\t\t<div class='ui-access-rights-section-container'>\n\t\t\t\t${this.layout.headColumn}\n\t\t\t\t${this.getContentContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n\nconst namespace = Reflection.namespace('BX.UI.AccessRights');\nnamespace.Section = Section;\n"],"names":["BX","Reflection","namespace","Grid","constructor","options","renderTo","buttonPanel","UI","ButtonPanel","layout","container","component","actionSave","ACTION_SAVE","actionDelete","ACTION_DELETE","actionLoad","ACTION_LOAD","mode","MODE","openPopupEvent","popupContainer","additionalSaveParams","loadParams","loader","timer","needToLoadUserGroups","initData","userGroups","accessRights","isRequested","loadData","bindEvents","EventEmitter","subscribe","updateRole","bind","updateAccessVariationRight","updateAccessRight","adjustButtonPanel","addUserGroup","addRoleColumn","removeRoleColumn","onGetEntityTypes","accessRightsSections","headSection","members","columns","fireEventReset","emit","fireEventRefresh","getButtonPanel","showNotification","title","Notification","Center","notify","content","position","autoHideDelay","sendActionRequest","setTimeout","blockGrid","needReload","dataToSave","i","length","Text","toNumber","id","push","accessCodes","type","ajax","runComponentAction","data","parameters","then","reloadGrid","Loc","getMessage","unBlockGrid","clearTimeout","waitContainer","getContainer","querySelector","Dom","removeClass","response","errorMessage","errors","message","lock","addClass","getMainContainer","unlock","deleteActionRequest","roleId","ACCESS_RIGHTS","USER_GROUPS","draw","offsetTop","getBoundingClientRect","top","style","getLoader","show","hide","Loader","target","param","removeColumn","map","targetIndex","indexOf","userGroup","splice","event","getData","sections","newColumn","addColumn","scrollToRight","getColumnsContainer","scrollWidth","offsetWidth","item","index","text","modifiedItems","querySelectorAll","modifiedRoles","modifiedUsers","modifiedVariables","accessId","access","value","switcher","isChecked","deleteIds","forEach","values","selectedValues","addSection","getColumns","getSections","getUserGroups","user","getHeadSection","Section","grid","hint","sectionHint","sectionTitle","rights","getSectionNode","Tag","render","docFragmentSections","document","createDocumentFragment","append","innerHTML","afterRender","adjustEars","onMemberSelect","params","option","buildOption","state","onMemberUnselect","controls","Main","selectorManagerV2","selectorInstance","Object","keys","entityTypes","USERGROUPS","enableSearch","searchById","addTab","returnItemUrl","getOption","dataColumnAttribute","node","bindOptions","hasAttribute","Type","isUndefined","columnId","getAttribute","accessItem","entityType","accessCodesResult","AccessRights","Base","currentValue","identificator","Math","random","parentContainer","getId","Title","encode","Event","adjustPopupHelper","popupHelper","close","set","cloneNode","body","remove","getPopupHelper","PopupWindowManager","create","autoHide","darkMode","maxWidth","offsetLeft","animation","TYPE","Hint","className","hintNode","hintManager","createInstance","popupParameters","angle","setAttribute","attributeName","attributeHtmlName","attributeInteractivityName","initNode","Member","addToAccessCodes","removeFromAccessCodes","resetNewMembers","getMember","member","membersFragment","counter","validateVariables","reverse","userNode","new","avatar","userAvatar","name","encodeURI","avatarClass","emptyAvatar","getAddUserToRole","adjustPopupUserControl","newMembers","updateMembers","firstKey","toUpperCase","entityId","url","toLowerCase","key","users","groups","departments","sonetgroups","counterUsers","showUserSelectorPopup","getUserPopup","addUserToRole","popupUsers","contentTitle","onTitleClick","activate","adjustSlicker","groupTitleItem","getUserPopupTogglerGroup","footer","footerLink","preventDefault","isDomNode","slicker","titles","contents","contentPadding","padding","offset","closeEsc","events","onPopupShow","firstActiveNode","onPopupClose","destroy","array","toggler","iconClass","removeButton","itemsSelected","onCustomEvent","bindNode","selectorId","selectedItems","Role","column","window","getRole","closest","offRoleEditMode","role","roleInput","keyCode","roleValue","editControl","onRoleEditMode","removeControl","showPopupConfirm","roleControlWrapper","focus","popupConfirm","width","overlay","setButtons","Button","click","getUserGroup","innerText","Changer","isModify","getChanger","changer","offChanger","refreshStatus","adjustChanger","toggleClass","Toggler","Switcher","size","checked","handlers","unchecked","toggled","check","getNode","Controller","controller","controllerLink","controllerMenu","popupMenu","getPopupMenu","toggleControllerMenu","menuItems","onclick","accessRightsCopy","assign","accessCodesCopy","Menu","VariableSelector","variables","reset","refresh","getSelected","variablesValue","showVariablesPopup","selected","filter","variable","includes","select","PopupMenu","getMenuWindow","UserGroupTitle","Footer","DefaultFooter","dialog","selectAllButton","selectAll","deselectAllButton","deselectAll","getDialog","onItemStatusChange","getContent","toggleSelectButtons","getSelectedItems","getItems","hasClass","deselect","MultiSelector","placeholder","hintTitle","allSelectedCode","showAvatars","compactView","isArray","tabs","selector","createSelector","Dialog","height","context","multiple","dropdownMode","searchOptions","allowCreateItem","setSelectedInputs","entities","items","includesSelected","firstItem","slice","isStringFilled","getTitle","showSelector","init","ColumnItem","hintOptions","Column","section","getItem","toString","resetClassNew","itemsFragment","headColumn","earLeft","earRight","scroll","earTimer","earLeftTimer","earRightTimer","object","scrollLeft","getScroll","getGrid","getColumn","isVariable","addHeadColumn","adjustScroll","getTitleNode","appendChild","isLeftVisible","isRightVisible","round","getContentContainer","classList","getEarLeft","getEarRight","stopAutoScroll","scrollToLeft","stop","interval","setInterval","clearInterval","sectionContainer","columnsFragment"],"mappings":"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"}