this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(e,t,s,i,r,a,l,o,n,d,c,b,h,u,p,g,v,f,P,m){"use strict";const L=f.createCommand("HIDE_DIALOG_COMMAND");const F=f.createCommand("DIALOG_VISIBILITY_COMMAND");const y=f.createCommand("DRAG_START_COMMAND");const H=f.createCommand("DRAG_END_COMMAND");var B=Object.freeze({HIDE_DIALOG_COMMAND:L,DIALOG_VISIBILITY_COMMAND:F,DRAG_START_COMMAND:y,DRAG_END_COMMAND:H});const C=1;const T={LINE_BREAK:"line-break",PARAGRAPH:"paragraph",MIXED:"mixed"};var O=Object.freeze({UNFORMATTED:C,NewLineMode:T});const E=Object.freeze({"\t":"\\t","\n":"\\n"});const N=new RegExp(Object.keys(E).join("|"),"g");const _=Object.freeze({ancestorHasNextSibling:"|",ancestorIsLastChild:" ",hasNextSibling:"\u251c",isLastChild:"\u2514",selectedChar:"^",selectedLine:">"});const M=[e=>e.hasFormat("bold")&&"Bold",e=>e.hasFormat("code")&&"Code",e=>e.hasFormat("italic")&&"Italic",e=>e.hasFormat("strikethrough")&&"Strikethrough",e=>e.hasFormat("subscript")&&"Subscript",e=>e.hasFormat("superscript")&&"Superscript",e=>e.hasFormat("underline")&&"Underline"];const S=[e=>e.isDirectionless()&&"Directionless",e=>e.isUnmergeable()&&"Unmergeable"];const D=[e=>e.isToken()&&"Token",e=>e.isSegmented()&&"Segmented"];const R={b:"bold",strong:"bold",i:"italic",em:"italic",s:"strikethrough",del:"strikethrough",u:"underline",sub:"subscript",sup:"superscript"};function I(e){const t=R[e.getName()];if(t===undefined){return{node:null}}return{forChild:e=>{if(f.$isTextNode(e)&&!e.hasFormat(t)){e.toggleFormat(t)}return e},node:null}}function x(e,s,i=true){const r=s.getBBCodeScheme();const a=new t.BBCodeParser({scheme:r});const l=a.parse(e);const o=l.getChildren();let n=[];for(const e of o){const t=w(e,s);if(t!==null){n=[...n,...t]}}return i?$(n,s):n}function w(e,t,s=new Map,i=null){if(e instanceof r.BBCodeNewLineNode){return[f.$createLineBreakNode()]}if(e instanceof r.BBCodeTabNode){return[f.$createTabNode()]}let a=[];let l=null;const o=j(e,t);const n=o?o(e):null;let d=null;if(n!==null){d=n.after;const t=n.node;l=Array.isArray(t)?t[t.length-1]:t;if(l!==null){for(const[,e]of s){l=e(l,i);if(!l){break}}if(l){a.push(...Array.isArray(t)?t:[l])}}if(m.Type.isFunction(n.forChild)){s.set(e.getName(),n.forChild)}}const c=e.getChildren();let b=[];for(const e of c){b.push(...w(e,t,new Map(s),l))}if(m.Type.isFunction(d)){b=d(b)}if(n===null){if(e.getType()===r.BBCodeNode.ELEMENT_NODE){const t=e;if(t.isVoid()){b=[f.$createTextNode(t.getOpeningTag()),...b]}else{b=[f.$createTextNode(t.getOpeningTag()),...b,f.$createTextNode(t.getClosingTag())]}}else{b=[f.$createTextNode(e.toString()),...b]}}if(l===null){a=[...a,...b]}else if(f.$isElementNode(l)){l.append(...b)}return a}function A(e){if(f.$isElementNode(e)&&e.isInline()===false){return false}return!(f.$isDecoratorNode(e)&&e.isInline()===false)}function $(e,t){const s=[];let i=null;let r=0;for(const t of e){if(f.$isLineBreakNode(t)){r++;continue}if(A(t)){if(i===null||r>=2){s.push(...K(r-2));i=f.$createParagraphNode();s.push(i)}else if(r===1){i.append(f.$createLineBreakNode())}i.append(t)}else{if(r>2){s.push(...K(r-2))}s.push(t);i=null}r=0}if(s.length===0){return[f.$createParagraphNode()]}return s}function K(e=1){const t=[];for(let s=0;s<e;s++){t.push(f.$createParagraphNode())}return t}function j(e,t){const s=e.getName();let i=null;const r=t.getBBCodeImportMap();const a=r.get(s.toLowerCase());if(a!==undefined){for(const t of a){const s=t(e);if(s!==null&&(i===null||i.priority<s.priority)){i=s}}}if(i===null){if(s==="#text"){return k}return null}return i.conversion}function k(e){let t=e.getContent();t=t.replaceAll(/\r?\n|\t/gm," ").replace("\r","");if(e.getParent().getName()!=="code"){t=t.replaceAll(/\s+/g," ")}if(t===""){return{node:null}}return{node:f.$createTextNode(t)}}function U(e){const t=[...e];const s=t[0];const i=t[t.length-1];if(f.$isLineBreakNode(s)||f.$isParagraphNode(s)&&s.isEmpty()){t.splice(0,1)}if(f.$isLineBreakNode(i)||f.$isParagraphNode(i)&&i.isEmpty()){t.splice(-1,1)}return t}function W(e,t){const s=t.getBBCodeScheme();const i=s.createRoot();const r=U(e.getChildren());for(const e of r){Y(e,i,t)}return i}function Y(e,t,s){const{node:i,after:r}=X(e,s);if(!i){return}const a=s.getBBCodeScheme();const l=a.createFragment();const o=f.$isElementNode(e)?e.getChildren():[];for(const e of o){Y(e,l,s)}i.appendChild(l);t.appendChild(i);if(m.Type.isFunction(r)){const t=r.call(e,i);if(t){i.getParent().replaceChild(i,t)}}}const z=["bold","italic","strikethrough","underline"];function X(e,t){const s=e.getType();const i=t.getBBCodeExportMap();const r=i.get(s);if(m.Type.isFunction(r)){return r(e)}const a=t.getBBCodeScheme();if(f.$isTextNode(e)&&e.getType()==="text"){const t=a.createText({encode:false,content:e.getTextContent()});if(e.getFormat()===0){return{node:t}}let s=t;z.forEach((t=>{const r=i.get(`text:${t}`);if(m.Type.isFunction(r)){s=r(e,s)||s}}));return{node:s}}if(f.$isLineBreakNode(e)){return{node:a.createNewLine()}}if(f.$isTabNode(e)){return{node:a.createTab()}}if(f.$isTextNode(e)||f.$isElementNode(e)){const t=a.createText({encode:false,content:e.getTextContent()});return{node:t}}return{node:null}}function G(e,t,s){const i=s.getBBCodeScheme();const r=i.createElement({name:t});r.appendChild(e);return r}function V(e){const t=e.anchor;const s=e.focus;const i=e.anchor.getNode();const r=e.focus.getNode();if(i===r){return i}const a=e.isBackward();if(a){return l.$isAtNodeEnd(s)?i:r}return l.$isAtNodeEnd(t)?i:r}var J=babelHelpers.classPrivateFieldLooseKey("textEditor");var q=babelHelpers.classPrivateFieldLooseKey("destroyed");var Q=babelHelpers.classPrivateFieldLooseKey("removeListeners");class Z{constructor(e){Object.defineProperty(this,J,{writable:true,value:null});Object.defineProperty(this,q,{writable:true,value:false});Object.defineProperty(this,Q,{writable:true,value:()=>{}});babelHelpers.classPrivateFieldLooseBase(this,J)[J]=e}static getName(){throw new Error("getName must be implemented in a child class")}static getNodes(e){return[]}importBBCode(){return null}exportBBCode(){return null}validateScheme(){return null}afterInit(){}getName(){return this.constructor.getName()}getEditor(){return babelHelpers.classPrivateFieldLooseBase(this,J)[J]}getLexicalEditor(){return babelHelpers.classPrivateFieldLooseBase(this,J)[J].getLexicalEditor()}cleanUpRegister(...e){babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]=P.mergeRegister(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q],...e)}isDestroyed(){return babelHelpers.classPrivateFieldLooseBase(this,q)[q]}destroy(){babelHelpers.classPrivateFieldLooseBase(this,q)[q]=true;babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]();babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]=null}}class ee extends d.EventEmitter{constructor(){super();this.setEventNamespace("BX.UI.TextEditor.ToolbarItem")}getContainer(){throw new Error("You must implement getContainer() method.")}render(){throw new Error("You must implement render() method.")}}let te=e=>e,se;var ie=babelHelpers.classPrivateFieldLooseKey("format");var re=babelHelpers.classPrivateFieldLooseKey("blockType");var ae=babelHelpers.classPrivateFieldLooseKey("active");var le=babelHelpers.classPrivateFieldLooseKey("disabled");var oe=babelHelpers.classPrivateFieldLooseKey("disableInsideUnformatted");var ne=babelHelpers.classPrivateFieldLooseKey("disableCallback");var de=babelHelpers.classPrivateFieldLooseKey("container");var ce=babelHelpers.classPrivateFieldLooseKey("handleClick");class be extends ee{constructor(...e){super(...e);Object.defineProperty(this,ce,{value:he});Object.defineProperty(this,ie,{writable:true,value:null});Object.defineProperty(this,re,{writable:true,value:null});Object.defineProperty(this,ae,{writable:true,value:false});Object.defineProperty(this,le,{writable:true,value:false});Object.defineProperty(this,oe,{writable:true,value:false});Object.defineProperty(this,ne,{writable:true,value:null});Object.defineProperty(this,de,{writable:true,value:null})}setContent(e){if(m.Type.isString(e)){this.getContainer().innerHTML=e}else if(m.Type.isElementNode(e)){this.getContainer().append(e)}}setFormat(e){babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]=e}getFormat(){return babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]}hasFormat(){return babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]}setBlockType(e){babelHelpers.classPrivateFieldLooseBase(this,re)[re]=e}getBlockType(){return babelHelpers.classPrivateFieldLooseBase(this,re)[re]}setTooltip(e){if(m.Type.isStringFilled(e)){m.Dom.attr(this.getContainer(),"title",m.Text.encode(e))}else if(e===null){m.Dom.attr(this.getContainer(),"title",null)}}disableInsideUnformatted(){babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]=true}enableInsideUnformatted(){babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]=false}shouldDisableInsideUnformatted(){return babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]}setActive(e=true){if(e===babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]){return}babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]=e;if(e){m.Dom.addClass(this.getContainer(),"--active")}else{m.Dom.removeClass(this.getContainer(),"--active")}}isActive(){return babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]}setDisabled(e=true){if(e===babelHelpers.classPrivateFieldLooseBase(this,le)[le]){return}babelHelpers.classPrivateFieldLooseBase(this,le)[le]=e;if(e){m.Dom.attr(this.getContainer(),{disabled:true})}else{m.Dom.attr(this.getContainer(),{disabled:null})}}disable(){this.setDisabled(true)}enable(){this.setDisabled(false)}isDisabled(){return babelHelpers.classPrivateFieldLooseBase(this,le)[le]}hasOwnDisableCallback(){return babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]!==null}setDisableCallback(e){if(m.Type.isFunction(e)){babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]=e}}invokeDisableCallback(){return babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]()}getContainer(){if(babelHelpers.classPrivateFieldLooseBase(this,de)[de]===null){babelHelpers.classPrivateFieldLooseBase(this,de)[de]=m.Tag.render(se||(se=te`
				<button 
					type="button" 
					class="ui-text-editor-toolbar-button"
					onclick="${0}"
				>
				</button>
			`),babelHelpers.classPrivateFieldLooseBase(this,ce)[ce].bind(this))}return babelHelpers.classPrivateFieldLooseBase(this,de)[de]}render(){return this.getContainer()}}function he(){this.emit("onClick")}class ue extends f.ParagraphNode{constructor(e,t){super(t);this.__mode=T.MIXED;this.__mode=e}static getType(){return"custom-paragraph"}static clone(e){return new ue(e.__mode,e.__key)}insertNewAfter(e,t){if(this.__mode===T.PARAGRAPH){return super.insertNewAfter(e,t)}if(this.__mode===T.MIXED){const s=this.getChildren();const i=s.length;if(i>=1&&s[i-1].getTextContent()==="\n"&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===i){s[i-1].remove();const e=f.$createParagraphNode();this.insertAfter(e,t);return e}}e.insertLineBreak();return null}exportJSON(){return{...super.exportJSON(),mode:this.__mode,type:"custom-paragraph",version:1}}static importDOM(){return{p:e=>({conversion:e=>({node:f.$createParagraphNode()}),priority:1}),h1:e=>({conversion:pe,priority:1}),h2:e=>({conversion:pe,priority:1}),h3:e=>({conversion:pe,priority:1}),h4:e=>({conversion:pe,priority:1}),h5:e=>({conversion:pe,priority:1}),h6:e=>({conversion:pe,priority:1})}}static importJSON(e){return super.importJSON(e)}}function pe(e){return{node:f.$createParagraphNode(),forChild:e=>{if(f.$isTextNode(e)){e.toggleFormat("bold")}return e}}}const ge=f.createCommand("FORMAT_PARAGRAPH_COMMAND");var ve=babelHelpers.classPrivateFieldLooseKey("registerCommands");var fe=babelHelpers.classPrivateFieldLooseKey("registerListeners");class Pe extends Z{constructor(e){super(e);Object.defineProperty(this,fe,{value:Le});Object.defineProperty(this,ve,{value:me});babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]();babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]()}static getName(){return"Paragraph"}static getNodes(e){return[ue,{replace:f.ParagraphNode,with:t=>new ue(e.getNewLineMode()),withClass:ue}]}importBBCode(){return{p:()=>({conversion:e=>Fe(e),priority:0}),left:()=>({conversion:e=>Fe(e),priority:0}),right:()=>({conversion:e=>Fe(e),priority:0}),center:()=>({conversion:e=>Fe(e),priority:0}),justify:()=>({conversion:e=>Fe(e),priority:0})}}exportBBCode(){return{paragraph:e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createElement({name:"p"})}},"custom-paragraph":e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createElement({name:"p"})}}}}validateScheme(){return{nodes:[{nodeClass:ue}],bbcodeMap:{root:"#root",tab:"#tab",text:"#text",paragraph:"p","custom-paragraph":"p",linebreak:"#linebreak"}}}}function me(){this.cleanUpRegister(this.getEditor().registerCommand(ge,(()=>{const e=f.$getSelection();if(f.$isRangeSelection(e)){l.$setBlocksType(e,(()=>f.$createParagraphNode()))}return true}),f.COMMAND_PRIORITY_EDITOR))}function Le(){this.cleanUpRegister(this.getEditor().registerNodeTransform(f.RootNode,(e=>{const t=e.getLastChild();if(!f.$isParagraphNode(t)){e.append(f.$createParagraphNode())}})))}function Fe(e){return{node:f.$createParagraphNode(),after:e=>U(e)}}var ye=Object.freeze({FORMAT_PARAGRAPH_COMMAND:ge,ParagraphPlugin:Pe});class He extends f.TextNode{constructor(e,t,s){super(e,s);this.__flags=C;this.__highlightType=t}static getType(){return"code-token"}static clone(e){return new He(e.__text,e.__highlightType||undefined,e.__key)}getHighlightType(){const e=this.getLatest();return e.__highlightType}createDOM(e){const t=super.createDOM(e);const s=Be(e.theme,this.__highlightType);P.addClassNamesToElement(t,s);return t}updateDOM(e,t,s){const i=super.updateDOM(e,t,s);const r=Be(s.theme,e.__highlightType);const a=Be(s.theme,this.__highlightType);if(r!==a){if(r){P.removeClassNamesFromElement(t,r)}if(a){P.addClassNamesToElement(t,a)}}return i}static importJSON(e){const t=Ce(e.text,e.highlightType);t.setFormat(e.format);t.setDetail(e.detail);t.setMode(e.mode);t.setStyle(e.style);return t}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType(),type:"code-token",version:1}}setFormat(e){return this}isParentRequired(){return true}createParentElementNode(){return Ee()}}function Be(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function Ce(e,t){return f.$applyNodeReplacement(new He(e,t))}function Te(e){return e instanceof He}class Oe extends f.ElementNode{constructor(...e){super(...e);this.__language="lexical-hack";this.__flags=C}static getType(){return"code"}static clone(e){return new Oe(e.__key)}createDOM(e,t){var s;const i=document.createElement("code");i.setAttribute("spellcheck","false");if(m.Type.isStringFilled(e==null?void 0:(s=e.theme)==null?void 0:s.code)){m.Dom.addClass(i,e.theme.code)}return i}updateDOM(e,t,s){return false}exportDOM(e){var t,s;const i=document.createElement("pre");i.setAttribute("spellcheck","false");if(m.Type.isStringFilled((t=e._config)==null?void 0:(s=t.theme)==null?void 0:s.code)){m.Dom.addClass(i,e._config.theme.code)}return{element:i}}static importDOM(){return{code:e=>{const t=e.textContent!==null&&(/\r?\n/.test(e.textContent)||$e(e,"BR"));return t?{conversion:_e,priority:1}:null},div:e=>({conversion:Me,priority:1}),pre:e=>({conversion:_e,priority:0}),table:e=>{const t=e;if(Ae(t)){return{conversion:Se,priority:3}}return null},td:e=>{const t=e;const s=t.closest("table");if(we(t)){return{conversion:Re,priority:3}}if(s&&Ae(s)){return{conversion:De,priority:3}}return null},tr:e=>{const t=e;const s=t.closest("table");if(s&&Ae(s)){return{conversion:De,priority:3}}return null}}}static importJSON(e){const t=Ee();t.setFormat(e.format);t.setIndent(e.indent);t.setDirection(e.direction);return t}exportJSON(){return{...super.exportJSON(),type:"code"}}canIndent(){return false}canReplaceWith(e){return false}isInline(){return false}collapseAtStart(e){const t=f.$createParagraphNode();const s=this.getChildren();s.forEach((e=>t.append(e)));this.replace(t);return true}insertNewAfter(e,t=true){const s=this.getChildren();const i=s.length;if(i>=2&&s[i-1].getTextContent()==="\n"&&s[i-2].getTextContent()==="\n"&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===i){s[i-1].remove();s[i-2].remove();const e=f.$createParagraphNode();this.insertAfter(e,t);return e}const{anchor:r,focus:a}=e;const l=r.isBefore(a)?r:a;const o=l.getNode();if(f.$isTextNode(o)){let e=pt(o);const t=[];while(true){if(f.$isTabNode(e)){t.push(f.$createTabNode());e=e.getNextSibling()}else if(Te(e)){let s=0;const i=e.getTextContent();const r=e.getTextContentSize();while(s<r&&i[s]===" "){s++}if(s!==0){t.push(Ce(" ".repeat(s)))}if(s!==r){break}e=e.getNextSibling()}else{break}}const s=o.splitText(r.offset)[0];const i=r.offset===0?0:1;const a=s.getIndexWithinParent()+i;const l=o.getParentOrThrow();const d=[f.$createLineBreakNode(),...t];l.splice(a,0,d);const c=t[t.length-1];if(c){c.select()}else if(r.offset===0){s.selectPrevious()}else{var n;(n=s.getNextSibling())==null?void 0:n.selectNext(0,0)}}if(Ne(o)){const{offset:t}=e.anchor;o.splice(t,0,[f.$createLineBreakNode()]);o.select(t+1,t+1)}return null}}function Ee(){return f.$applyNodeReplacement(new Oe)}function Ne(e){return e instanceof Oe}function _e(e){return{node:Ee()}}function Me(e){const t=e;const s=Ie(t);if(!s&&!xe(t)){return{node:null}}return{after:t=>{const s=e.parentNode;if(s!==null&&e!==s.lastChild){t.push(f.$createLineBreakNode())}return t},node:s?Ee():null}}function Se(){return{node:Ee()}}function De(){return{node:null}}function Re(e){const t=e;return{after:e=>{if(t.parentNode&&t.parentNode.nextSibling){e.push(f.$createLineBreakNode())}return e},node:null}}function Ie(e){return e.style.fontFamily.match("monospace")!==null}function xe(e){let t=e.parentElement;while(t!==null){if(Ie(t)){return true}t=t.parentElement}return false}function we(e){return e.classList.contains("js-file-line")}function Ae(e){return e.classList.contains("js-file-line-container")}function $e(e,t){let s=false;for(const i of e.childNodes){if(m.Type.isElementNode(i)&&i.tagName===t){return true}s=$e(i,t)}return s}const Ke={WHITESPACE:"whitespace",SEMICOLON:"semicolon",OPERATOR:"operator",BRACE:"brace",BRACKET:"bracket",PARENTHESES:"parentheses",WORD:"word",REGEX:"regex",STRING_DOUBLE:"string-double",STRING_SINGLE:"string-single",STRING_TEMPLATE:"string-template",XML_COMMENT:"comment-xml",COMMENT_MULTILINE:"comment-multiline",COMMENT_SLASH:"comment-slash",COMMENT_HASH:"comment-hash"};const je=new Set([Ke.XML_COMMENT,Ke.COMMENT_MULTILINE,Ke.COMMENT_SLASH,Ke.COMMENT_HASH]);const ke=new Set([Ke.STRING_SINGLE,Ke.STRING_DOUBLE,Ke.STRING_TEMPLATE]);const Ue=new Set(["abstract","alias","and","arguments","array","asm","assert","auto","base","begin","bool","boolean","break","byte","case","catch","char","checked","class","clone","compl","const","continue","debugger","decimal","declare","def","default","defer","deinit","del","delegate","delete","do","double","echo","elif","else","elseif","elsif","end","ensure","enum","event","except","exec","explicit","export","extends","extension","extern","fallthrough","false","final","finally","fixed","float","for","foreach","friend","from","func","function","global","goto","guard","if","implements","implicit","import","include","include_once","init","inline","inout","instanceof","int","interface","internal","is","lambda","let","lock","long","module","mutable","namespace","NaN","native","new","next","nil","none","not","null","object","operator","or","out","override","package","params","pass","private","protected","protocol","public","raise","readonly","redo","ref","register","repeat","require","require_once","rescue","restrict","retry","return","sbyte","sealed","self","short","signed","sizeof","static","string","struct","subscript","super","switch","synchronized","template","then","this","throw","throws","transient","true","try","typealias","typedef","typeid","typename","typeof","unchecked","undef","undefined","union","unless","unsigned","until","use","using","var","virtual","void","volatile","wchar_t","when","where","while","with","xor","yield"]);function We(e,t){if(je.has(e)){return"comment"}if(ke.has(e)){return"string"}if(e===Ke.WORD){if(Ue.has(t)){return"keyword"}if(/\d+/.test(t)){return"number"}}return e}const Ye=/[\p{L}\p{N}0-9_$]/u;const ze=(e,t=true)=>{let s=0;let i=e[0];let r=1;let a=null;let l=null;let o="";let n=null;let d=null;let c=null;const b=[];const h=()=>{if(!r){return true}switch(n){case Ke.WHITESPACE:return/\S/.test(r);case Ke.OPERATOR:case Ke.SEMICOLON:case Ke.BRACKET:case Ke.BRACE:case Ke.PARENTHESES:return true;case Ke.WORD:return!Ye.test(r);case Ke.REGEX:return(a==="/"||a==="\n")&&c;case Ke.STRING_DOUBLE:return a==='"'&&c;case Ke.STRING_SINGLE:return a==="'"&&c;case Ke.STRING_TEMPLATE:return a==="`"&&c;case Ke.XML_COMMENT:return e[s-4]+l+a==="--\x3e";case Ke.COMMENT_MULTILINE:return l+a==="*/";case Ke.COMMENT_SLASH:case Ke.COMMENT_HASH:return r==="\n";default:return false}};const u=()=>{if(r==="#"){return Ke.COMMENT_HASH}if(r+i==="//"){return Ke.COMMENT_SLASH}if(r+i==="/*"){return Ke.COMMENT_MULTILINE}if(r+i+e[s+1]+e[s+2]==="\x3c!--"){return Ke.XML_COMMENT}if(r==="`"){return Ke.STRING_TEMPLATE}if(r==="'"){return Ke.STRING_SINGLE}if(r==='"'){return Ke.STRING_DOUBLE}if(r==="/"&&[Ke.WHITESPACE,Ke.OPERATOR].includes(d)&&a!=="<"){return Ke.REGEX}if(r==="("||r===")"){return Ke.PARENTHESES}if(r==="["||r==="]"){return Ke.BRACKET}if(r==="{"||r==="}"){return Ke.BRACE}if(Ye.test(r)){return Ke.WORD}if(r===";"){return Ke.SEMICOLON}if(/[!&*+,./:;<=>?@\\|~-]/.test(r)){return Ke.OPERATOR}return Ke.WHITESPACE};while(a=!je.has(n)&&a==="\\"?true:r){r=i;i=e[++s];c=o.length>1;if(n===null){n=u()}if(h()){if(o){b.push({content:o,type:We(n,o)})}if(n!==Ke.WHITESPACE&&!je.has(n)){d=n}o="";n=u()}o+=r;l=a}return t?Xe(b):b};const Xe=e=>{const t=[];let s=null;e.forEach((e=>{if((e.type==="whitespace"||e.type==="word")&&s!==null&&(s.type==="whitespace"||s.type==="word")){s.type="word";s.content+=e.content;return}if(e.type==="operator"&&s!==null&&s.type==="operator"){s.content+=e.content;return}s=e;t.push(e)}));return t};const Ge=f.createCommand("FORMAT_CODE_COMMAND");const Ve=f.createCommand("INSERT_CODE_COMMAND");var Je=babelHelpers.classPrivateFieldLooseKey("nodesCurrentlyHighlighting");var qe=babelHelpers.classPrivateFieldLooseKey("registerComponents");var Qe=babelHelpers.classPrivateFieldLooseKey("registerListeners");var Ze=babelHelpers.classPrivateFieldLooseKey("registerCommands");var et=babelHelpers.classPrivateFieldLooseKey("handleCodeNodeTransform");var tt=babelHelpers.classPrivateFieldLooseKey("handleTextNodeTransform");var st=babelHelpers.classPrivateFieldLooseKey("handleTab");var it=babelHelpers.classPrivateFieldLooseKey("handleMultilineIndent");class rt extends Z{constructor(e){super(e);Object.defineProperty(this,it,{value:bt});Object.defineProperty(this,st,{value:ct});Object.defineProperty(this,tt,{value:dt});Object.defineProperty(this,et,{value:nt});Object.defineProperty(this,Ze,{value:ot});Object.defineProperty(this,Qe,{value:lt});Object.defineProperty(this,qe,{value:at});Object.defineProperty(this,Je,{writable:true,value:new Set});babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze]();babelHelpers.classPrivateFieldLooseBase(this,qe)[qe]();babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe]()}static getName(){return"Code"}static getNodes(e){return[Oe,He]}importBBCode(){return{code:()=>({conversion:e=>({node:Ee(),after:e=>{const t=U(e);const s=t.map((e=>e.getTextContent())).join("");return[f.$createTextNode(s)]}}),priority:0})}}exportBBCode(){return{code:e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createElement({name:"code"})}},"code-token":e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createText({content:e.getTextContent(),encode:false})}}}}validateScheme(){return{nodes:[{nodeClass:Oe}],bbcodeMap:{code:"code"}}}}function at(){this.getEditor().getComponentRegistry().register("code",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --enclose-text-in-code-tag"></span>');e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_CODE"));e.setBlockType("code");e.subscribe("onClick",(()=>{this.getEditor().focus();this.getEditor().update((()=>{if(e.isActive()){this.getEditor().dispatchCommand(ge)}else{this.getEditor().dispatchCommand(Ge)}}))}));return e}))}function lt(){const e=babelHelpers.classPrivateFieldLooseBase(this,tt)[tt].bind(this);this.cleanUpRegister(this.getEditor().registerNodeTransform(Oe,babelHelpers.classPrivateFieldLooseBase(this,et)[et].bind(this)),this.getEditor().registerNodeTransform(f.TextNode,e),this.getEditor().registerNodeTransform(He,e),this.getEditor().registerCommand(f.FORMAT_TEXT_COMMAND,(()=>{const e=f.$getSelection();if(!f.$isRangeSelection(e)){return false}const t=V(e);return Te(t)||Ne(t)}),f.COMMAND_PRIORITY_HIGH),this.getEditor().registerCommand(f.KEY_TAB_COMMAND,(e=>{const t=babelHelpers.classPrivateFieldLooseBase(this,st)[st](e.shiftKey);if(t===null){return false}e.preventDefault();this.getEditor().dispatchCommand(t);return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.INSERT_TAB_COMMAND,(()=>{const e=f.$getSelection();if(!ht(e)){return false}f.$insertNodes([f.$createTabNode()]);return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.INDENT_CONTENT_COMMAND,(e=>babelHelpers.classPrivateFieldLooseBase(this,it)[it](f.INDENT_CONTENT_COMMAND)),f.COMMAND_PRIORITY_NORMAL),this.getEditor().registerCommand(f.OUTDENT_CONTENT_COMMAND,(e=>babelHelpers.classPrivateFieldLooseBase(this,it)[it](f.OUTDENT_CONTENT_COMMAND)),f.COMMAND_PRIORITY_NORMAL),this.getEditor().registerCommand(f.PASTE_COMMAND,(e=>{const t=f.$getSelection();if(!f.$isRangeSelection(t)||!(e instanceof ClipboardEvent)||e.clipboardData===null){return false}const s=P.$findMatchingParent(t.anchor.getNode(),(e=>Ne(e)));if(s){o.$insertDataTransferForPlainText(e.clipboardData,t);return true}return false}),f.COMMAND_PRIORITY_LOW))}function ot(){this.cleanUpRegister(this.getEditor().registerCommand(Ve,(e=>{const t=Ee();if(m.Type.isPlainObject(e)&&m.Type.isStringFilled(e.content)){const s=Pt(ze(e.content));t.append(...s);P.$insertNodeToNearestRoot(t)}else{P.$insertNodeToNearestRoot(t);t.selectEnd()}return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(Ge,(()=>{const e=f.$getSelection();if(f.$isRangeSelection(e)){if(e.isCollapsed()){l.$setBlocksType(e,(()=>Ee()))}else{const t=e.getTextContent();const s=Ee();e.insertNodes([s]);const i=f.$getSelection();if(f.$isRangeSelection(i)){i.insertRawText(t)}}}return true}),f.COMMAND_PRIORITY_EDITOR))}function nt(e){const t=e.getKey();if(babelHelpers.classPrivateFieldLooseBase(this,Je)[Je].has(t)){return}babelHelpers.classPrivateFieldLooseBase(this,Je)[Je].add(t);this.getEditor().update((()=>{mt(t,(()=>{const s=f.$getNodeByKey(t);if(!Ne(s)||!s.isAttached()){return false}const i=s.getTextContent();const r=Pt(ze(i));const a=vt(s.getChildren(),r);const{from:l,to:o,nodesForReplacement:n}=a;if(l!==o||n.length>0){e.splice(l,o-l,n);return true}return false}))}),{onUpdate:()=>{babelHelpers.classPrivateFieldLooseBase(this,Je)[Je].delete(t)},skipTransforms:true})}function dt(e){const t=e.getParent();if(Ne(t)){babelHelpers.classPrivateFieldLooseBase(this,et)[et](t)}else if(Te(e)){e.replace(f.$createTextNode(e.__text))}}function ct(e){const t=f.$getSelection();if(!f.$isRangeSelection(t)||!ht(t)){return null}const s=e?f.OUTDENT_CONTENT_COMMAND:f.INDENT_CONTENT_COMMAND;const i=e?f.OUTDENT_CONTENT_COMMAND:f.INSERT_TAB_COMMAND;const r=ut(t);if(r.length>1){return s}const a=t.getNodes();const l=a[0];if(Ne(l)){return s}const o=pt(l);const n=gt(l);const d=t.anchor;const c=t.focus;let b=null;let h=null;if(c.isBefore(d)){b=c;h=d}else{b=d;h=c}if(o!==null&&n!==null&&b.key===o.getKey()&&b.offset===0&&h.key===n.getKey()&&h.offset===n.getTextContentSize()){return s}return i}function bt(e){const t=f.$getSelection();if(!f.$isRangeSelection(t)||!ht(t)){return false}const s=ut(t);const i=s.length;if(s.length>1){for(let t=0;t<i;t++){const i=s[t];if(i.length>0){let s=i[0];if(t===0){s=pt(s)}if(s!==null){if(e===f.INDENT_CONTENT_COMMAND){s.insertBefore(f.$createTabNode())}else if(f.$isTabNode(s)){s.remove()}}}}return true}const r=t.getNodes();const a=r[0];if(Ne(a)){if(e===f.INDENT_CONTENT_COMMAND){t.insertNodes([f.$createTabNode()])}return true}const l=pt(a);if(e===f.INDENT_CONTENT_COMMAND){if(f.$isLineBreakNode(l)){l.insertAfter(f.$createTabNode())}else{l.insertBefore(f.$createTabNode())}}else if(f.$isTabNode(l)){l.remove()}return true}function ht(e){if(!f.$isRangeSelection(e)){return false}const t=e.anchor.getNode();const s=e.focus.getNode();if(t.is(s)&&Ne(t)){return true}const i=t.getParent();return Ne(i)&&i.is(s.getParent())}function ut(e){const t=e.getNodes();const s=[[]];if(t.length===1&&Ne(t[0])){return s}let i=s[0];for(const[e,r]of t.entries()){if(f.$isLineBreakNode(r)){if(e!==0&&i.length>0){i=[];s.push(i)}}else{i.push(r)}}return s}function pt(e){let t=e;let s=e;while(Te(s)||f.$isTabNode(s)){t=s;s=s.getPreviousSibling()}return t}function gt(e){let t=e;let s=e;while(Te(s)||f.$isTabNode(s)){t=s;s=s.getNextSibling()}return t}function vt(e,t){let s=0;while(s<e.length){if(!ft(e[s],t[s])){break}s++}const i=e.length;const r=t.length;const a=Math.min(i,r)-s;let l=0;while(l<a){l++;if(!ft(e[i-l],t[r-l])){l--;break}}const o=s;const n=i-l;const d=t.slice(s,r-l);return{from:o,nodesForReplacement:d,to:n}}function ft(e,t){return Te(e)&&Te(t)&&e.__text===t.__text&&e.__highlightType===t.__highlightType||f.$isTabNode(e)&&f.$isTabNode(t)||f.$isLineBreakNode(e)&&f.$isLineBreakNode(t)}function Pt(e){const t=[];e.forEach((e=>{const s=e.content.split(/([\t\n])/);const i=s.length;for(let r=0;r<i;r++){const i=s[r];if(i==="\n"||i==="\r\n"){t.push(f.$createLineBreakNode())}else if(i==="\t"){t.push(f.$createTabNode())}else if(i.length>0){t.push(Ce(i,e.type))}}}));return t}function mt(e,t){const s=f.$getNodeByKey(e);if(!Ne(s)||!s.isAttached()){return}const i=f.$getSelection();if(!f.$isRangeSelection(i)){t();return}const r=i.anchor;const a=r.offset;const l=r.type==="element"&&f.$isLineBreakNode(s.getChildAtIndex(r.offset-1));let o=0;if(!l){const e=r.getNode();o=a+e.getPreviousSiblings().reduce(((e,t)=>e+t.getTextContentSize()),0)}const n=t();if(!n){return}if(l){r.getNode().select(a,a);return}s.getChildren().some((e=>{const t=f.$isTextNode(e);if(t||f.$isLineBreakNode(e)){const s=e.getTextContentSize();if(t&&s>=o){e.select(o,o);return true}o-=s}return false}))}var Lt=Object.freeze({FORMAT_CODE_COMMAND:Ge,INSERT_CODE_COMMAND:Ve,CodePlugin:rt,getFirstCodeNodeOfLine:pt,getLastCodeNodeOfLine:gt,CodeNode:Oe,$createCodeNode:Ee,$isCodeNode:Ne,CodeTokenNode:He,$createCodeTokenNode:Ce,$isCodeTokenNode:Te});function Ft(e,t){return e.getEditorState().read((()=>{const e=f.$getNodeByKey(t);if(e===null){return false}return e.isSelected()}))}function yt(e,t){let s=false;const i=new Set;const r=e=>{i.add(e)};const a=e.registerUpdateListener((()=>{s=Ft(e,t);for(const e of i){e(s)}}));const l=s=>{e.update((()=>{let e=f.$getSelection();if(!f.$isNodeSelection(e)){e=f.$createNodeSelection();f.$setSelection(e)}if(s){e.add(t)}else{e.delete(t)}}))};const o=()=>{e.update((()=>{const e=f.$getSelection();if(f.$isNodeSelection(e)){e.clear()}}))};return{isSelected:()=>s,dispose:()=>{a()},onSelect:r,setSelected:l,clearSelection:o}}var Ht=babelHelpers.classPrivateFieldLooseKey("textEditor");var Bt=babelHelpers.classPrivateFieldLooseKey("target");var Ct=babelHelpers.classPrivateFieldLooseKey("nodeKey");var Tt=babelHelpers.classPrivateFieldLooseKey("options");var Ot=babelHelpers.classPrivateFieldLooseKey("nodeSelection");var Et=babelHelpers.classPrivateFieldLooseKey("unregisterCommands");var Nt=babelHelpers.classPrivateFieldLooseKey("registerCommands");var _t=babelHelpers.classPrivateFieldLooseKey("handleDelete");class Mt{constructor(e){Object.defineProperty(this,_t,{value:Dt});Object.defineProperty(this,Nt,{value:St});Object.defineProperty(this,Ht,{writable:true,value:null});Object.defineProperty(this,Bt,{writable:true,value:null});Object.defineProperty(this,Ct,{writable:true,value:null});Object.defineProperty(this,Tt,{writable:true,value:{}});Object.defineProperty(this,Ot,{writable:true,value:null});Object.defineProperty(this,Et,{writable:true,value:null});const{textEditor:t,target:s,nodeKey:i,options:r}=e;babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]=t;babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt]=s;babelHelpers.classPrivateFieldLooseBase(this,Ct)[Ct]=i;babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt]=r;babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot]=yt(this.getEditor(),this.getNodeKey());babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].onSelect((e=>{if(e){m.Dom.addClass(this.getTarget(),"--selected")}else{m.Dom.removeClass(this.getTarget(),"--selected")}}));babelHelpers.classPrivateFieldLooseBase(this,Et)[Et]=babelHelpers.classPrivateFieldLooseBase(this,Nt)[Nt]()}update(e){}destroy(){babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].dispose();babelHelpers.classPrivateFieldLooseBase(this,Et)[Et]()}getEditor(){return babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]}getNodeKey(){return babelHelpers.classPrivateFieldLooseBase(this,Ct)[Ct]}getTarget(){return babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt]}getNodeSelection(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot]}isSelected(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].isSelected()}setSelected(e){babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].setSelected(e)}getOptions(){return babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt]}getOption(e,t){if(!m.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt][e])){return babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt][e]}if(!m.Type.isUndefined(t)){return t}return null}}function St(){return P.mergeRegister(this.getEditor().registerCommand(f.CLICK_COMMAND,(e=>{if(this.getTarget().contains(e.target)){if(e.shiftKey){babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].setSelected(!babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].isSelected())}else{babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].clearSelection();babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].setSelected(true)}return true}return false}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_DELETE_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,_t)[_t].bind(this),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_BACKSPACE_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,_t)[_t].bind(this),f.COMMAND_PRIORITY_LOW))}function Dt(e){if(babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].isSelected()&&f.$isNodeSelection(f.$getSelection())){e.preventDefault();const t=f.$getNodeByKey(this.getNodeKey());babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].setSelected(false);if(t){t.remove();return true}}return false}let Rt=e=>e,It,xt;function wt(e,t,s){return Math.min(Math.max(e,t),s)}const At={EAST:1,SOUTH:2,WEST:4,NORTH:8};var $t=babelHelpers.classPrivateFieldLooseKey("positioning");var Kt=babelHelpers.classPrivateFieldLooseKey("freeTransform");var jt=babelHelpers.classPrivateFieldLooseKey("onPointerDownHandler");var kt=babelHelpers.classPrivateFieldLooseKey("onPointerMoveHandler");var Ut=babelHelpers.classPrivateFieldLooseKey("onPointerUpHandler");var Wt=babelHelpers.classPrivateFieldLooseKey("container");var Yt=babelHelpers.classPrivateFieldLooseKey("target");var zt=babelHelpers.classPrivateFieldLooseKey("editor");var Xt=babelHelpers.classPrivateFieldLooseKey("maxWidth");var Gt=babelHelpers.classPrivateFieldLooseKey("maxHeight");var Vt=babelHelpers.classPrivateFieldLooseKey("minWidth");var Jt=babelHelpers.classPrivateFieldLooseKey("minHeight");var qt=babelHelpers.classPrivateFieldLooseKey("handlePointerDown");var Qt=babelHelpers.classPrivateFieldLooseKey("handlePointerMove");var Zt=babelHelpers.classPrivateFieldLooseKey("handlePointerUp");var es=babelHelpers.classPrivateFieldLooseKey("getMaxContainerWidth");var ts=babelHelpers.classPrivateFieldLooseKey("getMaxContainerHeight");class ss extends d.EventEmitter{constructor({target:e,editor:t,minWidth:s,minHeight:i,maxWidth:r,maxHeight:a,events:l,freeTransform:o}){super();Object.defineProperty(this,ts,{value:os});Object.defineProperty(this,es,{value:ls});Object.defineProperty(this,Zt,{value:as});Object.defineProperty(this,Qt,{value:rs});Object.defineProperty(this,qt,{value:is});Object.defineProperty(this,$t,{writable:true,value:{currentHeight:0,currentWidth:0,direction:0,isResizing:false,ratio:0,startHeight:0,startWidth:0,startX:0,startY:0}});Object.defineProperty(this,Kt,{writable:true,value:false});Object.defineProperty(this,jt,{writable:true,value:null});Object.defineProperty(this,kt,{writable:true,value:null});Object.defineProperty(this,Ut,{writable:true,value:null});Object.defineProperty(this,Wt,{writable:true,value:null});Object.defineProperty(this,Yt,{writable:true,value:null});Object.defineProperty(this,zt,{writable:true,value:null});Object.defineProperty(this,Xt,{writable:true,value:"none"});Object.defineProperty(this,Gt,{writable:true,value:"none"});Object.defineProperty(this,Vt,{writable:true,value:100});Object.defineProperty(this,Jt,{writable:true,value:100});this.setEventNamespace("BX.UI.TextEditor.FigureResizer");babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]=e;babelHelpers.classPrivateFieldLooseBase(this,zt)[zt]=t;babelHelpers.classPrivateFieldLooseBase(this,Vt)[Vt]=Math.min(babelHelpers.classPrivateFieldLooseBase(this,Vt)[Vt],m.Type.isNumber(s)?s:Infinity);babelHelpers.classPrivateFieldLooseBase(this,Jt)[Jt]=Math.min(babelHelpers.classPrivateFieldLooseBase(this,Jt)[Jt],m.Type.isNumber(i)?i:Infinity);babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt]=m.Type.isNumber(r)?r:"none";babelHelpers.classPrivateFieldLooseBase(this,Gt)[Gt]=m.Type.isNumber(a)?a:"none";babelHelpers.classPrivateFieldLooseBase(this,Kt)[Kt]=o===true;babelHelpers.classPrivateFieldLooseBase(this,jt)[jt]=babelHelpers.classPrivateFieldLooseBase(this,qt)[qt].bind(this);babelHelpers.classPrivateFieldLooseBase(this,kt)[kt]=babelHelpers.classPrivateFieldLooseBase(this,Qt)[Qt].bind(this);babelHelpers.classPrivateFieldLooseBase(this,Ut)[Ut]=babelHelpers.classPrivateFieldLooseBase(this,Zt)[Zt].bind(this);this.subscribeFromOptions(l)}show(){m.Dom.addClass(this.getContainer(),"--shown")}hide(){m.Dom.removeClass(this.getContainer(),"--shown")}getContainer(){if(babelHelpers.classPrivateFieldLooseBase(this,Wt)[Wt]===null){const e=m.Tag.render(It||(It=Rt`
				<div
					class="ui-text-editor-figure-resizer-handle --north"
					data-direction="${0}"
					onpointerdown="${0}"
					></div>
				<div
					class="ui-text-editor-figure-resizer-handle --east"
					data-direction="${0}"
					onpointerdown="${0}"
					></div>
				<div
					class="ui-text-editor-figure-resizer-handle --south"
					data-direction="${0}"
					onpointerdown="${0}"
					></div>
				<div
					class="ui-text-editor-figure-resizer-handle --west"
					data-direction="${0}"
					onpointerdown="${0}"
					></div>
			`),At.NORTH,babelHelpers.classPrivateFieldLooseBase(this,jt)[jt],At.EAST,babelHelpers.classPrivateFieldLooseBase(this,jt)[jt],At.SOUTH,babelHelpers.classPrivateFieldLooseBase(this,jt)[jt],At.WEST,babelHelpers.classPrivateFieldLooseBase(this,jt)[jt]);babelHelpers.classPrivateFieldLooseBase(this,Wt)[Wt]=m.Tag.render(xt||(xt=Rt`
				<div class="ui-text-editor-figure-resizer">
					<div
						class="ui-text-editor-figure-resizer-handle --north-east"
						data-direction="${0}" 
						onpointerdown="${0}"
					></div>
					<div
						class="ui-text-editor-figure-resizer-handle --south-east"
						data-direction="${0}" 
						onpointerdown="${0}"
						></div>
					<div
						class="ui-text-editor-figure-resizer-handle --south-west"
						data-direction="${0}" 
						onpointerdown="${0}"
						></div>
					<div 
						class="ui-text-editor-figure-resizer-handle --north-west"
						data-direction="${0}" 
						onpointerdown="${0}"
						></div>
					${0}
				</div>
			`),At.NORTH|At.EAST,babelHelpers.classPrivateFieldLooseBase(this,jt)[jt],At.SOUTH|At.EAST,babelHelpers.classPrivateFieldLooseBase(this,jt)[jt],At.SOUTH|At.WEST,babelHelpers.classPrivateFieldLooseBase(this,jt)[jt],At.NORTH|At.WEST,babelHelpers.classPrivateFieldLooseBase(this,jt)[jt],babelHelpers.classPrivateFieldLooseBase(this,Kt)[Kt]?e:null)}return babelHelpers.classPrivateFieldLooseBase(this,Wt)[Wt]}getTarget(){return babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]}setTarget(e){babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]=e}getEditor(){return babelHelpers.classPrivateFieldLooseBase(this,zt)[zt]}isResizing(){return babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].isResizing}}function is(e){if(!this.getEditor().isEditable()){return}e.preventDefault();const t=Number(e.target.dataset.direction);const s=this.getTarget();const{width:i,height:r}=s.getBoundingClientRect();babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startWidth=i;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startHeight=r;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].ratio=i/r;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentWidth=i;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentHeight=r;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startX=e.clientX;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startY=e.clientY;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].isResizing=true;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].direction=t;this.emit("onResizeStart");m.Dom.addClass(this.getContainer(),"--resizing");m.Dom.style(s,{width:`${i}px`,height:`${r}px`});m.Event.bind(document,"pointermove",babelHelpers.classPrivateFieldLooseBase(this,kt)[kt]);m.Event.bind(document,"pointerup",babelHelpers.classPrivateFieldLooseBase(this,Ut)[Ut])}function rs(e){const t=this.getTarget();const s=babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].direction&(At.EAST|At.WEST);const i=babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].direction&(At.SOUTH|At.NORTH);if(babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].isResizing){if(s&&i){let s=Math.floor(babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startX-e.clientX);s=babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].direction&At.EAST?-s:s;const i=Math.round(wt(babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startWidth+s,babelHelpers.classPrivateFieldLooseBase(this,Vt)[Vt],babelHelpers.classPrivateFieldLooseBase(this,es)[es]()));const r=Math.ceil(i/babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].ratio);m.Dom.style(t,{width:`${i}px`,height:`${r}px`});this.emit("onResize",{width:i,height:r});babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentHeight=r;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentWidth=i}else if(i){let s=Math.floor(babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startY-e.clientY);s=babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].direction&At.SOUTH?-s:s;const i=Math.round(wt(babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startHeight+s,babelHelpers.classPrivateFieldLooseBase(this,Jt)[Jt],babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]()));m.Dom.style(t,"height",`${i}px`);this.emit("onResize",{width:babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentWidth,height:i});babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentHeight=i}else{let s=Math.floor(babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startX-e.clientX);s=babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].direction&At.EAST?-s:s;const i=Math.round(wt(babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startWidth+s,babelHelpers.classPrivateFieldLooseBase(this,Vt)[Vt],babelHelpers.classPrivateFieldLooseBase(this,es)[es]()));m.Dom.style(t,"width",`${i}px`);this.emit("onResize",{width:i,height:babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentHeight});babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentWidth=i}}}function as(){if(babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].isResizing){setTimeout((()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentWidth;const t=babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentHeight;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startWidth=0;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startHeight=0;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].ratio=0;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startX=0;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].startY=0;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentWidth=0;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].currentHeight=0;babelHelpers.classPrivateFieldLooseBase(this,$t)[$t].isResizing=false;m.Dom.removeClass(this.getContainer(),"--resizing");this.emit("onResizeEnd",{width:e,height:t});m.Event.unbind(document,"pointermove",babelHelpers.classPrivateFieldLooseBase(this,kt)[kt]);m.Event.unbind(document,"pointerup",babelHelpers.classPrivateFieldLooseBase(this,Ut)[Ut])}),200)}}function ls(){const e=m.Type.isNumber(babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt])?babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt]:Infinity;const t=this.getEditor().getRootElement();if(t!==null){return Math.min(t.getBoundingClientRect().width-20,e)}return 100}function os(){if(m.Type.isNumber(babelHelpers.classPrivateFieldLooseBase(this,Gt)[Gt])){return babelHelpers.classPrivateFieldLooseBase(this,Gt)[Gt]}const e=this.getEditor().getRootElement();if(e!==null){return e.getBoundingClientRect().height-20}return 100}let ns=e=>e,ds,cs;var bs=babelHelpers.classPrivateFieldLooseKey("refs");var hs=babelHelpers.classPrivateFieldLooseKey("figureResizer");var us=babelHelpers.classPrivateFieldLooseKey("render");var ps=babelHelpers.classPrivateFieldLooseKey("getContainer");var gs=babelHelpers.classPrivateFieldLooseKey("getImageContainer");var vs=babelHelpers.classPrivateFieldLooseKey("setDraggable");var fs=babelHelpers.classPrivateFieldLooseKey("handleResizeStart");var Ps=babelHelpers.classPrivateFieldLooseKey("handleResizeEnd");class ms extends Mt{constructor(e){super(e);Object.defineProperty(this,Ps,{value:Cs});Object.defineProperty(this,fs,{value:Bs});Object.defineProperty(this,vs,{value:Hs});Object.defineProperty(this,gs,{value:ys});Object.defineProperty(this,ps,{value:Fs});Object.defineProperty(this,us,{value:Ls});Object.defineProperty(this,bs,{writable:true,value:new h.MemoryCache});Object.defineProperty(this,hs,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,hs)[hs]=new ss({target:this.getImage(),editor:this.getEditor(),minWidth:this.getOption("width"),minHeight:this.getOption("height"),maxWidth:this.getOption("maxWidth"),maxHeight:this.getOption("maxHeight"),events:{onResizeStart:babelHelpers.classPrivateFieldLooseBase(this,fs)[fs].bind(this),onResizeEnd:babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps].bind(this)}});this.getNodeSelection().onSelect((e=>{if(e||babelHelpers.classPrivateFieldLooseBase(this,hs)[hs].isResizing()){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,ps)[ps](),"--selected");babelHelpers.classPrivateFieldLooseBase(this,hs)[hs].show()}else{m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,ps)[ps](),"--selected");babelHelpers.classPrivateFieldLooseBase(this,hs)[hs].hide()}const t=e&&!babelHelpers.classPrivateFieldLooseBase(this,hs)[hs].isResizing();babelHelpers.classPrivateFieldLooseBase(this,vs)[vs](t)}));this.update(this.getOptions());babelHelpers.classPrivateFieldLooseBase(this,us)[us]()}getImage(){return babelHelpers.classPrivateFieldLooseBase(this,bs)[bs].remember("image",(()=>{const e=document.createElement("img");e.draggable=false;e.src=this.getOption("src");return e}))}update(e){const t=`${e.width}px`;m.Dom.style(this.getImage(),{width:t,height:"auto"})}}function Ls(){m.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,ps)[ps](),this.getTarget())}function Fs(){return babelHelpers.classPrivateFieldLooseBase(this,bs)[bs].remember("container",(()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,hs)[hs].getContainer();return m.Tag.render(ds||(ds=ns`
				<div class="ui-text-editor-file-image-component">
					${0}
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,gs)[gs](),e)}))}function ys(){return babelHelpers.classPrivateFieldLooseBase(this,bs)[bs].remember("image-container",(()=>m.Tag.render(cs||(cs=ns`
				<div class="ui-text-editor-file-image-container">
					${0}
				</div>
			`),this.getImage())))}function Hs(e){m.Dom.attr(babelHelpers.classPrivateFieldLooseBase(this,gs)[gs](),{draggable:e});if(e){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,ps)[ps](),"--draggable")}else{m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,ps)[ps](),"--draggable")}}function Bs(e){babelHelpers.classPrivateFieldLooseBase(this,vs)[vs](false);this.setSelected(true)}function Cs(e){this.setSelected(true);this.getEditor().update((()=>{const t=f.$getNodeByKey(this.getNodeKey());if(Es(t)){const{width:s,height:i}=e.getData();t.setWidthAndHeight(s,i)}}))}class Ts extends f.DecoratorNode{constructor(e,t,s,i,r){super(r);this.__serverFileId=e;this.__info=m.Type.isPlainObject(t)?t:{};this.__width=m.Type.isNumber(s)&&s>0?Math.round(s):this.__info.previewWidth;this.__height=m.Type.isNumber(i)&&i>0?Math.round(i):this.__info.previewHeight}static getType(){return"file-image"}static clone(e){return new Ts(e.__serverFileId,e.__info,e.__width,e.__height,e.__key)}getId(){return this.__serverFileId}getServerFileId(){return this.__serverFileId}getInfo(){return this.__info}setWidthAndHeight(e,t){const s=this.getWritable();if(m.Type.isNumber(e)){s.__width=Math.round(e)}if(m.Type.isNumber(t)){s.__height=Math.round(t)}}getWidth(){const e=this.getLatest();return e.__width}getHeight(){const e=this.getLatest();return e.__height}isResized(){return this.__info.previewWidth!==this.getWidth()||this.__info.previewHeight!==this.getHeight()}static importJSON(e){return Os(e.serverFileId,e.info,e.width,e.height)}static importDOM(){return{img:e=>{if(!e.hasAttribute("data-file-image-id")){return null}return{conversion:e=>{const{fileImageId:t,fileImageInfo:s}=e.dataset;let i=null;try{i=JSON.parse(s)}catch{return null}const r=Os(t,i);return{node:r}},priority:1}}}}exportDOM(){return{element:null}}exportJSON(){return{info:this.__info,serverFileId:this.__serverFileId,width:this.getWidth(),height:this.getHeight(),type:"file-image",version:1}}createDOM(e,t){var s,i;const r=document.createElement("span");if(m.Type.isStringFilled(e==null?void 0:(s=e.theme)==null?void 0:(i=s.file)==null?void 0:i.image)){m.Dom.addClass(r,e.theme.file.image)}return r}updateDOM(e,t,s){return false}decorate(e,t){return{componentClass:ms,options:{src:this.__info.previewUrl,width:this.getWidth(),height:this.getHeight(),maxWidth:this.getWidth(),maxHeight:this.getHeight()}}}isInline(){return true}}Ts.useDecoratorComponent=true;function Os(e,t={},s=null,i=null){return new Ts(e,t,s,i)}function Es(e){return e instanceof Ts}class Ns extends f.TextNode{constructor(e,t,s){const i=m.Type.isPlainObject(t)?t:{};super(i.name||"",s);this.__serverFileId=e;this.__info=i}static getType(){return"file"}static clone(e){return new Ns(e.__serverFileId,e.__info,e.__key)}getId(){return this.__serverFileId}getServerFileId(){return this.__serverFileId}getInfo(){return this.__info}getName(){return this.__info.name||"unknown"}static importJSON(e){return _s(e.serverFileId,e.info)}static importDOM(){return{span:e=>{if(!e.hasAttribute("data-file-id")){return null}return{conversion:t=>{const{fileId:s,fileInfo:i}=e.dataset;let r=null;try{r=JSON.parse(i)}catch{return null}const a=_s(s,r);return{node:a}},priority:1}}}}exportDOM(){const e=document.createElement("span");e.textContent=this.getName();e.setAttribute("data-file-id",this.__serverFileId);e.setAttribute("data-file-info",JSON.stringify(this.__info));return{element:e}}exportJSON(){return{...super.exportJSON(),info:this.__info,serverFileId:this.__serverFileId,type:"file",version:1}}createDOM(e,t){var s,i;const r=document.createElement("span");if(m.Type.isStringFilled(e==null?void 0:(s=e.theme)==null?void 0:(i=s.file)==null?void 0:i.file)){m.Dom.addClass(r,e.theme.file.file)}r.textContent=this.getName();return r}updateDOM(e,t,s){return false}}function _s(e,t={}){return new Ns(e,t).setMode("token")}function Ms(e){return e instanceof Ns}let Ss=e=>e,Ds,Rs;var Is=babelHelpers.classPrivateFieldLooseKey("refs");var xs=babelHelpers.classPrivateFieldLooseKey("render");var ws=babelHelpers.classPrivateFieldLooseKey("getContainer");var As=babelHelpers.classPrivateFieldLooseKey("getVideoContainer");var $s=babelHelpers.classPrivateFieldLooseKey("setDraggable");class Ks extends Mt{constructor(e){super(e);Object.defineProperty(this,$s,{value:Ws});Object.defineProperty(this,As,{value:Us});Object.defineProperty(this,ws,{value:ks});Object.defineProperty(this,xs,{value:js});Object.defineProperty(this,Is,{writable:true,value:new h.MemoryCache});this.getNodeSelection().onSelect((e=>{if(e){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,ws)[ws](),"--selected")}else{m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,ws)[ws](),"--selected")}babelHelpers.classPrivateFieldLooseBase(this,$s)[$s](e)}));this.update(this.getOptions());babelHelpers.classPrivateFieldLooseBase(this,xs)[xs]()}update(e){}}function js(){m.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,ws)[ws](),this.getTarget())}function ks(){return babelHelpers.classPrivateFieldLooseBase(this,Is)[Is].remember("container",(()=>m.Tag.render(Ds||(Ds=Ss`
				<div class="ui-text-editor-file-video-component">
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,As)[As]())))}function Us(){return babelHelpers.classPrivateFieldLooseBase(this,Is)[Is].remember("video-container",(()=>m.Tag.render(Rs||(Rs=Ss`
				<div class="ui-text-editor-file-video-container"></div>
			`))))}function Ws(e){m.Dom.attr(babelHelpers.classPrivateFieldLooseBase(this,As)[As](),{draggable:e});if(e){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,ws)[ws](),"--draggable")}else{m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,ws)[ws](),"--draggable")}}class Ys extends f.DecoratorNode{constructor(e,t,s){super(s);this.__serverFileId=e;this.__info=m.Type.isPlainObject(t)?t:{}}static getType(){return"file-video"}static clone(e){return new Ys(e.__serverFileId,e.__info,e.__key)}getId(){return this.__serverFileId}getServerFileId(){return this.__serverFileId}getInfo(){return this.__info}static importJSON(e){return zs(e.serverFileId,e.info)}static importDOM(){return null}exportDOM(){return{element:null}}exportJSON(){return{info:this.__info,serverFileId:this.__serverFileId,type:"file-video",version:1}}createDOM(e,t){var s,i;const r=document.createElement("span");if(m.Type.isStringFilled(e==null?void 0:(s=e.theme)==null?void 0:(i=s.file)==null?void 0:i.video)){m.Dom.addClass(r,e.theme.file.video)}return r}updateDOM(e,t,s){return false}decorate(e,t){return{componentClass:Ks,options:{}}}isInline(){return true}}Ys.useDecoratorComponent=true;function zs(e,t={}){const s=new Ys(e,t);return f.$applyNodeReplacement(s)}function Xs(e){return e instanceof Ys}function Gs(e){const t=e.target;let s=null;if(t!==null){s=t.nodeType===9?t.defaultView:t.ownerDocument.defaultView}let i=null;const r=(s||window).getSelection();if(document.caretRangeFromPoint){i=document.caretRangeFromPoint(e.clientX,e.clientY)}else if(e.rangeParent&&r!==null){r.collapse(e.rangeParent,e.rangeOffset||0);i=r.getRangeAt(0)}else{throw new Error("Cannot get the selection when dragging")}return i}function Vs(e){const t=f.$getSelection();if(!f.$isNodeSelection(t)){return null}const s=t.getNodes();const i=s[0];return e(i)?i:null}let Js=e=>e,qs;const Qs="application/x-lexical-drag-image";const Zs=m.Tag.render(qs||(qs=Js`<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">`));function ei(e,t,s){const i=e=>e instanceof t;const r=()=>Vs((e=>i(e)));return P.mergeRegister(e.registerCommand(f.DRAGSTART_COMMAND,(t=>{const s=r();if(!s){return false}const i=ti(t,s);if(i){e.dispatchCommand(y)}return i}),f.COMMAND_PRIORITY_HIGH),e.registerCommand(f.DRAGOVER_COMMAND,(t=>{const s=r();if(!s){return false}return si(t,e)}),f.COMMAND_PRIORITY_LOW),e.registerCommand(f.DROP_COMMAND,(t=>{const i=r();if(!i){return false}e.dispatchCommand(H);return ii(t,e,i,s)}),f.COMMAND_PRIORITY_HIGH))}function ti(e,t){const s=e.dataTransfer;if(!s){return false}s.setData("text/plain","_");s.setDragImage(Zs,0,0);s.setData(Qs,JSON.stringify({data:t.exportJSON(),type:t.getType()}));return true}function si(e,t){if(!ri(e,t)){e.preventDefault()}return true}function ii(e,t,s,i){var r;const a=(r=e.dataTransfer)==null?void 0:r.getData(Qs);if(!a){return false}const{type:l,data:o}=JSON.parse(a);if(l!==s.getType()||!m.Type.isPlainObject(o)){return false}e.preventDefault();if(ri(e,t)&&m.Type.isFunction(i)){const t=Gs(e);s.remove();const r=f.$createRangeSelection();if(t!==null&&t!==undefined){r.applyDOMRange(t)}f.$setSelection(r);i(o)}return true}function ri(e,t){const s=e.target;const i=["code",".ui-text-editor__file-image"];const r=t.getThemeClass("image");if(m.Type.isStringFilled(r)){i.push(`.${r}`)}return s instanceof HTMLElement&&s.closest(i.join(","))===null&&t.getEditableContainer().contains(s.parentElement)}const ai={FILE:"file",IMAGE:"image",VIDEO:"video"};const li=f.createCommand("ADD_FILE_COMMAND");const oi=f.createCommand("ADD_FILES_COMMAND");const ni=f.createCommand("INSERT_FILE_COMMAND");const di=f.createCommand("REMOVE_FILE_COMMAND");const ci=f.createCommand("GET_INSERTED_FILES_COMMAND");var bi=babelHelpers.classPrivateFieldLooseKey("enabled");var hi=babelHelpers.classPrivateFieldLooseKey("mode");var ui=babelHelpers.classPrivateFieldLooseKey("files");var pi=babelHelpers.classPrivateFieldLooseKey("registerListeners");class gi extends Z{constructor(e){super(e);Object.defineProperty(this,pi,{value:vi});Object.defineProperty(this,bi,{writable:true,value:false});Object.defineProperty(this,hi,{writable:true,value:"file"});Object.defineProperty(this,ui,{writable:true,value:new Map});const t=e.getOption("file.mode");babelHelpers.classPrivateFieldLooseBase(this,bi)[bi]=["file","disk"].includes(t);if(!babelHelpers.classPrivateFieldLooseBase(this,bi)[bi]){return}babelHelpers.classPrivateFieldLooseBase(this,hi)[hi]=t;const s=e.getOption("file.files",[]);this.addFiles(s);babelHelpers.classPrivateFieldLooseBase(this,pi)[pi]();this.cleanUpRegister(ei(this.getEditor(),Ts,(e=>{this.getEditor().dispatchCommand(ni,e)})),ei(this.getEditor(),Ys,(e=>{this.getEditor().dispatchCommand(ni,e)})))}static getName(){return"File"}static getNodes(e){return[Ns,Ts,Ys]}importBBCode(){if(!this.isEnabled()){return null}return{[this.getMode()]:()=>({conversion:e=>{const t=e.getAttribute("id");const s=()=>({node:f.$createTextNode(e.toString())});if(!m.Type.isStringFilled(t)||this.getMode()==="disk"&&!/^n?\d+$/i.test(t)||this.getMode()==="file"&&!/^(\d+|[\da-f-]{36}\.[\da-f]{32,})$/i.test(t)){return s()}const i=this.getFile(t);if(i===null){return s()}const r=this.getFileType(i);if(r===ai.IMAGE){const s=m.Text.toInteger(e.getAttribute("width"));const r=m.Text.toInteger(e.getAttribute("height"));return{node:Os(t,i,s,r)}}if(r===ai.VIDEO){return{node:zs(t,i)}}return{node:_s(t,i)}},priority:0})}}exportBBCode(){if(!this.isEnabled()){return null}return{file:e=>{const t=this.getEditor().getBBCodeScheme();const s=this.getMode()==="disk"?{file:""}:{};s.id=e.getServerFileId();return{node:t.createElement({name:this.getMode(),attributes:s,inline:true})}},"file-video":e=>{const t=this.getEditor().getBBCodeScheme();const s=this.getMode()==="disk"?{file:""}:{};s.id=e.getServerFileId();return{node:t.createElement({name:this.getMode(),attributes:s,inline:false})}},"file-image":e=>{const t=this.getEditor().getBBCodeScheme();const s=this.getMode()==="disk"?{file:""}:{};s.id=e.getServerFileId();const i=t.createElement({name:this.getMode(),attributes:s,inline:true});if(e.isResized()){i.setAttribute("width",e.getWidth());i.setAttribute("height",e.getHeight())}return{node:i}}}}validateScheme(){if(!this.isEnabled()){return null}return{bbcodeMap:{file:this.getMode(),"file-image":this.getMode(),"file-video":this.getMode()}}}isEnabled(){return babelHelpers.classPrivateFieldLooseBase(this,bi)[bi]}getMode(){return babelHelpers.classPrivateFieldLooseBase(this,hi)[hi]}addFile(e){if(m.Type.isPlainObject(e)&&(m.Type.isStringFilled(e.serverFileId)||m.Type.isNumber(e.serverFileId))){const t=e.serverFileId.toString();if(!babelHelpers.classPrivateFieldLooseBase(this,ui)[ui].has(t)){babelHelpers.classPrivateFieldLooseBase(this,ui)[ui].set(e.serverFileId.toString(),e)}}}addFiles(e){if(m.Type.isArrayFilled(e)){e.forEach((e=>{this.addFile(e)}))}}getFile(e){if(m.Type.isStringFilled(e)||m.Type.isNumber(e)){return babelHelpers.classPrivateFieldLooseBase(this,ui)[ui].get(e.toString())||null}return null}getFileType(e){if(e!=null&&e.isImage){return ai.IMAGE}if(e!=null&&e.isVideo){return ai.VIDEO}return ai.FILE}removeFile(e,t=true){if(m.Type.isStringFilled(e)||m.Type.isNumber(e)){babelHelpers.classPrivateFieldLooseBase(this,ui)[ui].delete(e.toString());this.getEditor().update((()=>{const t=[...f.$nodesOfType(Ns),...f.$nodesOfType(Ts),...f.$nodesOfType(Ys)];t.forEach((t=>{if(t.getServerFileId().toString()===e.toString()){t.remove()}}))}),t?{tag:"history-merge"}:{})}}}function vi(){this.cleanUpRegister(this.getEditor().registerCommand(ni,(e=>{if(!m.Type.isPlainObject(e)||!m.Type.isPlainObject(e.info)||!m.Type.isNumber(e.serverFileId)&&!m.Type.isStringFilled(e.serverFileId)){return false}this.addFile(e.info);const t=this.getFileType(e.info);let s=null;if(t===ai.IMAGE){const t=e.info.previewWidth;const i=e.info.previewHeight;const r=e.width;const a=e.height;const l=r/t;const o=a/i;const n=Math.min(l,o);const d=n>1;const c=d?t:t*n;const b=d?i:i*n;s=Os(e.serverFileId,e.info,c,b)}else if(t===ai.VIDEO){s=zs(e.serverFileId,e.info)}else{s=_s(e.serverFileId,e.info)}f.$insertNodes([s]);if(f.$isRootOrShadowRoot(s.getParentOrThrow())){P.$wrapNodeInElement(s,f.$createParagraphNode).selectEnd()}return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(di,(e=>{if(!m.Type.isPlainObject(e)||!m.Type.isNumber(e.serverFileId)&&!m.Type.isStringFilled(e.serverFileId)){return false}this.removeFile(e.serverFileId,e.skipHistoryStack);return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(ci,(e=>{if(!m.Type.isFunction(e)){return false}const t=[...f.$nodesOfType(Ns),...f.$nodesOfType(Ts),...f.$nodesOfType(Ys)];e(t);return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(li,(e=>{this.addFile(e);return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(oi,(e=>{this.addFiles(e);return true}),f.COMMAND_PRIORITY_EDITOR))}var fi=Object.freeze({FileImageNode:Ts,$createFileImageNode:Os,$isFileImageNode:Es,FileImageComponent:ms,FileNode:Ns,$createFileNode:_s,$isFileNode:Ms,FileVideoNode:Ys,$createFileVideoNode:zs,$isFileVideoNode:Xs,FileType:ai,ADD_FILE_COMMAND:li,ADD_FILES_COMMAND:oi,INSERT_FILE_COMMAND:ni,REMOVE_FILE_COMMAND:di,GET_INSERTED_FILES_COMMAND:ci,FilePlugin:gi});function Pi(e){return/^(http:|https:|ftp:|blob:|\/)/i.test(e)}let mi=e=>e,Li,Fi;var yi=babelHelpers.classPrivateFieldLooseKey("refs");var Hi=babelHelpers.classPrivateFieldLooseKey("figureResizer");var Bi=babelHelpers.classPrivateFieldLooseKey("maxWidth");var Ci=babelHelpers.classPrivateFieldLooseKey("render");var Ti=babelHelpers.classPrivateFieldLooseKey("getContainer");var Oi=babelHelpers.classPrivateFieldLooseKey("getImageContainer");var Ei=babelHelpers.classPrivateFieldLooseKey("setDraggable");var Ni=babelHelpers.classPrivateFieldLooseKey("handleResizeStart");var _i=babelHelpers.classPrivateFieldLooseKey("handleResizeEnd");class Mi extends Mt{constructor(e){super(e);Object.defineProperty(this,_i,{value:wi});Object.defineProperty(this,Ni,{value:xi});Object.defineProperty(this,Ei,{value:Ii});Object.defineProperty(this,Oi,{value:Ri});Object.defineProperty(this,Ti,{value:Di});Object.defineProperty(this,Ci,{value:Si});Object.defineProperty(this,yi,{writable:true,value:new h.MemoryCache});Object.defineProperty(this,Hi,{writable:true,value:null});Object.defineProperty(this,Bi,{writable:true,value:"none"});babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi]=new ss({target:this.getImage(),editor:this.getEditor(),maxWidth:this.getMaxWidth(),events:{onResizeStart:babelHelpers.classPrivateFieldLooseBase(this,Ni)[Ni].bind(this),onResizeEnd:babelHelpers.classPrivateFieldLooseBase(this,_i)[_i].bind(this)}});this.getNodeSelection().onSelect((e=>{if(e||babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].isResizing()){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,Ti)[Ti](),"--selected");babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].show()}else{m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,Ti)[Ti](),"--selected");babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].hide()}const t=e&&!babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].isResizing();babelHelpers.classPrivateFieldLooseBase(this,Ei)[Ei](t)}));this.update(this.getOptions());babelHelpers.classPrivateFieldLooseBase(this,Ci)[Ci]()}getImage(){return babelHelpers.classPrivateFieldLooseBase(this,yi)[yi].remember("image",(()=>{const e=document.createElement("img");e.draggable=false;e.src=this.getOption("src");return e}))}getMaxWidth(){return babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi]}update(e){const t=m.Type.isNumber(e.width)?`${e.width}px`:"inherit";const s=m.Type.isNumber(e.height)?`${e.height}px`:"inherit";const i=m.Type.isNumber(e.maxWidth)?`${e.maxWidth}px`:null;babelHelpers.classPrivateFieldLooseBase(this,Bi)[Bi]=e.maxWidth;m.Dom.style(this.getImage(),{width:t,height:s,maxWidth:i})}}function Si(){m.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ti)[Ti](),this.getTarget())}function Di(){return babelHelpers.classPrivateFieldLooseBase(this,yi)[yi].remember("container",(()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,Hi)[Hi].getContainer();return m.Tag.render(Li||(Li=mi`
				<div class="ui-text-editor-image-component">
					${0}
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Oi)[Oi](),e)}))}function Ri(){return babelHelpers.classPrivateFieldLooseBase(this,yi)[yi].remember("image-container",(()=>m.Tag.render(Fi||(Fi=mi`
				<div class="ui-text-editor-image-container">
					${0}
				</div>
			`),this.getImage())))}function Ii(e){m.Dom.attr(babelHelpers.classPrivateFieldLooseBase(this,Oi)[Oi](),{draggable:e});if(e){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,Ti)[Ti](),"--draggable")}else{m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,Ti)[Ti](),"--draggable")}}function xi(e){babelHelpers.classPrivateFieldLooseBase(this,Ei)[Ei](false);this.setSelected(true)}function wi(e){this.setSelected(true);this.getEditor().update((()=>{const t=f.$getNodeByKey(this.getNodeKey());if(Ki(t)){const{width:s,height:i}=e.getData();t.setWidthAndHeight(s,i)}}))}class Ai extends f.DecoratorNode{constructor(e,t,s,i,r){super(r);this.__width="inherit";this.__height="inherit";this.__maxWidth="none";if(Pi(e)){this.__src=e}else{this.__src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"}if(m.Type.isNumber(t)){this.__width=Math.round(t)}if(m.Type.isNumber(s)){this.__height=Math.round(s)}if(m.Type.isNumber(i)){this.__maxWidth=Math.round(i)}}static getType(){return"image"}static clone(e){return new Ai(e.__src,e.__width,e.__height,e.__maxWidth,e.__key)}static importJSON(e){const{width:t,height:s,src:i,maxWidth:r}=e;return $i({src:i,width:t,height:s,maxWidth:r})}exportDOM(){const e=document.createElement("img");e.setAttribute("src",this.__src);e.setAttribute("width",this.__width.toString());e.setAttribute("height",this.__height.toString());return{element:e}}static importDOM(){return{img:e=>({conversion:e=>{if(e instanceof HTMLImageElement&&Pi(e.src)){const{src:t,width:s,height:i}=e;const r=$i({src:t,width:s,height:i});return{node:r}}return null},priority:0})}}exportJSON(){return{src:this.getSrc(),width:this.getWidth(),height:this.getHeight(),maxWidth:this.getMaxWidth(),type:"image",version:1}}setWidthAndHeight(e,t){const s=this.getWritable();if(m.Type.isNumber(e)){s.__width=Math.round(e)}else if(e==="inherit"){s.__width=e}if(m.Type.isNumber(t)){s.__height=Math.round(t)}else if(t==="inherit"){s.__height=t}}setMaxWidth(e){if(m.Type.isNumber(e)||e==="none"){const t=this.getWritable();t.__maxWidth=m.Type.isNumber(e)?Math.round(e):e}}createDOM(e){const t=document.createElement("span");const s=e.theme;const i=s.image;if(i!==undefined){t.className=i}return t}updateDOM(){return false}getSrc(){return this.__src}getWidth(){const e=this.getLatest();return e.__width}getHeight(){const e=this.getLatest();return e.__height}getMaxWidth(){const e=this.getLatest();return e.__maxWidth}decorate(e,t){return{componentClass:Mi,options:{src:this.getSrc(),width:this.getWidth(),height:this.getHeight(),maxWidth:this.getMaxWidth()}}}isInline(){return true}}Ai.useDecoratorComponent=true;function $i({src:e,width:t,height:s,maxWidth:i,key:r}){return f.$applyNodeReplacement(new Ai(e,t,s,i,r))}function Ki(e){return e instanceof Ai}function ji(e,t,s){const i=ki(t,e);if(i===null){return null}const r=i.getClientRects();const a=r.length>1;const l=t.isBackward();let o=l?r[0]:r[r.length-1];if(t.isCollapsed()&&(!o||o.left===0&&o.top===0)){let s=e.getElementByKey(t.anchor.key);let r=t.anchor.offset;if(s===null){s=i.startContainer;r=i.startOffset}const a=s.childNodes[r]||s;const l=a.getBoundingClientRect();o=new DOMRect(l.left,l.top,1,l.height)}if(!o){return null}const n=10;const d=s===document.body;const c=d?window.pageXOffset:s.scrollLeft;const b=d?window.pageYOffset:s.scrollTop;let h=(l?o.left:o.right)+c;let u=o.top+b;let p=o.bottom+b+n;if(!d){const e=s.getBoundingClientRect();u-=e.top;h-=e.left;p-=e.top}return{left:h,top:u,bottom:p,isBackward:l,isMultiline:a}}function ki(e,t){if(!f.$isRangeSelection(e)){return null}const s=document.createRange();const i=e.anchor.getNode();const r=e.focus.getNode();const a=i.getKey();const l=r.getKey();let o=t.getElementByKey(a);let n=t.getElementByKey(l);let d=e.anchor.offset;let c=e.focus.offset;if(f.$isTextNode(i)){o=Ui(o)}if(f.$isTextNode(r)){n=Ui(n)}if(o===null||n===null){return null}if(o.nodeName==="BR"){[o,d]=Wi(o)}if(n.nodeName==="BR"){[n,c]=Wi(n)}const b=o.firstChild;if(o===n&&b!==null&&b.nodeName==="BR"&&d===0&&c===0){c=1}try{s.setStart(o,d);s.setEnd(n,c)}catch{return null}if(s.collapsed&&(d!==c||a!==l)){s.setStart(n,c);s.setEnd(o,d)}return s}function Ui(e){let t=e;while(t!==null){if(t.nodeType===Node.TEXT_NODE){return t}t=t.firstChild}return null}function Wi(e){const t=e.parentNode;if(t===null){throw new Error("Should never happen")}return[t,[...t.childNodes].indexOf(e)]}const Yi=new WeakMap;const zi=16;function Xi(e,t,s){const i=f.$getSelection();if(!f.$isRangeSelection(i)){return false}const r=ji(t,i,document.body);if(r===null){return false}const{top:a,left:l,bottom:o,isBackward:n}=r;const d=m.Dom.getPosition(t.getScrollerContainer());const c=m.Dom.getPosition(e.getPopupContainer());const b=c.width;let h=b/2;if(l-h<d.left){const e=d.left-(l-h);h-=e+zi}else if(d.right<l+b-h){h+=l+b-h-d.right+zi}e.setOffset({offsetLeft:-h});if(o<d.top||a>d.bottom){m.Dom.style(e.getPopupContainer(),{left:"-9999px",top:"-9999px"})}else{const t=m.Type.isFunction(s)?s(r):n?"top":"bottom";const i=Yi.get(e)||null;let b=i===null?t:i;if(a+c.height>d.bottom&&d.top<a-c.height){b="top"}else if(a-c.height<d.top){b="bottom"}Yi.set(e,b);e.setBindElement({left:l,top:a,bottom:o});e.adjustPosition({position:b,forceBindPosition:true})}return true}function Gi(e){Yi.delete(e)}const Vi=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;const Ji=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[+.a-z-]+(?:[^+.:a-z-]|$))/i;function qi(e){if(!m.Type.isStringFilled(e)){return""}const t=e.replaceAll(Vi,"");return Ji.test(t)?t:""}let Qi=e=>e,Zi,er;var tr=babelHelpers.classPrivateFieldLooseKey("popup");var sr=babelHelpers.classPrivateFieldLooseKey("imageUrl");var ir=babelHelpers.classPrivateFieldLooseKey("targetContainer");var rr=babelHelpers.classPrivateFieldLooseKey("refs");var ar=babelHelpers.classPrivateFieldLooseKey("handleSaveBtnClick");var lr=babelHelpers.classPrivateFieldLooseKey("handleTextBoxKeyDown");var or=babelHelpers.classPrivateFieldLooseKey("handleCancelBtnClick");class nr extends d.EventEmitter{constructor(e){super();Object.defineProperty(this,or,{value:br});Object.defineProperty(this,lr,{value:cr});Object.defineProperty(this,ar,{value:dr});Object.defineProperty(this,tr,{writable:true,value:null});Object.defineProperty(this,sr,{writable:true,value:""});Object.defineProperty(this,ir,{writable:true,value:null});Object.defineProperty(this,rr,{writable:true,value:new h.MemoryCache});this.setEventNamespace("BX.UI.TextEditor.ImageDialog");const t=m.Type.isPlainObject(e)?e:{};this.setTargetContainer(t.targetContainer);this.subscribeFromOptions(t.events)}show(e={}){var t;const s=(t=e.target)!=null?t:undefined;const i=m.Type.isPlainObject(e.targetOptions)?e.targetOptions:{};if(!m.Type.isUndefined(s)){this.getPopup().setBindElement(s)}this.getPopup().adjustPosition({...i,forceBindPosition:true});this.getPopup().show()}hide(){this.getPopup().close()}isShown(){return babelHelpers.classPrivateFieldLooseBase(this,tr)[tr]!==null&&babelHelpers.classPrivateFieldLooseBase(this,tr)[tr].isShown()}destroy(){this.getPopup().destroy()}setImageUrl(e){if(m.Type.isString(e)){babelHelpers.classPrivateFieldLooseBase(this,sr)[sr]=qi(e)}}getImageUrl(){return babelHelpers.classPrivateFieldLooseBase(this,sr)[sr]}setTargetContainer(e){if(m.Type.isElementNode(e)){babelHelpers.classPrivateFieldLooseBase(this,ir)[ir]=e}}getTargetContainer(){return babelHelpers.classPrivateFieldLooseBase(this,ir)[ir]}getPopup(){if(babelHelpers.classPrivateFieldLooseBase(this,tr)[tr]===null){babelHelpers.classPrivateFieldLooseBase(this,tr)[tr]=new b.Popup({autoHide:true,cacheable:false,padding:0,closeByEsc:true,targetContainer:this.getTargetContainer(),content:this.getContainer(),events:{onClose:()=>{this.emit("onClose")},onDestroy:()=>{this.emit("onDestroy")},onShow:()=>{this.emit("onShow")},onAfterShow:()=>{this.emit("onAfterShow")}}})}return babelHelpers.classPrivateFieldLooseBase(this,tr)[tr]}getContainer(){return babelHelpers.classPrivateFieldLooseBase(this,rr)[rr].remember("container",(()=>m.Tag.render(Zi||(Zi=Qi`
				<div class="ui-text-editor-image-dialog">
					<div class="ui-text-editor-image-dialog-form">
						<div class="ui-ctl ui-ctl-textbox ui-ctl-s ui-ctl-inline ui-ctl-w100 ui-text-editor-image-dialog-textbox">
							<div class="ui-ctl-tag">${0}</div>
							${0}
						</div>
						<button type="button" 
							class="ui-text-editor-image-dialog-button" 
							onclick="${0}"
						>
							<span class="ui-icon-set --check"></span>
						</button>
						<button 
							type="button" 
							class="ui-text-editor-image-dialog-button"
							onclick="${0}"
						>
							<span class="ui-icon-set --cross-60"></span>
						</button>
					</div>
				</div>
			`),m.Loc.getMessage("TEXT_EDITOR_IMAGE_URL"),this.getUrlTextBox(),babelHelpers.classPrivateFieldLooseBase(this,ar)[ar].bind(this),babelHelpers.classPrivateFieldLooseBase(this,or)[or].bind(this))))}getUrlTextBox(){return babelHelpers.classPrivateFieldLooseBase(this,rr)[rr].remember("url-textbox",(()=>m.Tag.render(er||(er=Qi`
				<input 
					type="text"
					class="ui-ctl-element"
					placeholder="https://example.com/image.jpeg"
					value="${0}"
					onkeydown="${0}"
				>
			`),this.getImageUrl(),babelHelpers.classPrivateFieldLooseBase(this,lr)[lr].bind(this))))}}function dr(){const e=this.getUrlTextBox().value.trim();if(e.length>0){this.setImageUrl(e);this.emit("onSave")}else{this.getUrlTextBox().focus()}}function cr(e){if(e.key==="Enter"){e.preventDefault();babelHelpers.classPrivateFieldLooseBase(this,ar)[ar]()}}function br(){this.emit("onCancel")}const hr=f.createCommand("INSERT_IMAGE_COMMAND");const ur=f.createCommand("INSERT_IMAGE_DIALOG_COMMAND");var pr=babelHelpers.classPrivateFieldLooseKey("imageDialog");var gr=babelHelpers.classPrivateFieldLooseKey("onEditorScroll");var vr=babelHelpers.classPrivateFieldLooseKey("lastSelection");var fr=babelHelpers.classPrivateFieldLooseKey("registerCommands");var Pr=babelHelpers.classPrivateFieldLooseKey("restoreSelection");var mr=babelHelpers.classPrivateFieldLooseKey("handleDialogDestroy");var Lr=babelHelpers.classPrivateFieldLooseKey("handleEditorScroll");var Fr=babelHelpers.classPrivateFieldLooseKey("registerComponents");class yr extends Z{constructor(e){super(e);Object.defineProperty(this,Fr,{value:Or});Object.defineProperty(this,Lr,{value:Tr});Object.defineProperty(this,mr,{value:Cr});Object.defineProperty(this,Pr,{value:Br});Object.defineProperty(this,fr,{value:Hr});Object.defineProperty(this,pr,{writable:true,value:null});Object.defineProperty(this,gr,{writable:true,value:babelHelpers.classPrivateFieldLooseBase(this,Lr)[Lr].bind(this)});Object.defineProperty(this,vr,{writable:true,value:null});this.cleanUpRegister(babelHelpers.classPrivateFieldLooseBase(this,fr)[fr](),ei(this.getEditor(),Ai,(e=>{this.getEditor().dispatchCommand(hr,e)})));babelHelpers.classPrivateFieldLooseBase(this,Fr)[Fr]()}static getName(){return"Image"}static getNodes(e){return[Ai]}importBBCode(){return{img:()=>({conversion:e=>{const t=e.getContent().trim();const s=Number(e.getAttribute("width"));const i=Number(e.getAttribute("height"));if(Pi(t)){return{node:$i({src:t,width:s,height:i})}}return{node:f.$createTextNode(e.toString())}},priority:0})}}exportBBCode(){return{image:e=>{const t={};const s=e.getWidth();const i=e.getHeight();if(m.Type.isNumber(s)&&m.Type.isNumber(i)){t.width=s;t.height=i}const r=this.getEditor().getBBCodeScheme();return{node:r.createElement({name:"img",inline:true,attributes:t}),after:t=>{t.setChildren([r.createText(e.getSrc())])}}}}}validateScheme(){return{nodes:[{nodeClass:Ai}],bbcodeMap:{image:"img"}}}destroy(){super.destroy();if(babelHelpers.classPrivateFieldLooseBase(this,pr)[pr]!==null){babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].destroy()}}}function Hr(){return P.mergeRegister(this.getEditor().registerCommand(hr,(e=>{if(!Pi(e==null?void 0:e.src)){return false}const t=$i(e);f.$insertNodes([t]);if(f.$isRootOrShadowRoot(t.getParentOrThrow())){P.$wrapNodeInElement(t,f.$createParagraphNode).selectEnd()}return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(ur,(()=>{const e=f.$getSelection();if(!f.$isRangeSelection(e)){return false}babelHelpers.classPrivateFieldLooseBase(this,vr)[vr]=e.clone();if(babelHelpers.classPrivateFieldLooseBase(this,pr)[pr]!==null){babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].destroy()}this.getEditor().dispatchCommand(L);babelHelpers.classPrivateFieldLooseBase(this,pr)[pr]=new nr({targetContainer:document.body,events:{onSave:()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].getImageUrl();if(!m.Type.isStringFilled(e)){babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].hide();return}this.getEditor().dispatchCommand(hr,{src:e});babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].hide()},onCancel:()=>{babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].hide()},onClose:()=>{babelHelpers.classPrivateFieldLooseBase(this,mr)[mr]()},onDestroy:()=>{babelHelpers.classPrivateFieldLooseBase(this,mr)[mr]()},onShow:()=>{if(Xi(babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].getPopup(),this.getEditor())){m.Event.bind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,gr)[gr]);this.getEditor().highlightSelection()}},onAfterShow:()=>{babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].getUrlTextBox().focus()}}});babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].show();return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(L,(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,pr)[pr]!==null){babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].destroy()}return false}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(F,(()=>babelHelpers.classPrivateFieldLooseBase(this,pr)[pr]!==null&&babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].isShown()),f.COMMAND_PRIORITY_LOW))}function Br(){const e=f.$getSelection();if(!f.$isRangeSelection(e)&&babelHelpers.classPrivateFieldLooseBase(this,vr)[vr]!==null){f.$setSelection(babelHelpers.classPrivateFieldLooseBase(this,vr)[vr]);babelHelpers.classPrivateFieldLooseBase(this,vr)[vr]=null;return true}return false}function Cr(){babelHelpers.classPrivateFieldLooseBase(this,pr)[pr]=null;m.Event.unbind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,gr)[gr]);this.getEditor().resetHighlightSelection();this.getEditor().update((()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,Pr)[Pr]()){this.getEditor().focus()}}))}function Tr(){this.getEditor().update((()=>{Xi(babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].getPopup(),this.getEditor())}))}function Or(){this.getEditor().getComponentRegistry().register("image",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --incert-image"></span>');e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_IMAGE"));e.disableInsideUnformatted();e.subscribe("onClick",(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,pr)[pr]!==null&&babelHelpers.classPrivateFieldLooseBase(this,pr)[pr].isShown()){return}this.getEditor().focus((()=>{this.getEditor().dispatchCommand(ur)}))}));return e}))}var Er=Object.freeze({ImageNode:Ai,$createImageNode:$i,$isImageNode:Ki,INSERT_IMAGE_COMMAND:hr,INSERT_IMAGE_DIALOG_COMMAND:ur,ImagePlugin:yr});class Nr extends f.ElementNode{constructor(e,t,s){super(s);this.__entityId=e;this.__id=t}static getType(){return"mention"}static clone(e){return new Nr(e.__entityId,e.__id,e.__key)}getId(){const e=this.getLatest();return e.__id}getEntityId(){const e=this.getLatest();return e.__entityId}static importJSON(e){const t=Mr(e.entityId,e.id);t.setFormat(e.format);t.setDirection(e.direction);return t}static importDOM(){return{span:e=>{if(!e.hasAttribute("data-mention-id")){return null}return{conversion:_r,priority:1}}}}exportDOM(){const e=document.createElement("span");e.setAttribute("data-mention-entity-id",this.__entityId);e.setAttribute("data-mention-id",this.__id.toString());return{element:e}}exportJSON(){return{...super.exportJSON(),entityId:this.__entityId,id:this.__id,type:"mention",version:1}}createDOM(e,t){var s;const i=document.createElement("span");if(m.Type.isStringFilled(e==null?void 0:(s=e.theme)==null?void 0:s.mention)){m.Dom.addClass(i,e.theme.mention)}return i}updateDOM(e,t,s){return false}canInsertTextBefore(){return false}canInsertTextAfter(){return false}canBeEmpty(){return false}isInline(){return true}insertNewAfter(e,t){const s=f.$createParagraphNode();const i=this.getDirection();s.setDirection(i);this.insertAfter(s,t);return s}extractWithChild(e,t,s){if(!f.$isRangeSelection(t)){return false}const i=t.anchor;const r=t.focus;const a=i.getNode();const l=r.getNode();const o=t.isBackward();const n=o?i.offset-r.offset:r.offset-i.offset;return this.isParentOf(a)&&this.isParentOf(l)&&this.getTextContent().length===n}}function _r(e){const t=e.textContent;if(t!==null){const{mentionEntityId:t,mentionId:s}=e.dataset;const i=Mr(t,s);return{node:i}}return null}function Mr(e,t){const s=new Nr(e,t);return f.$applyNodeReplacement(s)}function Sr(e){return e instanceof Nr}const Dr="\\.,\\+\\*\\?\\$\\@\\|#{}\\(\\)\\^\\-\\[\\]\\\\/!%'\"~=<>_:;";const Rr=["@","+"].join("");const Ir=`[^${Rr}${Dr}\\s]`;const xr="(?:"+"\\.[ |$]|"+" |"+`[${Dr}]|`+")";const wr=25;const Ar=new RegExp("(^|\\s|\\()("+`[${Rr}]`+`((?:${Ir}${xr}){0,${wr}})`+")$");const $r=f.createCommand("INSERT_MENTION_COMMAND");const Kr=f.createCommand("INSERT_MENTION_DIALOG_COMMAND");var jr=babelHelpers.classPrivateFieldLooseKey("dialog");var kr=babelHelpers.classPrivateFieldLooseKey("lastQueryMatch");var Ur=babelHelpers.classPrivateFieldLooseKey("mentionListening");var Wr=babelHelpers.classPrivateFieldLooseKey("removeKeyboardCommandsLock");var Yr=babelHelpers.classPrivateFieldLooseKey("removeUpdateListener");var zr=babelHelpers.classPrivateFieldLooseKey("onEditorScroll");var Xr=babelHelpers.classPrivateFieldLooseKey("lastPosition");var Gr=babelHelpers.classPrivateFieldLooseKey("timeoutId");var Vr=babelHelpers.classPrivateFieldLooseKey("triggerByAtSign");var Jr=babelHelpers.classPrivateFieldLooseKey("dialogOptions");var qr=babelHelpers.classPrivateFieldLooseKey("entities");var Qr=babelHelpers.classPrivateFieldLooseKey("registerCommands");var Zr=babelHelpers.classPrivateFieldLooseKey("registerComponents");var ea=babelHelpers.classPrivateFieldLooseKey("convertMentionElement");var ta=babelHelpers.classPrivateFieldLooseKey("registerKeyDownListener");var sa=babelHelpers.classPrivateFieldLooseKey("registerTextContentListener");var ia=babelHelpers.classPrivateFieldLooseKey("unregisterTextContentListener");var ra=babelHelpers.classPrivateFieldLooseKey("textContentListener");var aa=babelHelpers.classPrivateFieldLooseKey("startMentionListening");var la=babelHelpers.classPrivateFieldLooseKey("stopMentionListening");var oa=babelHelpers.classPrivateFieldLooseKey("getQueryMatch");var na=babelHelpers.classPrivateFieldLooseKey("getTextUpToAnchor");var da=babelHelpers.classPrivateFieldLooseKey("isSelectionOnEntityBoundary");var ca=babelHelpers.classPrivateFieldLooseKey("matchMention");var ba=babelHelpers.classPrivateFieldLooseKey("splitNodeContainingQuery");var ha=babelHelpers.classPrivateFieldLooseKey("getFullMatchOffset");var ua=babelHelpers.classPrivateFieldLooseKey("openDialog");var pa=babelHelpers.classPrivateFieldLooseKey("adjustDialogPosition");var ga=babelHelpers.classPrivateFieldLooseKey("handleEditorScroll");var va=babelHelpers.classPrivateFieldLooseKey("handleHideOrDestroy");var fa=babelHelpers.classPrivateFieldLooseKey("hideDialog");var Pa=babelHelpers.classPrivateFieldLooseKey("lockKeyboardCommands");var ma=babelHelpers.classPrivateFieldLooseKey("unlockKeyboardCommands");class La extends Z{constructor(e){super(e);Object.defineProperty(this,ma,{value:ka});Object.defineProperty(this,Pa,{value:ja});Object.defineProperty(this,fa,{value:Ka});Object.defineProperty(this,va,{value:$a});Object.defineProperty(this,ga,{value:Aa});Object.defineProperty(this,pa,{value:wa});Object.defineProperty(this,ua,{value:xa});Object.defineProperty(this,ha,{value:Ia});Object.defineProperty(this,ba,{value:Ra});Object.defineProperty(this,ca,{value:Da});Object.defineProperty(this,da,{value:Sa});Object.defineProperty(this,na,{value:Ma});Object.defineProperty(this,oa,{value:_a});Object.defineProperty(this,la,{value:Na});Object.defineProperty(this,aa,{value:Ea});Object.defineProperty(this,ra,{value:Oa});Object.defineProperty(this,ia,{value:Ta});Object.defineProperty(this,sa,{value:Ca});Object.defineProperty(this,ta,{value:Ba});Object.defineProperty(this,ea,{value:Ha});Object.defineProperty(this,Zr,{value:ya});Object.defineProperty(this,Qr,{value:Fa});Object.defineProperty(this,jr,{writable:true,value:null});Object.defineProperty(this,kr,{writable:true,value:null});Object.defineProperty(this,Ur,{writable:true,value:false});Object.defineProperty(this,Wr,{writable:true,value:null});Object.defineProperty(this,Yr,{writable:true,value:null});Object.defineProperty(this,zr,{writable:true,value:babelHelpers.classPrivateFieldLooseBase(this,ga)[ga].bind(this)});Object.defineProperty(this,Xr,{writable:true,value:null});Object.defineProperty(this,Gr,{writable:true,value:null});Object.defineProperty(this,Vr,{writable:true,value:false});Object.defineProperty(this,Jr,{writable:true,value:null});Object.defineProperty(this,qr,{writable:true,value:new Set});const t=e.getOption("mention.entities",[]);babelHelpers.classPrivateFieldLooseBase(this,qr)[qr]=m.Type.isArrayFilled(t)?new Set(t):new Set;const s=e.getOption("mention.dialogOptions");if(m.Type.isPlainObject(s)){babelHelpers.classPrivateFieldLooseBase(this,Jr)[Jr]=s;if(m.Type.isArrayFilled(babelHelpers.classPrivateFieldLooseBase(this,Jr)[Jr].entities)){for(const e of babelHelpers.classPrivateFieldLooseBase(this,Jr)[Jr].entities){if(m.Type.isPlainObject(e)&&m.Type.isStringFilled(e.id)){babelHelpers.classPrivateFieldLooseBase(this,qr)[qr].add(e.id)}}}babelHelpers.classPrivateFieldLooseBase(this,ta)[ta]()}if(babelHelpers.classPrivateFieldLooseBase(this,qr)[qr].size>0){babelHelpers.classPrivateFieldLooseBase(this,Qr)[Qr]();babelHelpers.classPrivateFieldLooseBase(this,Zr)[Zr]()}}static getName(){return"Mention"}static getNodes(e){return[Nr]}importBBCode(){if(babelHelpers.classPrivateFieldLooseBase(this,qr)[qr].size>0){const e={};for(const t of babelHelpers.classPrivateFieldLooseBase(this,qr)[qr]){e[t]=()=>({conversion:babelHelpers.classPrivateFieldLooseBase(this,ea)[ea],priority:0})}return e}return null}exportBBCode(){return{mention:e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createElement({name:e.getEntityId(),value:e.getId(),inline:true})}}}}validateScheme(){return{nodes:[{nodeClass:Nr}],bbcodeMap:{mention:"#mention"}}}shouldTriggerByAtSign(){return babelHelpers.classPrivateFieldLooseBase(this,Vr)[Vr]}isDialogVisible(){return babelHelpers.classPrivateFieldLooseBase(this,jr)[jr]!==null&&babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].isRendered()&&babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].getPopup().isShown()}destroy(){super.destroy();if(babelHelpers.classPrivateFieldLooseBase(this,Gr)[Gr]!==null){clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,Gr)[Gr]);babelHelpers.classPrivateFieldLooseBase(this,Gr)[Gr]=null}if(babelHelpers.classPrivateFieldLooseBase(this,jr)[jr]!==null){babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].destroy()}babelHelpers.classPrivateFieldLooseBase(this,ia)[ia]();babelHelpers.classPrivateFieldLooseBase(this,ma)[ma]()}}function Fa(){this.cleanUpRegister(this.getEditor().registerCommand($r,(e=>{if(!m.Type.isPlainObject(e)||!m.Type.isStringFilled(e.entityId)||!m.Type.isStringFilled(e.text)||!m.Type.isStringFilled(e.id)&&!m.Type.isNumber(e.id)){return false}if(!babelHelpers.classPrivateFieldLooseBase(this,qr)[qr].has(e.entityId)){console.error(`TextEditor: MentionPlugin: entity id "${e.entityId}" was not found.`);return false}const t=Mr(e.entityId,e.id);t.append(f.$createTextNode(e.text));const s=[];if(m.Type.isStringFilled(e.before)){s.push(f.$createTextNode(e.before))}s.push(t);if(m.Type.isStringFilled(e.after)){s.push(f.$createTextNode(e.after))}f.$insertNodes(s);if(f.$isRootOrShadowRoot(t.getParentOrThrow())){P.$wrapNodeInElement(t,f.$createParagraphNode).selectEnd()}return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(Kr,(e=>{const t=f.$getSelection();if(!f.$isRangeSelection(t)){return false}this.getEditor().update((()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,na)[na](t);let s=e!==null&&!/(\s|\()$/.test(e);if(s){const e=t.anchor;const i=e.getNode();if(i.getIndexWithinParent()===0&&e.offset===0){s=false}}t.insertText(s?" @":"@")}),{onUpdate:()=>{this.getEditor().update((()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,oa)[oa](f.$getSelection());if(e!==null&&!babelHelpers.classPrivateFieldLooseBase(this,da)[da](e.leadOffset)){babelHelpers.classPrivateFieldLooseBase(this,ua)[ua](e)}}))}});return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(L,(e=>{if(!e||e.sender!=="mention"){babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]()}return false}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(F,(()=>this.isDialogVisible()),f.COMMAND_PRIORITY_LOW))}function ya(){this.getEditor().getComponentRegistry().register("mention",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --mention"></span>');e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_MENTION"));e.disableInsideUnformatted();e.subscribe("onClick",(()=>{if(this.isDialogVisible()){return}this.getEditor().focus((()=>{this.getEditor().dispatchCommand(Kr)}))}));return e}))}function Ha(e){return{node:Mr(e.getName(),e.getValue())}}function Ba(){babelHelpers.classPrivateFieldLooseBase(this,Vr)[Vr]=true;const e=e=>{if(babelHelpers.classPrivateFieldLooseBase(this,Ur)[Ur]){if(e.key==="Escape"||e.key==="Enter"){babelHelpers.classPrivateFieldLooseBase(this,la)[la]()}}else if(!babelHelpers.classPrivateFieldLooseBase(this,Ur)[Ur]&&(e.key==="+"||e.key==="@")){babelHelpers.classPrivateFieldLooseBase(this,Gr)[Gr]=setTimeout((()=>{this.getEditor().update((()=>{const e=f.$getSelection();const t=babelHelpers.classPrivateFieldLooseBase(this,oa)[oa](e);if(t!==null&&!babelHelpers.classPrivateFieldLooseBase(this,da)[da](t.leadOffset)){babelHelpers.classPrivateFieldLooseBase(this,ua)[ua](t)}}))}),300)}return false};this.cleanUpRegister(this.getEditor().registerCommand(f.KEY_DOWN_COMMAND,e,f.COMMAND_PRIORITY_LOW))}function Ca(){babelHelpers.classPrivateFieldLooseBase(this,ia)[ia]();babelHelpers.classPrivateFieldLooseBase(this,Yr)[Yr]=this.getEditor().registerTextContentListener(babelHelpers.classPrivateFieldLooseBase(this,ra)[ra].bind(this))}function Ta(){if(babelHelpers.classPrivateFieldLooseBase(this,Yr)[Yr]!==null){babelHelpers.classPrivateFieldLooseBase(this,Yr)[Yr]();babelHelpers.classPrivateFieldLooseBase(this,Yr)[Yr]=null}}function Oa(){this.getEditor().getEditorState().read((()=>{const e=f.$getSelection();const t=babelHelpers.classPrivateFieldLooseBase(this,oa)[oa](e);if(t!==null&&!babelHelpers.classPrivateFieldLooseBase(this,da)[da](t.leadOffset)){babelHelpers.classPrivateFieldLooseBase(this,ua)[ua](t)}else{babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]()}}))}function Ea(){babelHelpers.classPrivateFieldLooseBase(this,Ur)[Ur]=true;babelHelpers.classPrivateFieldLooseBase(this,sa)[sa]()}function Na(){babelHelpers.classPrivateFieldLooseBase(this,Ur)[Ur]=false;babelHelpers.classPrivateFieldLooseBase(this,ia)[ia]()}function _a(e,t=0){if(!f.$isRangeSelection(e)||!e.isCollapsed()){return null}const s=e.anchor;const i=s.getNode();if(!f.$isTextNode(i)||!i.isSimpleText()){return null}const r=babelHelpers.classPrivateFieldLooseBase(this,na)[na](e);if(!m.Type.isStringFilled(r)){return null}return babelHelpers.classPrivateFieldLooseBase(this,ca)[ca](r,t)}function Ma(e){const t=e.anchor;if(t.type!=="text"){return null}const s=t.getNode();if(!s.isSimpleText()){return null}const i=t.offset;return s.getTextContent().slice(0,i)}function Sa(e){if(e!==0){return false}return this.getEditor().getEditorState().read((()=>{const e=f.$getSelection();if(f.$isRangeSelection(e)){const t=e.anchor;const s=t.getNode();const i=s.getPreviousSibling();return f.$isTextNode(i)&&i.isTextEntity()}return false}))}function Da(e,t){const s=Ar.exec(e);if(s!==null){const e=s[1];const i=s[3];if(i.length>=t){return{leadOffset:s.index+e.length,matchingString:i,replaceableString:s[2]}}}return null}function Ra(e){const t=f.$getSelection();if(!f.$isRangeSelection(t)||!t.isCollapsed()){return null}const s=t.anchor;if(s.type!=="text"){return null}const i=s.getNode();if(!i.isSimpleText()){return null}const r=s.offset;const a=i.getTextContent().slice(0,r);const l=e.replaceableString.length;const o=babelHelpers.classPrivateFieldLooseBase(this,ha)[ha](a,e.matchingString,l);const n=r-o;if(n<0){return null}let d=null;if(n===0){[d]=i.splitText(r)}else{[,d]=i.splitText(n,r)}return d}function Ia(e,t,s){let i=s;for(let s=i;s<=t.length;s++){if(e.slice(-s)===t.slice(0,Math.max(0,s))){i=s}}return i}function xa(e){if(this.isDestroyed()){return}babelHelpers.classPrivateFieldLooseBase(this,kr)[kr]=e;if(babelHelpers.classPrivateFieldLooseBase(this,jr)[jr]===null){const t=m.Type.isPlainObject(babelHelpers.classPrivateFieldLooseBase(this,Jr)[Jr])?{...babelHelpers.classPrivateFieldLooseBase(this,Jr)[Jr]}:{};const s=t.events;m.Runtime.loadExtension("ui.entity-selector").then((i=>{if(this.isDestroyed()){return}const{Dialog:r}=i;const a={multiple:false,enableSearch:false,clearSearchOnSelect:true,hideOnSelect:true,hideByEsc:true,autoHide:true,height:300,width:400,offsetAnimation:false,compactView:true,...t,events:{onShow:()=>{babelHelpers.classPrivateFieldLooseBase(this,Pa)[Pa]();babelHelpers.classPrivateFieldLooseBase(this,aa)[aa]();m.Event.bind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,zr)[zr])},onHide:()=>{babelHelpers.classPrivateFieldLooseBase(this,va)[va]()},onDestroy:()=>{babelHelpers.classPrivateFieldLooseBase(this,va)[va]()},"Item:onBeforeSelect":e=>{const t=e.getData().item;e.preventDefault();this.getEditor().update((()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,ba)[ba](babelHelpers.classPrivateFieldLooseBase(this,kr)[kr]);const s=Mr(t.getEntityId(),t.getId());s.append(f.$createTextNode(t.getTitle()));if(e){e.replace(s);s.select()}babelHelpers.classPrivateFieldLooseBase(this,fa)[fa]()}))}}};babelHelpers.classPrivateFieldLooseBase(this,jr)[jr]=new r(a);this.getEditor().dispatchCommand(L,{sender:"mention"});babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].subscribeFromOptions(s);babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].show();babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].search(e.matchingString);babelHelpers.classPrivateFieldLooseBase(this,pa)[pa]()})).catch((e=>{console.error('TextEditor: MentionPlugin: cannot load "ui.entity-selector"',e)}))}else{this.getEditor().dispatchCommand(L,{sender:"mention"});babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].show();babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].search(e.matchingString);babelHelpers.classPrivateFieldLooseBase(this,pa)[pa]()}}function wa(){this.getEditor().update((()=>{const e=ji(this.getEditor(),f.$getSelection(),document.body);if(e===null){return}const{top:t,left:s,bottom:i}=e;const r=m.Dom.getPosition(this.getEditor().getScrollerContainer());const a=400;let l=10;if(s-l<r.left){const e=r.left-(s-l);l-=e+16}else if(r.right<s+a-l){l+=s+a-l-r.right+16}if(i<r.top||t>r.bottom){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].getPopup().getPopupContainer(),"ui-text-editor-mention-popup__hidden")}else{m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].getPopup().getPopupContainer(),"ui-text-editor-mention-popup__hidden");babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].show();if(babelHelpers.classPrivateFieldLooseBase(this,Xr)[Xr]===null||babelHelpers.classPrivateFieldLooseBase(this,Xr)[Xr].top!==i){babelHelpers.classPrivateFieldLooseBase(this,Xr)[Xr]={left:s-l,top:i}}babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].getPopup().setBindElement(babelHelpers.classPrivateFieldLooseBase(this,Xr)[Xr]);babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].getPopup().adjustPosition({forceBindPosition:true,forceTop:true})}}))}function Aa(){babelHelpers.classPrivateFieldLooseBase(this,pa)[pa]()}function $a(){babelHelpers.classPrivateFieldLooseBase(this,Xr)[Xr]=null;babelHelpers.classPrivateFieldLooseBase(this,ma)[ma]();babelHelpers.classPrivateFieldLooseBase(this,la)[la]();m.Event.unbind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,zr)[zr])}function Ka(){if(babelHelpers.classPrivateFieldLooseBase(this,jr)[jr]!==null){babelHelpers.classPrivateFieldLooseBase(this,jr)[jr].hide()}}function ja(){if(babelHelpers.classPrivateFieldLooseBase(this,Wr)[Wr]===null){babelHelpers.classPrivateFieldLooseBase(this,Wr)[Wr]=P.mergeRegister(this.getEditor().registerCommand(f.KEY_ARROW_DOWN_COMMAND,(()=>true),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_ARROW_UP_COMMAND,(()=>true),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_ESCAPE_COMMAND,(()=>true),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_TAB_COMMAND,(()=>true),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_ENTER_COMMAND,(()=>true),f.COMMAND_PRIORITY_LOW))}}function ka(){if(babelHelpers.classPrivateFieldLooseBase(this,Wr)[Wr]!==null){babelHelpers.classPrivateFieldLooseBase(this,Wr)[Wr]();babelHelpers.classPrivateFieldLooseBase(this,Wr)[Wr]=null}}var Ua=Object.freeze({INSERT_MENTION_COMMAND:$r,INSERT_MENTION_DIALOG_COMMAND:Kr,MentionPlugin:La,MentionNode:Nr,$createMentionNode:Mr,$isMentionNode:Sr});class Wa extends f.DecoratorNode{static getType(){return"smiley"}static clone(e){return new Wa(e.__src,e.__typing,e.__width,e.__height,e.__key)}constructor(e,t,s,i,r){super(r);this.__width=null;this.__height=null;this.__src=e;this.__typing=t;if(m.Type.isNumber(s)){this.__width=s}if(m.Type.isNumber(i)){this.__height=i}}getSrc(){return this.__src}getTyping(){return this.__typing}getWidth(){return this.__width}getHeight(){return this.__height}createDOM(e){var t;const s=document.createElement("img");s.src=encodeURI(this.__src);if(this.getWidth()>0&&this.getHeight()>0){m.Dom.style(s,{width:`${this.getWidth()}px`,height:`${this.getHeight()}px`})}if(m.Type.isStringFilled(e==null?void 0:(t=e.theme)==null?void 0:t.smiley)){m.Dom.addClass(s,e.theme.smiley)}m.Dom.attr(s,{draggable:false});return s}updateDOM(e,t,s){return false}static importJSON(e){const{src:t,typing:s,width:i,height:r}=e;return za(t,s,i,r)}exportDOM(){const e=document.createElement("span");e.textContent=this.getTyping();return{element:e}}exportJSON(){return{src:this.getSrc(),typing:this.getTyping(),width:this.getWidth(),height:this.getHeight(),type:"smiley",version:1}}decorate(e,t){return{}}getTextContent(){return this.getTyping()}isInline(){return true}isKeyboardSelectable(){return false}isIsolated(){return false}}function Ya(e){return e instanceof Wa}function za(e,t,s,i){const r=new Wa(e,t,s,i);return f.$applyNodeReplacement(r)}var Xa=babelHelpers.classPrivateFieldLooseKey("name");var Ga=babelHelpers.classPrivateFieldLooseKey("image");var Va=babelHelpers.classPrivateFieldLooseKey("typing");var Ja=babelHelpers.classPrivateFieldLooseKey("width");var qa=babelHelpers.classPrivateFieldLooseKey("height");class Qa{constructor(e){Object.defineProperty(this,Xa,{writable:true,value:void 0});Object.defineProperty(this,Ga,{writable:true,value:void 0});Object.defineProperty(this,Va,{writable:true,value:void 0});Object.defineProperty(this,Ja,{writable:true,value:void 0});Object.defineProperty(this,qa,{writable:true,value:void 0});const t=m.Type.isPlainObject(e)?e:{};this.setName(t.name);this.setImage(t.image);this.setTyping(t.typing);this.setWidth(t.width);this.setHeight(t.height)}getName(){return babelHelpers.classPrivateFieldLooseBase(this,Xa)[Xa]}setName(e){babelHelpers.classPrivateFieldLooseBase(this,Xa)[Xa]=e}getImage(){return babelHelpers.classPrivateFieldLooseBase(this,Ga)[Ga]}setImage(e){babelHelpers.classPrivateFieldLooseBase(this,Ga)[Ga]=e}getTyping(){return babelHelpers.classPrivateFieldLooseBase(this,Va)[Va]}setTyping(e){babelHelpers.classPrivateFieldLooseBase(this,Va)[Va]=e}getWidth(){return babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]}setWidth(e){babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]=e}getHeight(){return babelHelpers.classPrivateFieldLooseBase(this,qa)[qa]}setHeight(e){babelHelpers.classPrivateFieldLooseBase(this,qa)[qa]=e}}var Za=babelHelpers.classPrivateFieldLooseKey("popup");var el=babelHelpers.classPrivateFieldLooseKey("targetNode");class tl extends d.EventEmitter{constructor(e){super();Object.defineProperty(this,Za,{writable:true,value:null});Object.defineProperty(this,el,{writable:true,value:null});this.setEventNamespace("BX.UI.TextEditor.SmileyDialog");const t=m.Type.isPlainObject(e)?e:{};this.setTargetNode(t.targetNode);this.subscribeFromOptions(t.events)}show(){this.getPopup().adjustPosition({forceBindPosition:true});this.getPopup().show()}hide(){this.getPopup().close()}isShown(){return babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]!==null&&babelHelpers.classPrivateFieldLooseBase(this,Za)[Za].isShown()}destroy(){this.getPopup().destroy()}setTargetNode(e){if(m.Type.isElementNode(e)){babelHelpers.classPrivateFieldLooseBase(this,el)[el]=e}}getTargetNode(){return babelHelpers.classPrivateFieldLooseBase(this,el)[el]}getPopup(){if(babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]===null){const e=360;const t=this.getTargetNode();const s=t.getBoundingClientRect();const i=s.width;babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]=new b.Popup({autoHide:true,padding:0,closeByEsc:true,width:e,height:250,bindElement:this.getTargetNode(),events:{onClose:()=>{this.emit("onClose")},onDestroy:()=>{this.emit("onDestroy")},onFirstShow:()=>{const e=this;m.Runtime.loadExtension("ui.vue3","ui.vue3.components.smiles").then((t=>{const{BitrixVue:s,Smiles:i}=t;const r=s.createApp({methods:{handleSelect(t){e.emit("onSelect",{smiley:t.trim()})}},components:{Smiles:i},template:'<Smiles @selectSmile="handleSelect($event.text)"/>'});r.mount(babelHelpers.classPrivateFieldLooseBase(this,Za)[Za].getContentContainer())})).catch((()=>{babelHelpers.classPrivateFieldLooseBase(this,Za)[Za].close()}))},onShow:t=>{const s=t.getTarget();const r=i/2-e/2;const a=b.Popup.getOption("angleLeftOffset")-b.Popup.getOption("angleMinTop");s.setAngle({offset:e/2-a});s.setOffset({offsetLeft:r+b.Popup.getOption("angleLeftOffset")})}}})}return babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]}}const sl={TAB:9,SPACE:32,NBSP:160,NEW_LINE:10,RETURN:13,LINE_FEED:12,EXCLAMATION:33,DOUBLE_QUOTE:34,HASH:35,SINGLE_QUOTE:39,ASTERISK:42,COMMA:44,DOT:46,COLON:58,SEMI_COLON:59,QUESTION:63,ROUND_BRACKET_OPEN:40,ROUND_BRACKET_CLOSE:41,SQUARE_BRACKET_OPEN:91,SQUARE_BRACKET_CLOSE:93,CURLY_BRACKET_OPEN:123,PIPE:124,CURLY_BRACKET_CLOSE:125,HYPHEN:45};var il=babelHelpers.classPrivateFieldLooseKey("currentPosition");var rl=babelHelpers.classPrivateFieldLooseKey("text");var al=babelHelpers.classPrivateFieldLooseKey("textStart");var ll=babelHelpers.classPrivateFieldLooseKey("textEnd");var ol=babelHelpers.classPrivateFieldLooseKey("moveNext");class nl{constructor(e,t=0){Object.defineProperty(this,ol,{value:dl});Object.defineProperty(this,il,{writable:true,value:void 0});Object.defineProperty(this,rl,{writable:true,value:void 0});Object.defineProperty(this,al,{writable:true,value:-1});Object.defineProperty(this,ll,{writable:true,value:-1});babelHelpers.classPrivateFieldLooseBase(this,rl)[rl]=e;babelHelpers.classPrivateFieldLooseBase(this,il)[il]=t}getCurrentPosition(){return babelHelpers.classPrivateFieldLooseBase(this,il)[il]}tryChangePosition(e){const t=babelHelpers.classPrivateFieldLooseBase(this,il)[il];const s=e();if(!s){babelHelpers.classPrivateFieldLooseBase(this,il)[il]=t}return s}peek(){return babelHelpers.classPrivateFieldLooseBase(this,rl)[rl].codePointAt(babelHelpers.classPrivateFieldLooseBase(this,il)[il])}moveNext(){return this.hasNext()?babelHelpers.classPrivateFieldLooseBase(this,ol)[ol](this.peek()):NaN}peekPrevious(){return babelHelpers.classPrivateFieldLooseBase(this,rl)[rl].codePointAt(babelHelpers.classPrivateFieldLooseBase(this,il)[il]-1)}hasNext(){return babelHelpers.classPrivateFieldLooseBase(this,il)[il]<babelHelpers.classPrivateFieldLooseBase(this,rl)[rl].length}hasPendingText(){return babelHelpers.classPrivateFieldLooseBase(this,al)[al]!==babelHelpers.classPrivateFieldLooseBase(this,ll)[ll]}flushText(){if(this.hasPendingText()){babelHelpers.classPrivateFieldLooseBase(this,al)[al]=-1;babelHelpers.classPrivateFieldLooseBase(this,ll)[ll]=-1}}consume(e){const t=this.peek();const s=m.Type.isFunction(e)?e(t):t===e;if(s){this.moveNext(t)}return s}consumeWhile(e){const t=babelHelpers.classPrivateFieldLooseBase(this,il)[il];while(this.hasNext()&&this.consume(e)){}return babelHelpers.classPrivateFieldLooseBase(this,il)[il]!==t}consumePoints(e){const t=babelHelpers.classPrivateFieldLooseBase(this,il)[il];for(const s of e){const e=this.moveNext();if(s!==e){babelHelpers.classPrivateFieldLooseBase(this,il)[il]=t;return false}}return true}consumeTree(e){const t=babelHelpers.classPrivateFieldLooseBase(this,il)[il];let s=e;while(this.hasNext()){const e=this.moveNext();const t=s.get(e);if(m.Type.isUndefined(t)){break}const[i,r]=t;if(i===true){this.consumeTree(r);return true}s=r}babelHelpers.classPrivateFieldLooseBase(this,il)[il]=t;return false}consumeText(){if(babelHelpers.classPrivateFieldLooseBase(this,al)[al]===-1){babelHelpers.classPrivateFieldLooseBase(this,al)[al]=babelHelpers.classPrivateFieldLooseBase(this,il)[il];babelHelpers.classPrivateFieldLooseBase(this,ll)[ll]=babelHelpers.classPrivateFieldLooseBase(this,il)[il]}this.moveNext();babelHelpers.classPrivateFieldLooseBase(this,ll)[ll]=babelHelpers.classPrivateFieldLooseBase(this,il)[il];return true}isWordBoundary(){if(babelHelpers.classPrivateFieldLooseBase(this,il)[il]===0){return true}if(this.hasPendingText()){return ul(this.peekPrevious())}return false}}function dl(e){babelHelpers.classPrivateFieldLooseBase(this,il)[il]+=e>65535?2:1;return e}const cl=new Set([sl.DOT,sl.COMMA,sl.SEMI_COLON,sl.COLON,sl.EXCLAMATION,sl.QUESTION,sl.HASH,sl.HYPHEN,sl.ASTERISK,sl.PIPE,sl.ROUND_BRACKET_OPEN,sl.ROUND_BRACKET_CLOSE,sl.SQUARE_BRACKET_OPEN,sl.SQUARE_BRACKET_CLOSE,sl.CURLY_BRACKET_OPEN,sl.CURLY_BRACKET_CLOSE]);function bl(e){return cl.has(e)}function hl(e){return m.Type.isUndefined(e)||Number.isNaN(e)||gl(e)||pl(e)}function ul(e){return hl(e)||bl(e)}function pl(e){return e===sl.SPACE||e===sl.TAB||e===sl.NBSP}function gl(e){return e===sl.NEW_LINE||e===sl.RETURN||e===sl.LINE_FEED}var vl=babelHelpers.classPrivateFieldLooseKey("index");class fl{constructor(){Object.defineProperty(this,vl,{writable:true,value:new Map})}getTreeIndex(){return babelHelpers.classPrivateFieldLooseBase(this,vl)[vl]}addToken(e){if(!m.Type.isStringFilled(e)){return}let t=babelHelpers.classPrivateFieldLooseBase(this,vl)[vl];for(let s=0;s<e.length;s++){const i=e.codePointAt(s);if(s===e.length-1){if(t.has(i)){t.get(i)[0]=true}else{t.set(i,[true,new Map])}}else{if(!t.has(i)){t.set(i,[false,new Map])}[,t]=t.get(i)}}}}var Pl=babelHelpers.classPrivateFieldLooseKey("splitOffsets");var ml=babelHelpers.classPrivateFieldLooseKey("tokenTree");var Ll=babelHelpers.classPrivateFieldLooseKey("textParser");var Fl=babelHelpers.classPrivateFieldLooseKey("parseSmileys");var yl=babelHelpers.classPrivateFieldLooseKey("consumeSmiley");var Hl=babelHelpers.classPrivateFieldLooseKey("isWordBoundary");var Bl=babelHelpers.classPrivateFieldLooseKey("isNextWordBoundary");var Cl=babelHelpers.classPrivateFieldLooseKey("parseEmoji");class Tl{constructor(e){Object.defineProperty(this,Cl,{value:Ml});Object.defineProperty(this,Bl,{value:_l});Object.defineProperty(this,Hl,{value:Nl});Object.defineProperty(this,yl,{value:El});Object.defineProperty(this,Fl,{value:Ol});Object.defineProperty(this,Pl,{writable:true,value:[]});Object.defineProperty(this,ml,{writable:true,value:null});Object.defineProperty(this,Ll,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,ml)[ml]=new fl;e.forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,ml)[ml].addToken(e.getTyping())}))}parse(e){babelHelpers.classPrivateFieldLooseBase(this,Pl)[Pl]=[];babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll]=new nl(e);while(babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].hasNext()){let e=false;e=e||babelHelpers.classPrivateFieldLooseBase(this,Cl)[Cl]();e=e||babelHelpers.classPrivateFieldLooseBase(this,Fl)[Fl]();e=e||babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].consumeText()}return babelHelpers.classPrivateFieldLooseBase(this,Pl)[Pl]}}function Ol(){if(babelHelpers.classPrivateFieldLooseBase(this,Hl)[Hl]()){return babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].tryChangePosition((()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].getCurrentPosition();if(babelHelpers.classPrivateFieldLooseBase(this,yl)[yl]()&&babelHelpers.classPrivateFieldLooseBase(this,Bl)[Bl]()){babelHelpers.classPrivateFieldLooseBase(this,Pl)[Pl].push({start:e,end:babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].getCurrentPosition()});babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].flushText();return true}return false}))}return false}function El(){return babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].consumeTree(babelHelpers.classPrivateFieldLooseBase(this,ml)[ml].getTreeIndex())}function Nl(){if(!babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].hasPendingText()){const e=babelHelpers.classPrivateFieldLooseBase(this,Pl)[Pl].at(-1);if(e&&e.end===babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].getCurrentPosition()){return true}}return babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].isWordBoundary()}function _l(){let e=false;babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].tryChangePosition((()=>{if(babelHelpers.classPrivateFieldLooseBase(this,yl)[yl]()){e=true}return false}));if(e){return true}return ul(babelHelpers.classPrivateFieldLooseBase(this,Ll)[Ll].peek())}function Ml(){return false}const Sl=f.createCommand("INSERT_SMILEY_COMMAND");const Dl=f.createCommand("INSERT_SMILEY_DIALOG_COMMAND");var Rl=babelHelpers.classPrivateFieldLooseKey("smileys");var Il=babelHelpers.classPrivateFieldLooseKey("smileyParser");var xl=babelHelpers.classPrivateFieldLooseKey("smileyDialog");var wl=babelHelpers.classPrivateFieldLooseKey("registerListeners");var Al=babelHelpers.classPrivateFieldLooseKey("registerInsertSmileyCommand");var $l=babelHelpers.classPrivateFieldLooseKey("registerComponents");class Kl extends Z{constructor(e){super(e);Object.defineProperty(this,$l,{value:Ul});Object.defineProperty(this,Al,{value:kl});Object.defineProperty(this,wl,{value:jl});Object.defineProperty(this,Rl,{writable:true,value:new Map});Object.defineProperty(this,Il,{writable:true,value:null});Object.defineProperty(this,xl,{writable:true,value:null});const t=m.Extension.getSettings("ui.text-editor");const s=t.get("smileys",[]);for(const e of s){babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl].set(e.typing,new Qa(e))}if(babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl].size>0){babelHelpers.classPrivateFieldLooseBase(this,Il)[Il]=new Tl([...babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl].values()]);babelHelpers.classPrivateFieldLooseBase(this,wl)[wl]();babelHelpers.classPrivateFieldLooseBase(this,Al)[Al]();babelHelpers.classPrivateFieldLooseBase(this,$l)[$l]()}}static getName(){return"Smiley"}static getNodes(e){return[Wa]}importBBCode(){return null}exportBBCode(){return{smiley:e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createText(e.getTyping())}}}}validateScheme(){return{bbcodeMap:{smiley:"#text"}}}destroy(){super.destroy();if(babelHelpers.classPrivateFieldLooseBase(this,xl)[xl]!==null){babelHelpers.classPrivateFieldLooseBase(this,xl)[xl].destroy()}}}function jl(){const e=new Set;this.cleanUpRegister(this.getEditor().registerNodeTransform(f.TextNode,(t=>{if(!t.isSimpleText()||e.has(t.getKey())){return}const s=P.$findMatchingParent(t,(e=>(e.__flags&C)!==0));if(s){return}const i=babelHelpers.classPrivateFieldLooseBase(this,Il)[Il].parse(t.getTextContent());if(i.length>0){const s=i.reduce(((e,t)=>{e.push(t.start,t.end);return e}),[]);const r=t.splitText(...s);for(const t of r){const s=babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl].get(t.getTextContent())||null;if(s){const e=za(s.getImage(),s.getTyping(),s.getWidth(),s.getHeight());t.replace(e)}else{e.add(t.getKey())}}}})),this.getEditor().registerUpdateListener((()=>{e.clear()})),this.getEditor().registerMutationListener(Wa,(e=>{for(const[t,s]of e){if(s==="created"){const e=this.getEditor().getElementByKey(t);e.contentEditable=true}}})),this.getEditor().registerCommand(L,(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,xl)[xl]!==null){babelHelpers.classPrivateFieldLooseBase(this,xl)[xl].hide()}return false}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(F,(()=>babelHelpers.classPrivateFieldLooseBase(this,xl)[xl]!==null&&babelHelpers.classPrivateFieldLooseBase(this,xl)[xl].isShown()),f.COMMAND_PRIORITY_LOW))}function kl(){this.cleanUpRegister(this.getEditor().registerCommand(Sl,(e=>{const t=babelHelpers.classPrivateFieldLooseBase(this,Rl)[Rl].get(e)||null;if(!t){return false}const s=za(t.getImage(),t.getTyping(),t.getWidth(),t.getHeight());f.$insertNodes([f.$createTextNode(" "),s,f.$createTextNode(" ")]);if(f.$isRootOrShadowRoot(s.getParentOrThrow())){P.$wrapNodeInElement(s,f.$createParagraphNode).selectEnd()}return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(Dl,(e=>{if(!m.Type.isPlainObject(e)||!m.Type.isElementNode(e.targetNode)){return false}if(babelHelpers.classPrivateFieldLooseBase(this,xl)[xl]!==null){if(babelHelpers.classPrivateFieldLooseBase(this,xl)[xl].getTargetNode()===e.targetNode){babelHelpers.classPrivateFieldLooseBase(this,xl)[xl].show();return true}babelHelpers.classPrivateFieldLooseBase(this,xl)[xl].destroy()}babelHelpers.classPrivateFieldLooseBase(this,xl)[xl]=new tl({targetNode:e.targetNode,events:{onSelect:e=>{this.getEditor().dispatchCommand(Sl,e.getData().smiley)},onDestroy:()=>{babelHelpers.classPrivateFieldLooseBase(this,xl)[xl]=null}}});babelHelpers.classPrivateFieldLooseBase(this,xl)[xl].show();return true}),f.COMMAND_PRIORITY_LOW))}function Ul(){this.getEditor().getComponentRegistry().register("smileys",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --insert-emoji"></span>');e.disableInsideUnformatted();e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_SMILEYS"));e.subscribe("onClick",(()=>{this.getEditor().update((()=>{this.getEditor().dispatchCommand(Dl,{targetNode:e.getContainer()})}))}));return e}))}var Wl=Object.freeze({INSERT_SMILEY_COMMAND:Sl,INSERT_SMILEY_DIALOG_COMMAND:Dl,SmileyPlugin:Kl,SmileyNode:Wa,$isSmileyNode:Ya,$createSmileyNode:za,SmileyParser:Tl,SmileyDialog:tl});let Yl=e=>e,zl,Xl,Gl,Vl;var Jl=babelHelpers.classPrivateFieldLooseKey("refs");var ql=babelHelpers.classPrivateFieldLooseKey("figureResizer");var Ql=babelHelpers.classPrivateFieldLooseKey("trusted");var Zl=babelHelpers.classPrivateFieldLooseKey("render");var eo=babelHelpers.classPrivateFieldLooseKey("getContainer");var to=babelHelpers.classPrivateFieldLooseKey("getVideoStub");var so=babelHelpers.classPrivateFieldLooseKey("getIframeContainer");var io=babelHelpers.classPrivateFieldLooseKey("getIframe");var ro=babelHelpers.classPrivateFieldLooseKey("handleResize");var ao=babelHelpers.classPrivateFieldLooseKey("handleResizeEnd");class lo extends Mt{constructor(e){super(e);Object.defineProperty(this,ao,{value:po});Object.defineProperty(this,ro,{value:uo});Object.defineProperty(this,io,{value:ho});Object.defineProperty(this,so,{value:bo});Object.defineProperty(this,to,{value:co});Object.defineProperty(this,eo,{value:no});Object.defineProperty(this,Zl,{value:oo});Object.defineProperty(this,Jl,{writable:true,value:new h.MemoryCache});Object.defineProperty(this,ql,{writable:true,value:null});Object.defineProperty(this,Ql,{writable:true,value:false});babelHelpers.classPrivateFieldLooseBase(this,ql)[ql]=new ss({editor:this.getEditor(),freeTransform:true,events:{onResize:babelHelpers.classPrivateFieldLooseBase(this,ro)[ro].bind(this),onResizeEnd:babelHelpers.classPrivateFieldLooseBase(this,ao)[ao].bind(this)}});babelHelpers.classPrivateFieldLooseBase(this,Ql)[Ql]=m.Type.isStringFilled(this.getOption("provider"));babelHelpers.classPrivateFieldLooseBase(this,ql)[ql].setTarget(babelHelpers.classPrivateFieldLooseBase(this,eo)[eo]());this.getNodeSelection().onSelect((e=>{if(e||babelHelpers.classPrivateFieldLooseBase(this,ql)[ql].isResizing()){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,eo)[eo](),"--selected");babelHelpers.classPrivateFieldLooseBase(this,ql)[ql].show()}else{m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,eo)[eo](),"--selected");babelHelpers.classPrivateFieldLooseBase(this,ql)[ql].hide()}}));this.update(this.getOptions());babelHelpers.classPrivateFieldLooseBase(this,Zl)[Zl]()}update(e){const t=m.Type.isNumber(e.width)?e.width:"100%";const s=m.Type.isNumber(e.height)?e.height:"100%";m.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,eo)[eo](),{width:null,height:null});m.Dom.attr(babelHelpers.classPrivateFieldLooseBase(this,io)[io](),{width:t,height:s})}}function oo(){m.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,eo)[eo](),this.getTarget())}function no(){return babelHelpers.classPrivateFieldLooseBase(this,Jl)[Jl].remember("container",(()=>{const e=new m.Uri(this.getOption("src"));const t=e.getPath().match(/\.(mp4|webm|mov)$/);return m.Tag.render(zl||(zl=Yl`
				<div class="ui-text-editor-video-component">
					${0}
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Ql)[Ql]||t?babelHelpers.classPrivateFieldLooseBase(this,so)[so]():babelHelpers.classPrivateFieldLooseBase(this,to)[to](),babelHelpers.classPrivateFieldLooseBase(this,ql)[ql].getContainer())}))}function co(){return babelHelpers.classPrivateFieldLooseBase(this,Jl)[Jl].remember("video-stub",(()=>m.Tag.render(Xl||(Xl=Yl`
				<div class="ui-text-editor-video-stub"></div>
			`))))}function bo(){return babelHelpers.classPrivateFieldLooseBase(this,Jl)[Jl].remember("iframe-container",(()=>m.Tag.render(Gl||(Gl=Yl`
				<div class="ui-text-editor-video-iframe-container">
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,io)[io]())))}function ho(){return babelHelpers.classPrivateFieldLooseBase(this,Jl)[Jl].remember("iframe",(()=>{const e=m.Tag.render(Vl||(Vl=Yl`
				<iframe
					class="ui-text-editor-video-iframe"
					frameborder="0"
					src="about:blank"
					draggable="false"
				></iframe>
			`));e.src=this.getOption("src");if(!babelHelpers.classPrivateFieldLooseBase(this,Ql)[Ql]){e.sandbox=""}return e}))}function uo(e){this.update(e.getData())}function po(e){this.setSelected(true);this.getEditor().update((()=>{const t=f.$getNodeByKey(this.getNodeKey());if(Ao(t)){const{width:s,height:i}=e.getData();t.setWidthAndHeight(s,i)}}))}var go=babelHelpers.classPrivateFieldLooseKey("url");class vo{constructor(e){Object.defineProperty(this,go,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,go)[go]=e}static matchByUrl(e){return false}static getDomains(){return[]}getId(){return null}getMatcher(){return/^$/}getMatcherReplacement(){return null}getEmbeddedUrl(){const e=this.getMatcherReplacement();if(m.Type.isStringFilled(e)||m.Type.isFunction(e)){return this.getUrl().replace(this.getMatcher(),e)}return""}getUrl(){return babelHelpers.classPrivateFieldLooseBase(this,go)[go]}}const fo=/^((?:https?:)?\/\/)?((?:www|m)\.)?(youtube(-nocookie)?\.com|youtu\.be)(\/(?:[\w-]+\?v=|embed\/|shorts\/|live\/|v\/)?)(?<id>[\w-]+)(\S+)?$/;const Po="https://www.youtube-nocookie.com/embed/$<id>";class mo extends vo{static matchByUrl(e){return fo.test(e)}static getDomains(){return["youtube.com","youtu.be","youtube-nocookie.com","www.youtube-nocookie.com"]}getId(){return"youtube"}getMatcher(){return fo}getMatcherReplacement(){return Po}}const Lo=/^(?:(?:https?:)?\/\/)?(?:www.)?facebook\.com.*\/(videos?|watch)(\.php|\/|\?).+$/;class Fo extends vo{static matchByUrl(e){return Lo.test(e)}static getDomains(){return["facebook.com","www.facebook.com"]}getId(){return"facebook"}getMatcher(){return Lo}getEmbeddedUrl(){const e=encodeURIComponent(this.getUrl().replace(/\/$/,""));return`https://www.facebook.com/plugins/video.php?href=${e}`}}const yo=/^(?:(?:https?:)?\/\/)?(?:www.)?vimeo.com\/(.*\/)?(?<id>\d+)(.*)?/;const Ho="https://player.vimeo.com/video/$<id>";class Bo extends vo{static matchByUrl(e){return yo.test(e)}static getDomains(){return["vimeo.com","player.vimeo.com"]}getId(){return"vimeo"}getMatcher(){return yo}getMatcherReplacement(){return Ho}}const Co=/(?:(?:https?:)?\/\/)?(?:www.)?(instagr\.am|instagram\.com)\/p\/(?<id>[\w-]+)\/?/;const To="https://instagram.com/p/$<id>/embed/captioned";class Oo extends vo{static matchByUrl(e){return Co.test(e)}static getDomains(){return["www.instagram.com","instagram.com","instagr.am"]}getId(){return"instagram"}getMatcher(){return Co}getMatcherReplacement(){return To}}const Eo=/(?:(?:https?:)?\/\/)?(?:www.)?vk\.(com|ru)\/.*(video|clip)((?<oid>-?\d+)_(?<id>\d+))\/?/;const No="https://vk.com/video_ext.php?oid=$<oid>&id=$<id>&hd=2";class _o extends vo{static matchByUrl(e){return Eo.test(e)}static getDomains(){return["vk.com","vk.ru"]}getId(){return"vk"}getDomains(){return["vk.com"]}getMatcher(){return Eo}getMatcherReplacement(){return No}}const Mo=/(?:(?:https?:)?\/\/)?(?:www.)?rutube\.ru\/video\/(private\/)?(?<id>[\dA-Za-z]+)\/?/;const So="https://rutube.ru/play/embed/$<id>";class Do extends vo{static matchByUrl(e){return Mo.test(e)}static getDomains(){return["rutube.ru","www.rutube.ru"]}getId(){return"rutube"}getMatcher(){return Mo}getMatcherReplacement(){return So}}var Ro=babelHelpers.classPrivateFieldLooseKey("services");class Io{static createByUrl(e){for(const t of babelHelpers.classPrivateFieldLooseBase(this,Ro)[Ro]){if(t.matchByUrl(e)){return new t(e)}}return null}static createByHost(e){for(const t of babelHelpers.classPrivateFieldLooseBase(this,Ro)[Ro]){if(t.getDomains().includes(e)){return new t(e)}}return null}static getEmbeddedUrl(e){const t=this.createByUrl(e);if(t){return t.getEmbeddedUrl()}return null}}Object.defineProperty(Io,Ro,{writable:true,value:[mo,Fo,Bo,Oo,_o,Do]});class xo extends f.DecoratorNode{constructor(e,t,s,i){super(i);this.__width=560;this.__height=315;this.__provider=null;this.__src=e;if(m.Type.isNumber(t)){this.__width=Math.round(t)}if(m.Type.isNumber(s)){this.__height=Math.round(s)}const r=/^https?:/.test(e)?e:`https://${e.replace(/^\/\//,"")}`;const a=new m.Uri(r);const l=Io.createByHost(a.getHost());if(l){this.__provider=l.getId()}}static getType(){return"video"}static clone(e){return new xo(e.__src,e.__width,e.__height,e.__key)}static importJSON(e){const{width:t,height:s,src:i}=e;return wo({src:i,width:t,height:s})}exportDOM(){return{element:null}}static importDOM(){return null}exportJSON(){return{src:this.getSrc(),width:this.getWidth(),height:this.getHeight(),type:"video",version:1}}setWidthAndHeight(e,t){const s=this.getWritable();if(m.Type.isNumber(e)){s.__width=Math.round(e)}if(m.Type.isNumber(t)){s.__height=Math.round(t)}}createDOM(e){const t=document.createElement("span");const s=e.theme;const i=s.video;if(i!==undefined){t.className=i}return t}updateDOM(){return false}getSrc(){return this.__src}getWidth(){const e=this.getLatest();return e.__width}getHeight(){const e=this.getLatest();return e.__height}getProvider(){const e=this.getLatest();return e.__provider}decorate(e,t){return{componentClass:lo,options:{src:this.getSrc(),width:this.getWidth(),height:this.getHeight(),provider:this.getProvider()}}}isInline(){return true}}xo.useDecoratorComponent=true;function wo({src:e,width:t,height:s,key:i}){return f.$applyNodeReplacement(new xo(e,t,s,i))}function Ao(e){return e instanceof xo}let $o=e=>e,Ko,jo,ko;var Uo=babelHelpers.classPrivateFieldLooseKey("popup");var Wo=babelHelpers.classPrivateFieldLooseKey("videoUrl");var Yo=babelHelpers.classPrivateFieldLooseKey("targetContainer");var zo=babelHelpers.classPrivateFieldLooseKey("refs");var Xo=babelHelpers.classPrivateFieldLooseKey("handleSaveBtnClick");var Go=babelHelpers.classPrivateFieldLooseKey("handleTextBoxKeyDown");var Vo=babelHelpers.classPrivateFieldLooseKey("handleTextBoxInput");var Jo=babelHelpers.classPrivateFieldLooseKey("handleCancelBtnClick");class qo extends d.EventEmitter{constructor(e){super();Object.defineProperty(this,Jo,{value:tn});Object.defineProperty(this,Vo,{value:en});Object.defineProperty(this,Go,{value:Zo});Object.defineProperty(this,Xo,{value:Qo});Object.defineProperty(this,Uo,{writable:true,value:null});Object.defineProperty(this,Wo,{writable:true,value:""});Object.defineProperty(this,Yo,{writable:true,value:null});Object.defineProperty(this,zo,{writable:true,value:new h.MemoryCache});this.setEventNamespace("BX.UI.TextEditor.VideoDialog");const t=m.Type.isPlainObject(e)?e:{};this.setTargetContainer(t.targetContainer);this.subscribeFromOptions(t.events)}show(e={}){var t;const s=(t=e.target)!=null?t:undefined;const i=m.Type.isPlainObject(e.targetOptions)?e.targetOptions:{};if(!m.Type.isUndefined(s)){this.getPopup().setBindElement(s)}this.getPopup().adjustPosition({...i,forceBindPosition:true});this.getPopup().show()}hide(){this.getPopup().close()}isShown(){return babelHelpers.classPrivateFieldLooseBase(this,Uo)[Uo]!==null&&babelHelpers.classPrivateFieldLooseBase(this,Uo)[Uo].isShown()}destroy(){this.getPopup().destroy()}setVideoUrl(e){if(m.Type.isString(e)){babelHelpers.classPrivateFieldLooseBase(this,Wo)[Wo]=qi(e)}}getVideoUrl(){return babelHelpers.classPrivateFieldLooseBase(this,Wo)[Wo]}setTargetContainer(e){if(m.Type.isElementNode(e)){babelHelpers.classPrivateFieldLooseBase(this,Yo)[Yo]=e}}getTargetContainer(){return babelHelpers.classPrivateFieldLooseBase(this,Yo)[Yo]}getPopup(){if(babelHelpers.classPrivateFieldLooseBase(this,Uo)[Uo]===null){babelHelpers.classPrivateFieldLooseBase(this,Uo)[Uo]=new b.Popup({autoHide:true,cacheable:false,padding:0,closeByEsc:true,targetContainer:this.getTargetContainer(),content:this.getContainer(),events:{onShow:()=>{this.emit("onShow")},onClose:()=>{this.emit("onClose")},onDestroy:()=>{this.emit("onDestroy")},onAfterShow:()=>{this.getUrlTextBox().focus()}}})}return babelHelpers.classPrivateFieldLooseBase(this,Uo)[Uo]}getContainer(){return babelHelpers.classPrivateFieldLooseBase(this,zo)[zo].remember("container",(()=>m.Tag.render(Ko||(Ko=$o`
				<div class="ui-text-editor-video-dialog">
					<div class="ui-text-editor-video-dialog-form">
						<div class="ui-ctl ui-ctl-textbox ui-ctl-s ui-ctl-inline ui-ctl-w100 ui-text-editor-video-dialog-textbox">
							<div class="ui-ctl-tag">${0}</div>
							${0}
						</div>
						<button type="button" 
							class="ui-text-editor-video-dialog-button" 
							onclick="${0}"
						>
							<span class="ui-icon-set --check"></span>
						</button>
						<button 
							type="button" 
							class="ui-text-editor-video-dialog-button"
							onclick="${0}"
						>
							<span class="ui-icon-set --cross-60"></span>
						</button>
					</div>
					${0}
				</div>
			`),m.Loc.getMessage("TEXT_EDITOR_VIDEO_INSERT_TITLE"),this.getUrlTextBox(),babelHelpers.classPrivateFieldLooseBase(this,Xo)[Xo].bind(this),babelHelpers.classPrivateFieldLooseBase(this,Jo)[Jo].bind(this),this.getStatusContainer())))}getUrlTextBox(){return babelHelpers.classPrivateFieldLooseBase(this,zo)[zo].remember("url-textbox",(()=>m.Tag.render(jo||(jo=$o`
				<input 
					type="text"
					class="ui-ctl-element"
					placeholder="https://"
					value="${0}"
					onkeydown="${0}"
					oninput="${0}"
				>
			`),this.getVideoUrl(),babelHelpers.classPrivateFieldLooseBase(this,Go)[Go].bind(this),babelHelpers.classPrivateFieldLooseBase(this,Vo)[Vo].bind(this))))}getStatusContainer(){return babelHelpers.classPrivateFieldLooseBase(this,zo)[zo].remember("status",(()=>m.Tag.render(ko||(ko=$o`
				<div class="ui-text-editor-video-dialog-status">${0}</div>
			`),m.Loc.getMessage("TEXT_EDITOR_VIDEO_INSERT_HINT"))))}showError(e){m.Dom.addClass(this.getStatusContainer(),"--error");m.Dom.addClass(this.getUrlTextBox().parentNode,"ui-ctl-warning");if(m.Type.isStringFilled(e)){this.getStatusContainer().textContent=e}}clearError(){m.Dom.removeClass(this.getStatusContainer(),"--error");m.Dom.removeClass(this.getUrlTextBox().parentNode,"ui-ctl-warning");this.getStatusContainer().textContent=m.Loc.getMessage("TEXT_EDITOR_VIDEO_INSERT_HINT")}}function Qo(){const e=this.getUrlTextBox().value.trim();if(e.length>0){this.setVideoUrl(e);this.emit("onSave")}else{this.getUrlTextBox().focus()}}function Zo(e){if(e.key==="Enter"){e.preventDefault();babelHelpers.classPrivateFieldLooseBase(this,Xo)[Xo]()}}function en(e){this.emit("onInput")}function tn(){this.emit("onCancel")}function sn(e){return/^(http:|https:|\/)/i.test(e)}const rn=f.createCommand("INSERT_VIDEO_COMMAND");const an=f.createCommand("INSERT_VIDEO_DIALOG_COMMAND");var ln=babelHelpers.classPrivateFieldLooseKey("videoDialog");var on=babelHelpers.classPrivateFieldLooseKey("onEditorScroll");var nn=babelHelpers.classPrivateFieldLooseKey("lastSelection");var dn=babelHelpers.classPrivateFieldLooseKey("registerCommands");var cn=babelHelpers.classPrivateFieldLooseKey("restoreSelection");var bn=babelHelpers.classPrivateFieldLooseKey("handleDialogDestroy");var hn=babelHelpers.classPrivateFieldLooseKey("handleEditorScroll");var un=babelHelpers.classPrivateFieldLooseKey("registerComponents");class pn extends Z{constructor(e){super(e);Object.defineProperty(this,un,{value:mn});Object.defineProperty(this,hn,{value:Pn});Object.defineProperty(this,bn,{value:fn});Object.defineProperty(this,cn,{value:vn});Object.defineProperty(this,dn,{value:gn});Object.defineProperty(this,ln,{writable:true,value:null});Object.defineProperty(this,on,{writable:true,value:babelHelpers.classPrivateFieldLooseBase(this,hn)[hn].bind(this)});Object.defineProperty(this,nn,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,dn)[dn]();babelHelpers.classPrivateFieldLooseBase(this,un)[un]()}static getName(){return"Video"}static getNodes(e){return[xo]}importBBCode(){return{video:()=>({conversion:e=>{const t=e.getContent().trim();const s=Number(e.getAttribute("width"));const i=Number(e.getAttribute("height"));if(sn(t)){return{node:wo({src:qi(t),width:s,height:i})}}return{node:f.$createTextNode(e.toString())}},priority:0})}}exportBBCode(){return{video:e=>{const t={};const s=e.getWidth();const i=e.getHeight();if(m.Type.isNumber(s)&&m.Type.isNumber(i)){t.width=s;t.height=i}const r=e.getProvider();if(m.Type.isStringFilled(r)){t.type=r}const a=this.getEditor().getBBCodeScheme();return{node:a.createElement({name:"video",inline:false,attributes:t}),after:t=>{t.setChildren([a.createText(e.getSrc())])}}}}}validateScheme(){return{nodes:[{nodeClass:xo}],bbcodeMap:{video:"video"}}}destroy(){super.destroy();if(babelHelpers.classPrivateFieldLooseBase(this,ln)[ln]!==null){babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].destroy()}}}function gn(){this.cleanUpRegister(this.getEditor().registerCommand(rn,(e=>{if(m.Type.isPlainObject(e)&&sn(e.src)){const t=wo({src:Io.getEmbeddedUrl(e.src)||e.src,width:e.width,height:e.height});P.$insertNodeToNearestRoot(t);return true}return false}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(an,(()=>{const e=f.$getSelection();if(!f.$isRangeSelection(e)){return false}babelHelpers.classPrivateFieldLooseBase(this,nn)[nn]=e.clone();if(babelHelpers.classPrivateFieldLooseBase(this,ln)[ln]!==null){babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].destroy()}this.getEditor().dispatchCommand(L);babelHelpers.classPrivateFieldLooseBase(this,ln)[ln]=new qo({targetContainer:document.body,events:{onSave:()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].getVideoUrl();if(!m.Type.isStringFilled(e)){babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].hide();return}if(!sn(e)){babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].showError(m.Loc.getMessage("TEXT_EDITOR_INVALID_URL"));return}this.getEditor().dispatchCommand(rn,{src:e});babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].hide()},onInput:()=>{babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].clearError()},onCancel:()=>{babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].hide()},onShow:()=>{if(Xi(babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].getPopup(),this.getEditor())){m.Event.bind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,on)[on]);this.getEditor().highlightSelection()}},onClose:()=>{babelHelpers.classPrivateFieldLooseBase(this,bn)[bn]()},onDestroy:()=>{babelHelpers.classPrivateFieldLooseBase(this,bn)[bn]()}}});babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].show();return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(L,(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,ln)[ln]!==null){babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].hide()}return false}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(F,(()=>babelHelpers.classPrivateFieldLooseBase(this,ln)[ln]!==null&&babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].isShown()),f.COMMAND_PRIORITY_LOW))}function vn(){const e=f.$getSelection();if(!f.$isRangeSelection(e)&&babelHelpers.classPrivateFieldLooseBase(this,nn)[nn]!==null){f.$setSelection(babelHelpers.classPrivateFieldLooseBase(this,nn)[nn]);babelHelpers.classPrivateFieldLooseBase(this,nn)[nn]=null;return true}return false}function fn(){babelHelpers.classPrivateFieldLooseBase(this,ln)[ln]=null;m.Event.unbind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,on)[on]);this.getEditor().resetHighlightSelection();this.getEditor().update((()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,cn)[cn]()){this.getEditor().focus()}}))}function Pn(){this.getEditor().update((()=>{Xi(babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].getPopup(),this.getEditor())}))}function mn(){this.getEditor().getComponentRegistry().register("video",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --insert-video"></span>');e.disableInsideUnformatted();e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_VIDEO"));e.subscribe("onClick",(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,ln)[ln]!==null&&babelHelpers.classPrivateFieldLooseBase(this,ln)[ln].isShown()){return}this.getEditor().focus((()=>{this.getEditor().dispatchCommand(an)}))}));return e}))}var Ln=Object.freeze({VideoNode:xo,$createVideoNode:wo,$isVideoNode:Ao,INSERT_VIDEO_COMMAND:rn,INSERT_VIDEO_DIALOG_COMMAND:an,VideoPlugin:pn});function Fn(e){let t=M.map((t=>t(e))).filter(Boolean).join(", ").toLocaleLowerCase();if(t!==""){t=`format: ${t}`}return t}function yn(e){if(Te(e)){const t=e;return`{ ${t.__highlightType}: "${Hn(t.getTextContent())}" }`}if(Ne(e)){const t=e;return`{ children: ${t.getChildrenSize()} }`}if(f.$isTextNode(e)){const t=e.getTextContent();const s=t.length===0?"(empty)":`"${Hn(t)}"`;const i=Bn(e);return[s,i.length>0?`{ ${i} }`:null].filter(Boolean).join(" ").trim()}if(Es(e)){const t=e;return`{ id: ${t.getId()}, width: ${t.getWidth()}, height: ${t.getHeight()} }`}if(Ms(e)){const t=e;return`{ id: ${t.getId()} }`}if(Xs(e)){const t=e;return`{ id: ${t.getId()} }`}if(Ya(e)){const t=e;return`{ typing: ${t.getTyping()}, width: ${t.getWidth()}, height: ${t.getHeight()} }`}if(Ao(e)){const t=e;return`{ width: ${t.getWidth()}, height: ${t.getHeight()} }`}if(Sr(e)){const t=e;return`{ entityId: ${t.getEntityId()}, id: ${t.getId()} }`}if(Ki(e)){const t=e;return`{ width: ${t.getWidth()}, height: ${t.getHeight()} }`}if(g.$isLinkNode(e)){const t=e;const s=t.getURL();const i=s.length===0?"(empty)":`"${Hn(s)}"`;const r=Cn(t);return[i,r.length>0?`{ ${r} }`:null].filter(Boolean).join(" ").trim()}return""}function Hn(e){return Object.entries(E).reduce(((e,[t,s])=>e.replace(new RegExp(t,"g"),String(s))),e)}function Bn(e){return[Fn(e),Nn(e),_n(e)].filter(Boolean).join(", ")}function Cn(e){return[Tn(e),On(e),En(e)].filter(Boolean).join(", ")}function Tn(e){let t=e.getTarget();if(!m.Type.isNil(t)){t=`target: ${t}`}return t}function On(e){let t=e.getRel();if(!m.Type.isNil(t)){t=`rel: ${t}`}return t}function En(e){let t=e.getTitle();if(!m.Type.isNil(t)){t=`title: ${t}`}return t}function Nn(e){let t=S.map((t=>t(e))).filter(Boolean).join(", ").toLocaleLowerCase();if(t!==""){t=`detail: ${t}`}return t}function _n(e){let t=D.map((t=>t(e))).filter(Boolean).join(", ").toLocaleLowerCase();if(t!==""){t=`mode: ${t}`}return t}function Mn(e){if(!f.$isNodeSelection(e)){return""}return`: node\n  \u2514 [${[...e._nodes].join(", ")}]`}function Sn(e){let t="";const s=Fn(e);t+=`: range ${s!==""?`{ ${s} }`:""} ${e.style!==""?`{ style: ${e.style} } `:""}`;const i=e.anchor;const r=e.focus;const a=i.offset;const l=r.offset;t+=`\n  \u251c anchor { key: ${i.key}, offset: ${a===null?"null":a}, type: ${i.type} }`;t+=`\n  \u2514 focus { key: ${r.key}, offset: ${l===null?"null":l}, type: ${r.type} }`;return t}function Dn(e){return`: table\n  \u2514 { table: ${e.tableKey}, anchorCell: ${e.anchor.key}, focusCell: ${e.focus.key} }`}function Rn(e,t,s=[]){const i=e.getChildren();const r=i.length;i.forEach(((e,i)=>{t(e,s.concat(i===r-1?_.isLastChild:_.hasNextSibling));if(f.$isElementNode(e)){Rn(e,t,s.concat(i===r-1?_.ancestorIsLastChild:_.ancestorHasNextSibling))}}))}function In(e){const t=e.getEditorState();let s=" root\n";const i=t.read((()=>{const e=f.$getSelection();Rn(f.$getRoot(),((t,i)=>{const r=t.getKey();const a=`(${r})`;const l=t.getType()||"";const o=t.isSelected();s+=`${o?_.selectedLine:" "} ${i.join(" ")} ${a} ${l} ${yn(t)}\n`;s+=xn({indent:i,isSelected:o,node:t,nodeKeyDisplay:a,selection:e,typeDisplay:l})}));if(e===null){return": null"}if(f.$isRangeSelection(e)){return Sn(e)}if(n.$isTableSelection(e)){return Dn(e)}return Mn(e)}));s+=`\n selection${i}`;return s}function xn({indent:e,isSelected:t,node:s,nodeKeyDisplay:i,selection:r,typeDisplay:a}){if(!f.$isTextNode(s)||!f.$isRangeSelection(r)||!t||f.$isElementNode(s)){return""}const l=r.anchor;const o=r.focus;if(s.getTextContent()===""||l.getNode()===r.focus.getNode()&&l.offset===o.offset){return""}const[n,d]=wn(s,r);if(n===d){return""}const c=e[e.length-1]===_.hasNextSibling?_.ancestorHasNextSibling:_.ancestorIsLastChild;const b=[...e.slice(0,-1),c];const h=Array.from({length:n+1}).fill(" ");const u=Array.from({length:d-n}).fill(_.selectedChar);const p=a.length+3;const g=Array.from({length:i.length+p}).fill(" ");return`${[_.selectedLine,b.join(" "),[...g,...h,...u].join("")].join(" ")}\n`}function wn(e,t){const s=t.getStartEndPoints();if(f.$isNodeSelection(t)||s===null){return[-1,-1]}const[i,r]=s;const a=e.getTextContent();const l=a.length;let o=-1;let n=-1;if(i.type==="text"&&r.type==="text"){const t=i.getNode();const s=r.getNode();if(t===s&&e===t&&i.offset!==r.offset){[o,n]=i.offset<r.offset?[i.offset,r.offset]:[r.offset,i.offset]}else if(e===t){[o,n]=t.isBefore(s)?[i.offset,l]:[0,i.offset]}else if(e===s){[o,n]=s.isBefore(t)?[r.offset,l]:[0,r.offset]}else{[o,n]=[0,l]}}const d=(a.slice(0,o).match(N)||[]).length;const c=(a.slice(o,n).match(N)||[]).length;return[o+d,n+d+c]}function An(e=true){const t=f.$getRoot();let s=t.getTextContent();if(e){s=s.trim()}if(s!==""){return false}const i=t.getChildren();const r=i.length;if(r>1){return false}for(let e=0;e<r;e++){const t=i[e];if(f.$isDecoratorNode(t)){return false}if(f.$isElementNode(t)){if(!f.$isParagraphNode(t)){return false}if(t.__indent!==0){return false}const s=t.getChildren();const i=s.length;for(let t=0;t<i;t++){const t=s[e];if(!f.$isTextNode(t)){return false}}}}return true}const $n={blockCursor:"ui-text-editor__block-cursor",hashtag:"ui-text-editor__hashtag",heading:{h1:"ui-text-editor__h1",h2:"ui-text-editor__h2",h3:"ui-text-editor__h3",h4:"ui-text-editor__h4",h5:"ui-text-editor__h5",h6:"ui-text-editor__h6"},image:"ui-text-editor__image",indent:"ui-text-editor__indent",link:"ui-text-editor__link",list:{listitem:"ui-text-editor__listItem",listitemChecked:"ui-text-editor__listItemChecked",listitemUnchecked:"ui-text-editor__listItemUnchecked",nested:{listitem:"ui-text-editor__nestedListItem"},olDepth:["ui-text-editor__ol1","ui-text-editor__ol2","ui-text-editor__ol3","ui-text-editor__ol4","ui-text-editor__ol5"],ul:"ui-text-editor__ul"},ltr:"ui-text-editor__ltr",paragraph:"ui-text-editor__paragraph",quote:"ui-text-editor__quote",rtl:"ui-text-editor__rtl",text:{bold:"ui-text-editor__text-bold",code:"ui-text-editor__text-code",italic:"ui-text-editor__text-italic",strikethrough:"ui-text-editor__text-strikethrough",subscript:"ui-text-editor__text-subscript",superscript:"ui-text-editor__text-superscript",underline:"ui-text-editor__text-underline",underlineStrikethrough:"ui-text-editor__text-underline-strikethrough"},mention:"ui-text-editor__mention",code:"ui-text-editor__code",spoiler:{container:"ui-text-editor__spoiler",title:"ui-text-editor__spoiler-title",content:"ui-text-editor__spoiler-content"},smiley:"ui-text-editor__smiley",codeHighlight:{operator:"ui-text-editor__token-operator",punctuation:"ui-text-editor__token-punctuation",comment:"ui-text-editor__token-comment",word:"ui-text-editor__token-word",keyword:"ui-text-editor__token-keyword",boolean:"ui-text-editor__token-boolean",regex:"ui-text-editor__token-regex",string:"ui-text-editor__token-string",number:"ui-text-editor__token-number",semicolon:"ui-text-editor__token-semicolon",bracket:"ui-text-editor__token-bracket",brace:"ui-text-editor__token-brace",parentheses:"ui-text-editor__token-parentheses"},video:"ui-text-editor__video",table:"ui-text-editor__table",tableRow:"ui-text-editor__table-row",tableCell:"ui-text-editor__table-cell",tableCellHeader:"ui-text-editor__table-cell-header",tableSelection:"ui-text-editor__table-selection",file:{file:"ui-text-editor__file",image:"ui-text-editor__file-image",video:"ui-text-editor__file-video"}};let Kn;var jn=babelHelpers.classPrivateFieldLooseKey("pluginConstructors");var kn=babelHelpers.classPrivateFieldLooseKey("plugins");var Un=babelHelpers.classPrivateFieldLooseKey("availablePlugins");Kn=Symbol.iterator;class Wn{constructor(e=[],t=[],s=[]){Object.defineProperty(this,jn,{writable:true,value:new Map});Object.defineProperty(this,kn,{writable:true,value:new Map});Object.defineProperty(this,Un,{writable:true,value:new Map});for(const t of e){if(t.getName()){babelHelpers.classPrivateFieldLooseBase(this,Un)[Un].set(t.getName(),t)}}for(const e of t){if(m.Type.isFunction(e)&&e.getName()&&!babelHelpers.classPrivateFieldLooseBase(this,Un)[Un].has(e.getName())){babelHelpers.classPrivateFieldLooseBase(this,Un)[Un].set(e.getName(),e)}}const i=t.filter((e=>{if(s.includes(e)){return false}if(m.Type.isFunction(e)&&s.includes(e.getName())){return false}return!s.includes(babelHelpers.classPrivateFieldLooseBase(this,Un)[Un].get(e))}));i.map((e=>m.Type.isFunction(e)?e:babelHelpers.classPrivateFieldLooseBase(this,Un)[Un].get(e))).forEach((e=>{if(m.Type.isFunction(e)){babelHelpers.classPrivateFieldLooseBase(this,jn)[jn].set(e.getName(),e)}}))}init(e){const t=[];for(const[,s]of babelHelpers.classPrivateFieldLooseBase(this,jn)[jn]){const i=new s(e);if(!(i instanceof Z)){throw new TypeError("TextEditor: a plugin must be an instance of TextEditor.BasePlugin.")}babelHelpers.classPrivateFieldLooseBase(this,kn)[kn].set(s.getName(),i);t.push(i)}t.forEach((e=>{e.afterInit()}))}getConstructors(){return[...babelHelpers.classPrivateFieldLooseBase(this,jn)[jn].values()]}getPlugins(){return babelHelpers.classPrivateFieldLooseBase(this,kn)[kn]}[Kn](){return babelHelpers.classPrivateFieldLooseBase(this,kn)[kn][Symbol.iterator]()}get(e){const t=m.Type.isFunction(e)?e.getName():e;return babelHelpers.classPrivateFieldLooseBase(this,kn)[kn].get(t)||null}has(e){const t=m.Type.isFunction(e)?e.getName():e;return babelHelpers.classPrivateFieldLooseBase(this,kn)[kn].has(t)}}var Yn=babelHelpers.classPrivateFieldLooseKey("components");var zn=babelHelpers.classPrivateFieldLooseKey("normalizeName");class Xn{constructor(){Object.defineProperty(this,Yn,{writable:true,value:new Map})}register(e,t){babelHelpers.classPrivateFieldLooseBase(this,Yn)[Yn].set(babelHelpers.classPrivateFieldLooseBase(this.constructor,zn)[zn](e),{callback:t})}create(e){const t=babelHelpers.classPrivateFieldLooseBase(this,Yn)[Yn].get(babelHelpers.classPrivateFieldLooseBase(this.constructor,zn)[zn](e));return t?t.callback():null}}function Gn(e){return String(e).toLowerCase()}Object.defineProperty(Xn,zn,{value:Gn});var Vn=babelHelpers.classPrivateFieldLooseKey("editor");var Jn=babelHelpers.classPrivateFieldLooseKey("nodeTypeToBBCodeType");var qn=babelHelpers.classPrivateFieldLooseKey("nodeValidation");var Qn=babelHelpers.classPrivateFieldLooseKey("initNodeValidation");var Zn=babelHelpers.classPrivateFieldLooseKey("handleNodeTransform");class ed{constructor(e){Object.defineProperty(this,Zn,{value:sd});Object.defineProperty(this,Qn,{value:td});Object.defineProperty(this,Vn,{writable:true,value:null});Object.defineProperty(this,Jn,{writable:true,value:new Map});Object.defineProperty(this,qn,{writable:true,value:new Map});babelHelpers.classPrivateFieldLooseBase(this,Vn)[Vn]=e;babelHelpers.classPrivateFieldLooseBase(this,Qn)[Qn]()}isNodeAllowed(e,t){const s=m.Type.isString(e)?e:babelHelpers.classPrivateFieldLooseBase(this,Jn)[Jn].get(e.getType());const i=m.Type.isString(t)?t:babelHelpers.classPrivateFieldLooseBase(this,Jn)[Jn].get(t.getType());if(!s){console.warn(`TextEditor: parent node (${e.getType()}) doesn't have a bbcode tag.`)}if(!i){console.warn(`TextEditor: child node (${t.getType()}) doesn't have a bbcode tag.`)}return babelHelpers.classPrivateFieldLooseBase(this,Vn)[Vn].getBBCodeScheme().isChildAllowed(s,i)}findAllowedParent(e){let t=e.getParent();while(t!==null){if(this.isNodeAllowed(t,e)){return t}t=t.getParent()}return null}moveToNextParent(e,t=true){let s=e.getParent();let i=null;while(s.getParent()!==null){if(this.isNodeAllowed(s.getParent(),e)){i=s;break}s=s.getParent()}if(i===null){if(t){e.remove()}return false}if(f.$isRootNode(i.getParent())&&(f.$isTextNode(e)||f.$isElementNode(e)&&e.isInline())){i.insertBefore(f.$createParagraphNode().append(e));return true}i.insertBefore(e);return true}}function td(){const e=babelHelpers.classPrivateFieldLooseBase(this,Zn)[Zn].bind(this);for(const[,t]of babelHelpers.classPrivateFieldLooseBase(this,Vn)[Vn].getPlugins()){const s=t.validateScheme();if(!m.Type.isPlainObject(s)){continue}if(m.Type.isArrayFilled(s.nodes)){s.nodes.forEach((t=>{babelHelpers.classPrivateFieldLooseBase(this,Vn)[Vn].registerNodeTransform(t.nodeClass,e);if(m.Type.isFunction(t.validate)){babelHelpers.classPrivateFieldLooseBase(this,qn)[qn].set(t.nodeClass.getType(),{validate:t.validate})}}))}if(m.Type.isPlainObject(s.bbcodeMap)){for(const[e,t]of Object.entries(s.bbcodeMap)){babelHelpers.classPrivateFieldLooseBase(this,Jn)[Jn].set(e,t)}}}}function sd(e){const{validate:t=null}=babelHelpers.classPrivateFieldLooseBase(this,qn)[qn].get(e.getType())||{};if(t!==null&&t(e,this)===true){return}const s=e.getParent();if(this.isNodeAllowed(s,e)){return}console.warn(`TextEditor: ${e.getType()} is not allowed in ${s.getType()}`);this.moveToNextParent(e)}class id extends Z{constructor(e){super(e);this.cleanUpRegister(a.registerRichText(e.getLexicalEditor()))}static getName(){return"RichText"}}var rd=babelHelpers.classPrivateFieldLooseKey("registerComponents");class ad extends Z{constructor(e){super(e);Object.defineProperty(this,rd,{value:ld});babelHelpers.classPrivateFieldLooseBase(this,rd)[rd]()}static getName(){return"Bold"}importBBCode(){return{b:()=>({conversion:I,priority:0}),color:()=>({conversion:I,priority:0}),background:()=>({conversion:I,priority:0}),size:()=>({conversion:I,priority:0})}}exportBBCode(){return{"text:bold":(e,t)=>{if(e.hasFormat("bold")){return G(t,"b",this.getEditor())}return null}}}}function ld(){this.getEditor().getComponentRegistry().register("bold",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --bold"></span>');e.setFormat("bold");e.disableInsideUnformatted();e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_BOLD",{"#keystroke#":m.Browser.isMac()?"\u2318B":"Ctrl+B"}));e.subscribe("onClick",(()=>{this.getEditor().focus();this.getEditor().update((()=>{this.getEditor().dispatchCommand(f.FORMAT_TEXT_COMMAND,"bold")}))}));return e}))}var od=Object.freeze({BoldPlugin:ad});var nd=babelHelpers.classPrivateFieldLooseKey("registerComponents");class dd extends Z{constructor(e){super(e);Object.defineProperty(this,nd,{value:cd});babelHelpers.classPrivateFieldLooseBase(this,nd)[nd]()}static getName(){return"Italic"}importBBCode(){return{i:()=>({conversion:I,priority:0})}}exportBBCode(){return{"text:italic":(e,t)=>{if(e.hasFormat("italic")){return G(t,"i",this.getEditor())}return null}}}}function cd(){this.getEditor().getComponentRegistry().register("italic",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --italic"></span>');e.setFormat("italic");e.disableInsideUnformatted();e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_ITALIC",{"#keystroke#":m.Browser.isMac()?"\u2318I":"Ctrl+I"}));e.subscribe("onClick",(()=>{this.getEditor().focus();this.getEditor().update((()=>{this.getEditor().dispatchCommand(f.FORMAT_TEXT_COMMAND,"italic")}))}));return e}))}var bd=Object.freeze({ItalicPlugin:dd});var hd=babelHelpers.classPrivateFieldLooseKey("registerKeyModifierCommand");var ud=babelHelpers.classPrivateFieldLooseKey("registerComponents");class pd extends Z{constructor(e){super(e);Object.defineProperty(this,ud,{value:vd});Object.defineProperty(this,hd,{value:gd});babelHelpers.classPrivateFieldLooseBase(this,ud)[ud]();babelHelpers.classPrivateFieldLooseBase(this,hd)[hd]()}static getName(){return"Strikethrough"}importBBCode(){return{s:()=>({conversion:I,priority:0}),del:()=>({conversion:I,priority:0})}}exportBBCode(){return{"text:strikethrough":(e,t)=>{if(e.hasFormat("strikethrough")){return G(t,"s",this.getEditor())}return null}}}}function gd(){this.cleanUpRegister(this.getEditor().registerCommand(f.KEY_MODIFIER_COMMAND,(e=>{const t=e;const{code:s,ctrlKey:i,metaKey:r,shiftKey:a}=t;if(s==="KeyX"&&(i||r)&&a){t.preventDefault();this.getEditor().dispatchCommand(f.FORMAT_TEXT_COMMAND,"strikethrough");return true}return false}),f.COMMAND_PRIORITY_NORMAL))}function vd(){this.getEditor().getComponentRegistry().register("strikethrough",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --strikethrough"></span>');e.setFormat("strikethrough");e.disableInsideUnformatted();e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_STRIKETHROUGH",{"#keystroke#":m.Browser.isMac()?"\u2318\u21e7X":"Ctrl+Shift+X"}));e.subscribe("onClick",(()=>{this.getEditor().focus();this.getEditor().update((()=>{this.getEditor().dispatchCommand(f.FORMAT_TEXT_COMMAND,"strikethrough")}))}));return e}))}var fd=Object.freeze({StrikethroughPlugin:pd});var Pd=babelHelpers.classPrivateFieldLooseKey("registerComponents");class md extends Z{constructor(e){super(e);Object.defineProperty(this,Pd,{value:Ld});babelHelpers.classPrivateFieldLooseBase(this,Pd)[Pd]()}static getName(){return"Underline"}importBBCode(){return{u:()=>({conversion:I,priority:0})}}exportBBCode(){return{"text:underline":(e,t)=>{if(e.hasFormat("underline")){return G(t,"u",this.getEditor())}return null}}}}function Ld(){this.getEditor().getComponentRegistry().register("underline",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --underline"></span>');e.setFormat("underline");e.disableInsideUnformatted();e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_UNDERLINE",{"#keystroke#":m.Browser.isMac()?"\u2318U":"Ctrl+U"}));e.subscribe("onClick",(()=>{this.getEditor().focus();this.getEditor().update((()=>{this.getEditor().dispatchCommand(f.FORMAT_TEXT_COMMAND,"underline")}))}));return e}))}var Fd=Object.freeze({UnderlinePlugin:md});class yd extends f.ElementNode{static getType(){return"quote"}static clone(e){return new yd(e.__key)}createDOM(e,t){var s;const i=document.createElement("blockquote");i.setAttribute("spellcheck","false");if(m.Type.isStringFilled(e==null?void 0:(s=e.theme)==null?void 0:s.quote)){m.Dom.addClass(i,e.theme.quote)}return i}updateDOM(e,t,s){return false}static importDOM(){return{blockquote:e=>({conversion:e=>({node:Hd()}),priority:0})}}static importJSON(e){const t=Hd();t.setFormat(e.format);t.setIndent(e.indent);t.setDirection(e.direction);return t}exportJSON(){return{...super.exportJSON(),type:"quote"}}canIndent(){return false}isInline(){return false}canReplaceWith(e){return false}collapseAtStart(e){const t=f.$createParagraphNode();const s=this.getChildren();s.forEach((e=>t.append(e)));this.replace(t);return true}insertNewAfter(e,t=true){const s=this.getChildren();const i=s.length;if(i>=2&&s[i-1].getTextContent()==="\n"&&s[i-2].getTextContent()==="\n"&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===i){s[i-1].remove();s[i-2].remove();const e=f.$createParagraphNode();this.insertAfter(e,t);return e}e.insertLineBreak();return null}}function Hd(){return f.$applyNodeReplacement(new yd)}function Bd(e){return e instanceof yd}const Cd=f.createCommand("INSERT_QUOTE_COMMAND");const Td=f.createCommand("FORMAT_QUOTE_COMMAND");var Od=babelHelpers.classPrivateFieldLooseKey("registerCommands");var Ed=babelHelpers.classPrivateFieldLooseKey("registerComponents");class Nd extends Z{constructor(e){super(e);Object.defineProperty(this,Ed,{value:Md});Object.defineProperty(this,Od,{value:_d});babelHelpers.classPrivateFieldLooseBase(this,Od)[Od]();babelHelpers.classPrivateFieldLooseBase(this,Ed)[Ed]()}static getName(){return"Quote"}static getNodes(e){return[yd]}importBBCode(){return{quote:()=>({conversion:e=>({node:Hd(),after:e=>U(e)}),priority:0})}}exportBBCode(){return{quote:e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createElement({name:"quote"})}}}}validateScheme(){return{nodes:[{nodeClass:yd}],bbcodeMap:{quote:"quote"}}}}function _d(){this.cleanUpRegister(this.getEditor().registerCommand(Cd,(e=>{const t=Hd();if(m.Type.isPlainObject(e)&&m.Type.isStringFilled(e.content)){const s=x(e.content,this.getEditor(),false);t.append(...s);P.$insertNodeToNearestRoot(t)}else{P.$insertNodeToNearestRoot(t);t.selectEnd()}return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(Td,(()=>{const e=f.$getSelection();if(f.$isRangeSelection(e)){l.$setBlocksType(e,(()=>Hd()))}return true}),f.COMMAND_PRIORITY_EDITOR))}function Md(){this.getEditor().getComponentRegistry().register("quote",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --quote"></span>');e.setBlockType("quote");e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_QUOTE"));e.subscribe("onClick",(()=>{this.getEditor().focus();this.getEditor().update((()=>{if(e.isActive()){this.getEditor().dispatchCommand(ge)}else if(this.getEditor().getNewLineMode()===T.LINE_BREAK){this.getEditor().dispatchCommand(Cd)}else{this.getEditor().dispatchCommand(Td)}}))}));return e}))}var Sd=Object.freeze({QuoteNode:yd,$createQuoteNode:Hd,$isQuoteNode:Bd,INSERT_QUOTE_COMMAND:Cd,FORMAT_QUOTE_COMMAND:Td,QuotePlugin:Nd});let Dd=e=>e,Rd,Id,xd;var wd=babelHelpers.classPrivateFieldLooseKey("popup");var Ad=babelHelpers.classPrivateFieldLooseKey("editMode");var $d=babelHelpers.classPrivateFieldLooseKey("autoLinkMode");var Kd=babelHelpers.classPrivateFieldLooseKey("linkUrl");var jd=babelHelpers.classPrivateFieldLooseKey("targetContainer");var kd=babelHelpers.classPrivateFieldLooseKey("refs");var Ud=babelHelpers.classPrivateFieldLooseKey("handleSaveBtnClick");var Wd=babelHelpers.classPrivateFieldLooseKey("handleLinkTextBoxKeyDown");var Yd=babelHelpers.classPrivateFieldLooseKey("handleCancelBtnClick");var zd=babelHelpers.classPrivateFieldLooseKey("handleEditBtnClick");var Xd=babelHelpers.classPrivateFieldLooseKey("handleUnlinkBtnClick");class Gd extends d.EventEmitter{constructor(e){super();Object.defineProperty(this,Xd,{value:Zd});Object.defineProperty(this,zd,{value:Qd});Object.defineProperty(this,Yd,{value:qd});Object.defineProperty(this,Wd,{value:Jd});Object.defineProperty(this,Ud,{value:Vd});Object.defineProperty(this,wd,{writable:true,value:null});Object.defineProperty(this,Ad,{writable:true,value:null});Object.defineProperty(this,$d,{writable:true,value:null});Object.defineProperty(this,Kd,{writable:true,value:""});Object.defineProperty(this,jd,{writable:true,value:null});Object.defineProperty(this,kd,{writable:true,value:new h.MemoryCache});this.setEventNamespace("BX.UI.TextEditor.LinkEditor");const t=m.Type.isPlainObject(e)?e:{};this.setTargetContainer(t.targetContainer);this.setLinkUrl(t.linkUrl);if(m.Type.isBoolean(t.editMode)){this.setEditMode(t.editMode)}else{this.setEditMode(babelHelpers.classPrivateFieldLooseBase(this,Kd)[Kd]==="")}this.setAutoLinkMode(e.autoLinkMode);this.subscribeFromOptions(t.events)}show(e={}){var t;const s=(t=e.target)!=null?t:undefined;const i=m.Type.isPlainObject(e.targetOptions)?e.targetOptions:{};if(!m.Type.isUndefined(s)){this.getPopup().setBindElement(s)}this.getPopup().adjustPosition({...i,forceBindPosition:true});this.getPopup().show()}isShown(){return babelHelpers.classPrivateFieldLooseBase(this,wd)[wd]!==null&&babelHelpers.classPrivateFieldLooseBase(this,wd)[wd].isShown()}hide(){this.getPopup().close()}destroy(){this.getPopup().destroy()}setAutoLinkMode(e=true){if(e===babelHelpers.classPrivateFieldLooseBase(this,$d)[$d]){return}if(e){m.Dom.addClass(this.getContainer(),"--auto-link-mode")}else{m.Dom.removeClass(this.getContainer(),"--auto-link-mode")}if(babelHelpers.classPrivateFieldLooseBase(this,wd)[wd]!==null){babelHelpers.classPrivateFieldLooseBase(this,wd)[wd].adjustPosition()}babelHelpers.classPrivateFieldLooseBase(this,$d)[$d]=e}setEditMode(e=true){if(e===babelHelpers.classPrivateFieldLooseBase(this,Ad)[Ad]){return}if(e){m.Dom.addClass(this.getContainer(),"--edit-mode")}else{m.Dom.removeClass(this.getContainer(),"--edit-mode")}if(babelHelpers.classPrivateFieldLooseBase(this,wd)[wd]!==null){babelHelpers.classPrivateFieldLooseBase(this,wd)[wd].adjustPosition()}babelHelpers.classPrivateFieldLooseBase(this,Ad)[Ad]=e}setLinkUrl(e){if(m.Type.isString(e)){babelHelpers.classPrivateFieldLooseBase(this,Kd)[Kd]=qi(e);this.getLinkTextBox().value=babelHelpers.classPrivateFieldLooseBase(this,Kd)[Kd];this.getLinkLabel().textContent=babelHelpers.classPrivateFieldLooseBase(this,Kd)[Kd];this.getLinkLabel().href=babelHelpers.classPrivateFieldLooseBase(this,Kd)[Kd]}}getLinkUrl(){return babelHelpers.classPrivateFieldLooseBase(this,Kd)[Kd]}setTargetContainer(e){if(m.Type.isElementNode(e)){babelHelpers.classPrivateFieldLooseBase(this,jd)[jd]=e}}getTargetContainer(){return babelHelpers.classPrivateFieldLooseBase(this,jd)[jd]}getPopup(){if(babelHelpers.classPrivateFieldLooseBase(this,wd)[wd]===null){babelHelpers.classPrivateFieldLooseBase(this,wd)[wd]=new b.Popup({autoHide:true,cacheable:false,padding:0,closeByEsc:true,targetContainer:this.getTargetContainer(),content:this.getContainer(),events:{onClose:()=>{this.emit("onClose")},onDestroy:()=>{this.emit("onDestroy")},onShow:()=>{this.emit("onShow")},onAfterShow:()=>{if(babelHelpers.classPrivateFieldLooseBase(this,Ad)[Ad]){this.getLinkTextBox().focus()}}}})}return babelHelpers.classPrivateFieldLooseBase(this,wd)[wd]}getContainer(){return babelHelpers.classPrivateFieldLooseBase(this,kd)[kd].remember("container",(()=>m.Tag.render(Rd||(Rd=Dd`
				<div class="ui-text-editor-link-editor">
					<div class="ui-text-editor-link-form">
						<div class="ui-ctl ui-ctl-textbox ui-ctl-s ui-ctl-inline ui-ctl-w100 ui-text-editor-link-textbox">
							<div class="ui-ctl-tag">${0}</div>
							${0}
						</div>
						<button type="button" 
							class="ui-text-editor-link-form-button" 
							onclick="${0}"
						>
							<span class="ui-icon-set --check"></span>
						</button>
						<button 
							type="button" 
							class="ui-text-editor-link-form-button"
							onclick="${0}"
						>
							<span class="ui-icon-set --cross-60"></span>
						</button>
					</div>
					<div class="ui-text-editor-link-preview">
						${0}
						<button 
							type="button" 
							class="ui-text-editor-link-form-button"
							onclick="${0}"
						>
							<span class="ui-icon-set --pencil-60"></span>
						</button>
						<button 
							type="button" 
							class="ui-text-editor-link-form-button ui-text-editor-link-form-delete-btn"
							onclick="${0}"
						>
							<span class="ui-icon-set --delete-hyperlink"></span>
						</button>
					</div>
				</div>
			`),m.Loc.getMessage("TEXT_EDITOR_LINK_URL"),this.getLinkTextBox(),babelHelpers.classPrivateFieldLooseBase(this,Ud)[Ud].bind(this),babelHelpers.classPrivateFieldLooseBase(this,Yd)[Yd].bind(this),this.getLinkLabel(),babelHelpers.classPrivateFieldLooseBase(this,zd)[zd].bind(this),babelHelpers.classPrivateFieldLooseBase(this,Xd)[Xd].bind(this))))}getLinkTextBox(){return babelHelpers.classPrivateFieldLooseBase(this,kd)[kd].remember("link-textbox",(()=>m.Tag.render(Id||(Id=Dd`
				<input 
					type="text"
					class="ui-ctl-element"
					placeholder="https://"
					value="${0}"
					onkeydown="${0}"
				>
			`),this.getLinkUrl(),babelHelpers.classPrivateFieldLooseBase(this,Wd)[Wd].bind(this))))}getLinkLabel(){return babelHelpers.classPrivateFieldLooseBase(this,kd)[kd].remember("link-label",(()=>m.Tag.render(xd||(xd=Dd`
				<a href="" target="_blank" class="ui-text-editor-link-label"></a>
			`))))}}function Vd(){const e=this.getLinkTextBox().value.trim();if(e.length>0){this.setLinkUrl(e);this.emit("onSave")}else{this.getLinkTextBox().focus()}}function Jd(e){if(e.key==="Enter"){e.preventDefault();babelHelpers.classPrivateFieldLooseBase(this,Ud)[Ud]()}}function qd(){this.emit("onCancel")}function Qd(){this.setEditMode(true);this.getLinkTextBox().focus();this.getLinkTextBox().select()}function Zd(){this.emit("onUnlink")}function ec(e){return/^(http:|https:|mailto:|tel:|sms:)/i.test(e)}const tc=f.createCommand("INSERT_LINK_DIALOG_COMMAND");var sc=babelHelpers.classPrivateFieldLooseKey("linkEditor");var ic=babelHelpers.classPrivateFieldLooseKey("onEditorScroll");var rc=babelHelpers.classPrivateFieldLooseKey("lastSelection");var ac=babelHelpers.classPrivateFieldLooseKey("registerListeners");var lc=babelHelpers.classPrivateFieldLooseKey("registerCommands");var oc=babelHelpers.classPrivateFieldLooseKey("registerToggleLinkCommand");var nc=babelHelpers.classPrivateFieldLooseKey("registerInsertLinkCommand");var dc=babelHelpers.classPrivateFieldLooseKey("restoreSelection");var cc=babelHelpers.classPrivateFieldLooseKey("handleDialogDestroy");var bc=babelHelpers.classPrivateFieldLooseKey("handleEditorScroll");var hc=babelHelpers.classPrivateFieldLooseKey("registerKeyModifierCommand");var uc=babelHelpers.classPrivateFieldLooseKey("registerPasteCommand");var pc=babelHelpers.classPrivateFieldLooseKey("insertLink");var gc=babelHelpers.classPrivateFieldLooseKey("isLinkSelected");var vc=babelHelpers.classPrivateFieldLooseKey("convertAutoLinkToLink");var fc=babelHelpers.classPrivateFieldLooseKey("registerComponents");class Pc extends Z{constructor(e){super(e);Object.defineProperty(this,fc,{value:Mc});Object.defineProperty(this,vc,{value:_c});Object.defineProperty(this,gc,{value:Nc});Object.defineProperty(this,pc,{value:Ec});Object.defineProperty(this,uc,{value:Oc});Object.defineProperty(this,hc,{value:Tc});Object.defineProperty(this,bc,{value:Cc});Object.defineProperty(this,cc,{value:Bc});Object.defineProperty(this,dc,{value:Hc});Object.defineProperty(this,nc,{value:yc});Object.defineProperty(this,oc,{value:Fc});Object.defineProperty(this,lc,{value:Lc});Object.defineProperty(this,ac,{value:mc});Object.defineProperty(this,sc,{writable:true,value:null});Object.defineProperty(this,ic,{writable:true,value:babelHelpers.classPrivateFieldLooseBase(this,bc)[bc].bind(this)});Object.defineProperty(this,rc,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,lc)[lc]();babelHelpers.classPrivateFieldLooseBase(this,ac)[ac]();babelHelpers.classPrivateFieldLooseBase(this,fc)[fc]()}static getName(){return"Link"}static getNodes(e){return[g.LinkNode]}importBBCode(){return{url:()=>({conversion:e=>{let t=e.getValue();if(!ec(t)){t=e.toPlainText();if(!ec(t)){return{node:null}}}return{node:g.$createLinkNode(qi(t),{target:"_blank"})}},priority:0})}}exportBBCode(){return{link:e=>{const t=e.getURL();const s=e.getChildren();const i=s.length===1&&f.$isTextNode(s[0])&&s[0].getFormat()===0;const r=this.getEditor().getBBCodeScheme();if(i&&s[0].getTextContent()===t){return{node:r.createElement({name:"url"})}}return{node:r.createElement({name:"url",value:t})}}}}validateScheme(){return{nodes:[{nodeClass:g.LinkNode}],bbcodeMap:{link:"url"}}}destroy(){super.destroy();if(babelHelpers.classPrivateFieldLooseBase(this,sc)[sc]!==null){babelHelpers.classPrivateFieldLooseBase(this,sc)[sc].destroy()}}}function mc(){this.cleanUpRegister(this.getEditor().registerEventListener(g.LinkNode,"click",((e,t)=>{const s=f.$getNodeByKey(t);if(g.$isLinkNode(s)){this.getEditor().dispatchCommand(tc,s)}})))}function Lc(){this.cleanUpRegister(babelHelpers.classPrivateFieldLooseBase(this,oc)[oc](),babelHelpers.classPrivateFieldLooseBase(this,nc)[nc](),babelHelpers.classPrivateFieldLooseBase(this,hc)[hc](),babelHelpers.classPrivateFieldLooseBase(this,uc)[uc]())}function Fc(){return this.getEditor().registerCommand(g.TOGGLE_LINK_COMMAND,(e=>{if(e===null){g.toggleLink(e);return true}const t=f.$getSelection();if(!f.$isRangeSelection(t)){return false}let s=null;let i=null;let r={};if(m.Type.isStringFilled(e)){s=e}else if(m.Type.isPlainObject(e)){const{target:t,rel:a,title:l}=e;r={rel:a,target:t,title:l};s=e.url;i=e.originalUrl||null}if(m.Type.isStringFilled(s)){if(!m.Type.isStringFilled(r.target)){r.target="_blank"}if(ec(s)){if(t.isCollapsed()&&!babelHelpers.classPrivateFieldLooseBase(this,gc)[gc](t)){babelHelpers.classPrivateFieldLooseBase(this,pc)[pc](t,s,r,i)}else{g.toggleLink(s,r)}return true}return false}return false}),f.COMMAND_PRIORITY_LOW)}function yc(){return P.mergeRegister(this.getEditor().registerCommand(tc,(e=>{const t=f.$getSelection();if(!f.$isRangeSelection(t)||!this.getEditor().isEditable()){return false}babelHelpers.classPrivateFieldLooseBase(this,rc)[rc]=t.clone();if(babelHelpers.classPrivateFieldLooseBase(this,sc)[sc]!==null){babelHelpers.classPrivateFieldLooseBase(this,sc)[sc].destroy()}let s=null;let i=null;if(g.$isLinkNode(e)){s=e;i=s.getURL()}else{const e=P.$findMatchingParent(t.anchor.getNode(),(e=>(e.__flags&C)!==0));if(e){return false}const r=V(t);const a=P.$findMatchingParent(r,g.$isLinkNode);if(a){s=a;i=s.getURL();s.select()}else if(g.$isLinkNode(r)){s=r;i=s.getURL();s.select()}}this.getEditor().dispatchCommand(L);babelHelpers.classPrivateFieldLooseBase(this,sc)[sc]=new Gd({linkUrl:i,autoLinkMode:g.$isAutoLinkNode(s),targetContainer:document.body,events:{onSave:e=>{const t=e.getTarget();let i=t.getLinkUrl();if(!m.Type.isStringFilled(i)){t.hide();return}const r=m.Validation.isEmail(i)?"mailto:":"https://";const a=i;if(!ec(i)){i=`${r}${i}`;t.setLinkUrl(i)}if(s===null){this.getEditor().update((()=>{babelHelpers.classPrivateFieldLooseBase(this,dc)[dc]();this.getEditor().dispatchCommand(g.TOGGLE_LINK_COMMAND,{url:i,originalUrl:a});t.setEditMode(false);const e=f.$getSelection();if(f.$isRangeSelection(e)){babelHelpers.classPrivateFieldLooseBase(this,rc)[rc]=e.clone()}if(!f.$isRangeSelection(e)||e.isCollapsed()){t.hide()}babelHelpers.classPrivateFieldLooseBase(this,vc)[vc](e)}))}else{this.getEditor().update((()=>{s.setURL(i);babelHelpers.classPrivateFieldLooseBase(this,vc)[vc](f.$getSelection());t.setAutoLinkMode(false)}));t.setEditMode(false)}this.getEditor().resetHighlightSelection()},onCancel:e=>{const t=e.getTarget();t.hide()},onUnlink:e=>{if(s===null){this.getEditor().dispatchCommand(g.TOGGLE_LINK_COMMAND,null)}else{this.getEditor().update((()=>{const e=s.getChildren();for(const t of e){s.insertBefore(t)}s.remove()}))}const t=e.getTarget();t.hide()},onShow:()=>{if(Xi(babelHelpers.classPrivateFieldLooseBase(this,sc)[sc].getPopup(),this.getEditor())){m.Event.bind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,ic)[ic]);this.getEditor().highlightSelection()}},onClose:()=>{babelHelpers.classPrivateFieldLooseBase(this,cc)[cc]()},onDestroy:()=>{babelHelpers.classPrivateFieldLooseBase(this,cc)[cc]()}}});babelHelpers.classPrivateFieldLooseBase(this,sc)[sc].show();return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(L,(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,sc)[sc]!==null){babelHelpers.classPrivateFieldLooseBase(this,sc)[sc].destroy()}return false}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(F,(()=>babelHelpers.classPrivateFieldLooseBase(this,sc)[sc]!==null&&babelHelpers.classPrivateFieldLooseBase(this,sc)[sc].isShown()),f.COMMAND_PRIORITY_LOW))}function Hc(){const e=f.$getSelection();if(!f.$isRangeSelection(e)&&babelHelpers.classPrivateFieldLooseBase(this,rc)[rc]!==null){f.$setSelection(babelHelpers.classPrivateFieldLooseBase(this,rc)[rc]);babelHelpers.classPrivateFieldLooseBase(this,rc)[rc]=null;return true}return false}function Bc(){babelHelpers.classPrivateFieldLooseBase(this,sc)[sc]=null;m.Event.unbind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,ic)[ic]);this.getEditor().resetHighlightSelection();this.getEditor().update((()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,dc)[dc]()){this.getEditor().focus()}}))}function Cc(){this.getEditor().update((()=>{Xi(babelHelpers.classPrivateFieldLooseBase(this,sc)[sc].getPopup(),this.getEditor())}))}function Tc(){return this.getEditor().registerCommand(f.KEY_MODIFIER_COMMAND,(e=>{const t=e;const{code:s,ctrlKey:i,metaKey:r}=t;if(s==="KeyK"&&(i||r)){t.preventDefault();this.getEditor().dispatchCommand(tc);return true}return false}),f.COMMAND_PRIORITY_NORMAL)}function Oc(){return this.getEditor().registerCommand(f.PASTE_COMMAND,(e=>{const t=f.$getSelection();if(!f.$isRangeSelection(t)||t.isCollapsed()||!(e instanceof ClipboardEvent)||e.clipboardData===null){return false}const s=e.clipboardData.getData("text");if(!ec(s)){return false}if(!t.getNodes().some((e=>f.$isElementNode(e)))){g.toggleLink(s);e.preventDefault();return true}return false}),f.COMMAND_PRIORITY_LOW)}function Ec(e,t,s,i){const r=qi(t);const a=g.$createLinkNode(r,s);a.append(f.$createTextNode(m.Type.isStringFilled(i)?i:r));const l=e.anchor;if(l.type==="text"&&l.getNode().isSimpleText()){const e=l.getNode();const t=l.offset;const s=e.splitText(t);if(t===0){s[0].insertBefore(a);a.select()}else{s[0].insertAfter(a);a.select()}}else{f.$insertNodes([a]);if(f.$isRootOrShadowRoot(a.getParentOrThrow())){P.$wrapNodeInElement(a,f.$createParagraphNode).selectEnd()}}}function Nc(e){const t=V(e);const s=t.getParent();return g.$isLinkNode(s)||g.$isLinkNode(t)}function _c(e){if(f.$isRangeSelection(e)){const t=V(e).getParent();if(g.$isAutoLinkNode(t)){const e=g.$createLinkNode(t.getURL(),{rel:t.getRel(),target:m.Type.isStringFilled(t.getTarget())?t.getTarget():"_blank",title:t.getTitle()});t.replace(e,true);return true}}return false}function Mc(){this.getEditor().getComponentRegistry().register("link",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --link-3"></span>');e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_LINK"));e.setBlockType("link");e.disableInsideUnformatted();e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_LINK",{"#keystroke#":m.Browser.isMac()?"\u2318K":"Ctrl+K"}));e.subscribe("onClick",(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,sc)[sc]!==null&&babelHelpers.classPrivateFieldLooseBase(this,sc)[sc].isShown()){return}this.getEditor().focus((()=>{this.getEditor().dispatchCommand(tc)}))}));return e}))}var Sc=Object.freeze({INSERT_LINK_DIALOG_COMMAND:tc,LinkPlugin:Pc});const Dc=/((https?:\/\/(www\.)?)|(www\.))[\w#%+.:=@~-]{1,256}\.[\d()A-Za-z]{1,6}\b([\w#%&()+./:=?@~-]*)/;const Rc=/(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\dA-Za-z-]+\.)+[A-Za-z]{2,}))/;const Ic=[$c(Dc,(e=>e.startsWith("http")?e:`https://${e}`)),$c(Rc,(e=>`mailto:${e}`))];var xc=babelHelpers.classPrivateFieldLooseKey("registerListeners");class wc extends Z{constructor(e){super(e);Object.defineProperty(this,xc,{value:Ac});babelHelpers.classPrivateFieldLooseBase(this,xc)[xc]()}static getName(){return"AutoLink"}static getNodes(e){return[g.AutoLinkNode]}validateScheme(){return{nodes:[{nodeClass:g.AutoLinkNode}],bbcodeMap:{autolink:"url"}}}}function Ac(){const e=(e,t)=>{};this.cleanUpRegister(this.getEditor().registerNodeTransform(f.TextNode,(t=>{const s=t.getParentOrThrow();const i=t.getPreviousSibling();if(g.$isAutoLinkNode(s)){Vc(s,Ic,e)}else if(!g.$isLinkNode(s)){if(t.isSimpleText()&&(Wc(t.getTextContent())||!g.$isAutoLinkNode(i))){Gc(t,Ic,e)}Jc(t,Ic,e)}})))}function $c(e,t=(e=>e)){return s=>{const i=e.exec(s);if(i===null){return null}return{index:i.index,length:i[0].length,text:i[0],url:t(s)}}}function Kc(e,t){for(const s of t){const t=s(e);if(t){return t}}return null}const jc=/[\s(),.;[\]]/;function kc(e){return jc.test(e)}function Uc(e){return kc(e[e.length-1])}function Wc(e){return kc(e[0])}function Yc(e){let t=e.getPreviousSibling();if(f.$isElementNode(t)){t=t.getLastDescendant()}return t===null||f.$isLineBreakNode(t)||f.$isTextNode(t)&&Uc(t.getTextContent())}function zc(e){let t=e.getNextSibling();if(f.$isElementNode(t)){t=t.getFirstDescendant()}return t===null||f.$isLineBreakNode(t)||f.$isTextNode(t)&&Wc(t.getTextContent())}function Xc(e,t,s,i){const r=e>0?kc(s[e-1]):Yc(i);if(!r){return false}return t<s.length?kc(s[t]):zc(i)}function Gc(e,t,s){const i=e.getTextContent();let r=i;let a=0;let l=e;let o=Kc(r,t);while(o!==null){const n=o.index;const d=o.length;const c=n+d;const b=Xc(a+n,a+c,i,e);if(b){let e=null;if(a+n===0){[e,l]=l.splitText(a+d)}else{[,e,l]=l.splitText(a+n,a+n+d)}const t=m.Type.isPlainObject(o.attributes)?{...o.attributes}:{};if(!m.Type.isStringFilled(t.target)){t.target="_blank"}const i=g.$createAutoLinkNode(o.url,t);const r=f.$createTextNode(o.text);r.setFormat(e.getFormat());r.setDetail(e.getDetail());i.append(r);e.replace(i);s(o.url,null);a=0}else{a+=c}r=r.slice(Math.max(0,c));o=Kc(r,t)}}function Vc(e,t,s){const i=e.getChildren();const r=i.length;for(let t=0;t<r;t++){const r=i[t];if(!f.$isTextNode(r)||!r.isSimpleText()){qc(e);s(null,e.getURL());return}}const a=e.getTextContent();const l=Kc(a,t);if(l===null||l.text!==a){qc(e);s(null,e.getURL());return}if(!Yc(e)||!zc(e)){qc(e);s(null,e.getURL());return}const o=e.getURL();if(o!==l.url){e.setURL(l.url);s(l.url,o)}if(l.attributes){const t=e.getRel();if(t!==l.attributes.rel){e.setRel(l.attributes.rel||null);s(l.attributes.rel||null,t)}const i=e.getTarget();if(i!==l.attributes.target){e.setTarget(l.attributes.target||null);s(l.attributes.target||null,i)}}}function Jc(e,t,s){const i=e.getPreviousSibling();const r=e.getNextSibling();const a=e.getTextContent();if(g.$isAutoLinkNode(i)&&!Wc(a)){i.append(e);Vc(i,t,s);s(null,i.getURL())}if(g.$isAutoLinkNode(r)&&!Uc(a)){qc(r);Vc(r,t,s);s(null,r.getURL())}}function qc(e){const t=e.getChildren();const s=t.length;for(let i=s-1;i>=0;i--){e.insertAfter(t[i])}e.remove();return t.map((e=>e.getLatest()))}var Qc=Object.freeze({AutoLinkPlugin:wc});var Zc=babelHelpers.classPrivateFieldLooseKey("registerListeners");class eb extends Z{constructor(e){super(e);Object.defineProperty(this,Zc,{value:tb});babelHelpers.classPrivateFieldLooseBase(this,Zc)[Zc]()}static getName(){return"TabIndent"}}function tb(){this.cleanUpRegister(this.getEditor().registerCommand(f.KEY_TAB_COMMAND,(e=>{const t=f.$getSelection();if(!f.$isRangeSelection(t)){return false}e.preventDefault();return this.getEditor().dispatchCommand(e.shiftKey?f.OUTDENT_CONTENT_COMMAND:f.INDENT_CONTENT_COMMAND)}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(f.INDENT_CONTENT_COMMAND,(e=>{const t=f.$getSelection();return!sb(t)}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.OUTDENT_CONTENT_COMMAND,(e=>{const t=f.$getSelection();return!sb(t)}),f.COMMAND_PRIORITY_LOW))}function sb(e){if(!f.$isRangeSelection(e)){return false}const t=e.isBackward();const s=t?e.focus:e.anchor;const i=s.getNode();if(p.$isListItemNode(i)&&s.offset===0){return true}const r=P.$findMatchingParent(i,(e=>f.$isElementNode(e)&&!e.isInline()));return p.$isListItemNode(r)&&s.offset===0}var ib=Object.freeze({TabIndentPlugin:eb});var rb=babelHelpers.classPrivateFieldLooseKey("registerListeners");var ab=babelHelpers.classPrivateFieldLooseKey("registerComponents");var lb=babelHelpers.classPrivateFieldLooseKey("isIndentPermitted");var ob=babelHelpers.classPrivateFieldLooseKey("getElementNodesInSelection");class nb extends Z{constructor(e){super(e);Object.defineProperty(this,ob,{value:hb});Object.defineProperty(this,lb,{value:bb});Object.defineProperty(this,ab,{value:cb});Object.defineProperty(this,rb,{value:db});babelHelpers.classPrivateFieldLooseBase(this,rb)[rb]();babelHelpers.classPrivateFieldLooseBase(this,ab)[ab]()}static getName(){return"List"}static getNodes(e){return[p.ListNode,p.ListItemNode]}importBBCode(){return{list:()=>({conversion:e=>({node:e.getValue()==="1"?p.$createListNode("number",1):p.$createListNode("bullet")}),priority:0}),"*":()=>({conversion:e=>({node:p.$createListItemNode()}),priority:0})}}exportBBCode(){return{list:e=>{const t=this.getEditor().getBBCodeScheme();const s=t.createElement({name:"list"});if(e.getListType()==="number"){s.setValue("1")}return{node:s}},listitem:e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createElement({name:"*"})}}}}validateScheme(){return{nodes:[{nodeClass:p.ListNode}],bbcodeMap:{list:"list",listitem:"*"}}}}function db(){this.cleanUpRegister(this.getEditor().registerCommand(p.INSERT_ORDERED_LIST_COMMAND,(()=>{p.insertList(this.getLexicalEditor(),"number");return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(p.INSERT_UNORDERED_LIST_COMMAND,(()=>{p.insertList(this.getLexicalEditor(),"bullet");return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(p.REMOVE_LIST_COMMAND,(()=>{p.removeList(this.getLexicalEditor());return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.INSERT_PARAGRAPH_COMMAND,(()=>p.$handleListInsertParagraph()),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.INDENT_CONTENT_COMMAND,(()=>!babelHelpers.classPrivateFieldLooseBase(this,lb)[lb](1)),f.COMMAND_PRIORITY_CRITICAL))}function cb(){this.getEditor().getComponentRegistry().register("bulleted-list",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --bulleted-list"></span>');e.setBlockType("bullet");e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_BULLETED_LIST"));e.subscribe("onClick",(()=>{this.getEditor().focus();this.getEditor().update((()=>{if(e.isActive()){this.getEditor().dispatchCommand(p.REMOVE_LIST_COMMAND)}else{this.getEditor().dispatchCommand(p.INSERT_UNORDERED_LIST_COMMAND)}}))}));return e}));this.getEditor().getComponentRegistry().register("numbered-list",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --numbered-list"></span>');e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_NUMBERED_LIST"));e.setBlockType("number");e.subscribe("onClick",(()=>{this.getEditor().focus();this.getEditor().update((()=>{if(e.isActive()){this.getEditor().dispatchCommand(p.REMOVE_LIST_COMMAND)}else{this.getEditor().dispatchCommand(p.INSERT_ORDERED_LIST_COMMAND)}}))}));return e}))}function bb(e){const t=f.$getSelection();if(!f.$isRangeSelection(t)){return false}const s=babelHelpers.classPrivateFieldLooseBase(this,ob)[ob](t);let i=0;for(const e of s){if(p.$isListNode(e)){i=Math.max(p.$getListDepth(e)+1,i)}else if(p.$isListItemNode(e)){const t=e.getParent();if(!p.$isListNode(t)){throw new Error("TextEditor: A ListItemNode must have a ListNode for a parent.")}i=Math.max(p.$getListDepth(t)+1,i)}}return i<=e}function hb(e){const t=e.getNodes();const s=e=>f.$isElementNode(e)&&!e.isInline();if(t.length===0){return new Set([P.$findMatchingParent(e.anchor.getNode(),s),P.$findMatchingParent(e.focus.getNode(),s)])}return new Set(t.map((e=>f.$isElementNode(e)?e:P.$findMatchingParent(e,s))))}var ub=Object.freeze({ListPlugin:nb});function pb(e){const t=vb();return{node:t}}class gb extends f.ElementNode{static getType(){return"spoiler-content"}static clone(e){return new gb(e.__key)}createDOM(e,t){var s,i;const r=document.createElement("div");if(m.Type.isStringFilled(e==null?void 0:(s=e.theme)==null?void 0:(i=s.spoiler)==null?void 0:i.content)){m.Dom.addClass(r,e.theme.spoiler.content)}return r}updateDOM(e,t,s){return false}static importDOM(){return{div:e=>{if(!e.hasAttribute("data-lexical-spoiler-content")){return null}return{conversion:pb,priority:2}}}}static importJSON(e){return vb()}exportDOM(){const e=document.createElement("div");e.setAttribute("data-lexical-spoiler-content","true");return{element:e}}exportJSON(){return{...super.exportJSON(),type:"spoiler-content",version:1}}isShadowRoot(){return true}isParentRequired(){return true}createParentElementNode(){return qb()}canIndent(){return false}canInsertAfter(e){return false}canReplaceWith(e){return false}insertBefore(e){const t=this.getFirstChild();const s=f.$isElementNode(e)||f.$isDecoratorNode(e)?e:f.$createParagraphNode().append(e);if(t===null){this.append(s)}else{t.insertBefore(s)}return s}insertAfter(e){const t=f.$isElementNode(e)||f.$isDecoratorNode(e)?e:f.$createParagraphNode().append(e);this.append(t);return t}}function vb(){return new gb}function fb(e){return e instanceof gb}class Pb extends f.TextNode{static getType(){return"spoiler-title-text"}static clone(e){return new Pb(e.__text,e.__key)}createDOM(e){return super.createDOM(e)}static importJSON(e){return mb(e.text)}exportJSON(){return{...super.exportJSON(),type:"spoiler-title-text"}}}function mb(e=""){return f.$applyNodeReplacement(new Pb(e))}function Lb(e){return e instanceof Pb}const Fb=f.createCommand("INSERT_SPOILER_COMMAND");const yb=f.createCommand("REMOVE_SPOILER_COMMAND");var Hb=babelHelpers.classPrivateFieldLooseKey("registerComponents");var Bb=babelHelpers.classPrivateFieldLooseKey("registerCommands");var Cb=babelHelpers.classPrivateFieldLooseKey("registerNodeTransforms");var Tb=babelHelpers.classPrivateFieldLooseKey("handleDeleteCharacter");var Ob=babelHelpers.classPrivateFieldLooseKey("handleEnter");var Eb=babelHelpers.classPrivateFieldLooseKey("handleEscapeUp");var Nb=babelHelpers.classPrivateFieldLooseKey("handleEscapeDown");var _b=babelHelpers.classPrivateFieldLooseKey("handlePaste");class Mb extends Z{constructor(e){super(e);Object.defineProperty(this,_b,{value:$b});Object.defineProperty(this,Nb,{value:Ab});Object.defineProperty(this,Eb,{value:wb});Object.defineProperty(this,Ob,{value:xb});Object.defineProperty(this,Tb,{value:Ib});Object.defineProperty(this,Cb,{value:Rb});Object.defineProperty(this,Bb,{value:Db});Object.defineProperty(this,Hb,{value:Sb});babelHelpers.classPrivateFieldLooseBase(this,Cb)[Cb]();babelHelpers.classPrivateFieldLooseBase(this,Bb)[Bb]();babelHelpers.classPrivateFieldLooseBase(this,Hb)[Hb]()}static getName(){return"Spoiler"}static getNodes(e){return[Vb,Yb,gb,Pb]}importBBCode(){return{spoiler:()=>({conversion:e=>{const t=m.Type.isStringFilled(e.getValue())?Ub(e.getValue()):m.Loc.getMessage("TEXT_EDITOR_SPOILER_TITLE");return{node:qb(false),after:e=>[zb().append(mb(t)),vb().append(...$(e,this.getEditor()))]}},priority:0})}}exportBBCode(){return{spoiler:e=>{const t=this.getEditor().getBBCodeScheme();const s=e.getChildren()[0];const i=Ub(s.getTextContent());const r=i===m.Loc.getMessage("TEXT_EDITOR_SPOILER_TITLE")?"":i;return{node:t.createElement({name:"spoiler",value:r})}},"spoiler-title":e=>({node:null}),"spoiler-content":e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createFragment()}}}}validateScheme(){return{nodes:[{nodeClass:Vb},{nodeClass:gb,validate:e=>{e.getChildren().forEach((e=>{if(A(e)){const t=f.$createParagraphNode();e.replace(t);t.append(e)}}));return false}}],bbcodeMap:{spoiler:"spoiler","spoiler-content":"spoiler"}}}}function Sb(){this.getEditor().getComponentRegistry().register("spoiler",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --insert-spoiler"></span>');e.setBlockType("spoiler");e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_SPOILER"));e.subscribe("onClick",(()=>{this.getEditor().focus();this.getEditor().update((()=>{if(e.isActive()){this.getEditor().dispatchCommand(yb)}else{this.getEditor().dispatchCommand(Fb)}}))}));return e}))}function Db(){this.cleanUpRegister(this.getEditor().registerCommand(f.DELETE_CHARACTER_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,Tb)[Tb].bind(this),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_ARROW_DOWN_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,Nb)[Nb].bind(this),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_ARROW_RIGHT_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,Nb)[Nb].bind(this),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_ARROW_UP_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,Eb)[Eb].bind(this),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_ARROW_LEFT_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,Eb)[Eb].bind(this),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.KEY_ENTER_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,Ob)[Ob].bind(this),f.COMMAND_PRIORITY_NORMAL),this.getEditor().registerCommand(f.INSERT_PARAGRAPH_COMMAND,(e=>{const t=f.$getSelection();if(f.$isRangeSelection(t)){const e=P.$findMatchingParent(t.anchor.getNode(),(e=>Xb(e)));if(e){const s=e.insertNewAfter(t);if(s){s.selectStart()}return true}}return false}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.PASTE_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,_b)[_b].bind(this),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(Fb,(e=>{this.getEditor().update((()=>{const t=m.Type.isPlainObject(e)&&m.Type.isStringFilled(e.title)?e.title:undefined;const s=f.$getSelection();const i=Kb(s,t);i.getTitleNode().select()}));return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(yb,(()=>{this.getEditor().update((()=>{const e=f.$getSelection();if(!f.$isRangeSelection(e)){return}let t=P.$findMatchingParent(e.anchor.getNode(),Qb);if(!t){t=P.$findMatchingParent(e.focus.getNode(),Qb)}Gb(t)}));return true}),f.COMMAND_PRIORITY_LOW))}function Rb(){this.cleanUpRegister(this.getEditor().registerNodeTransform(Vb,(e=>{const t=e.getChildren();if(t.length!==2||!Xb(t[0])||!fb(t[1])){for(const s of t){if(f.$isElementNode(s)||f.$isDecoratorNode(s)){e.insertBefore(s)}else{e.insertBefore(f.$createParagraphNode().append(s))}}e.remove()}})),this.getEditor().registerNodeTransform(Yb,(e=>{const t=e.getParent();if(!Qb(t)){e.replace(f.$createParagraphNode().append(...e.getChildren()))}else if(e.getChildrenSize()===1&&!Lb(e.getFirstChild())||e.getChildrenSize()>1){f.$setSelection(null);const t=Ub(e.getTextContent());e.clear();e.append(mb(t));e.select()}})),this.getEditor().registerNodeTransform(Pb,(e=>{const t=e.getParent();if(!Xb(t)){e.replace(f.$createParagraphNode().append(f.$createTextNode(e.getTextContent())))}})),this.getEditor().registerNodeTransform(gb,(e=>{const t=e.getParent();if(!Qb(t)){const t=e.getChildren();for(const s of t){if(f.$isElementNode(s)||f.$isDecoratorNode(s)){e.insertBefore(s)}else{e.insertBefore(f.$createParagraphNode().append(s))}}e.remove()}})))}function Ib(){const e=f.$getSelection();if(!f.$isRangeSelection(e)||!e.isCollapsed()||e.anchor.offset!==0){return false}const t=e.anchor.getNode();const s=t.getTopLevelElement();if(s===null){return false}const i=s.getPreviousSibling();if(!Qb(i)||i.getOpen()){return false}i.setOpen(true);return true}function xb(e){if(e&&(e.ctrlKey||e.metaKey)){const e=f.$getPreviousSelection();if(f.$isRangeSelection(e)&&e.isCollapsed()){const t=P.$findMatchingParent(e.anchor.getNode(),(e=>f.$isElementNode(e)&&!e.isInline()));if(Xb(t)){const s=t.getParent();if(Qb(s)){s.toggleOpen();f.$setSelection(e.clone());return true}}}}return false}function wb(){const e=f.$getSelection();if(f.$isRangeSelection(e)&&e.isCollapsed()&&e.anchor.offset===0){const s=P.$findMatchingParent(e.anchor.getNode(),Qb);if(Qb(s)){var t;const i=s.getParent();if(i!==null&&i.getFirstChild()===s&&e.anchor.key===((t=s.getFirstDescendant())==null?void 0:t.getKey())){s.insertBefore(f.$createParagraphNode())}}}return false}function Ab(){const e=f.$getSelection();if(f.$isRangeSelection(e)&&e.isCollapsed()){const t=P.$findMatchingParent(e.anchor.getNode(),Qb);if(Qb(t)){const s=t.getParent();if(s!==null&&s.getLastChild()===t){const s=t.getFirstDescendant();const i=t.getLastDescendant();if(i!==null&&e.anchor.key===i.getKey()&&e.anchor.offset===i.getTextContentSize()||s!==null&&e.anchor.key===s.getKey()&&e.anchor.offset===s.getTextContentSize()){t.insertAfter(f.$createParagraphNode())}}}}return false}function $b(e){const t=f.$getSelection();if(!f.$isRangeSelection(t)||!(e instanceof ClipboardEvent)||e.clipboardData===null){return false}const s=P.$findMatchingParent(t.anchor.getNode(),(e=>Xb(e)));if(s){o.$insertDataTransferForPlainText(e.clipboardData,t);return true}return false}function Kb(e,t){if(!f.$isRangeSelection(e)){return null}const s=e.anchor;const i=s.getNode();const r=Jb(true,t);if(f.$isRootOrShadowRoot(i)){const e=i.getFirstChild();if(e){e.replace(r,true)}else{i.append(r)}return r}const a=new Set;const l=e.getNodes();const o=kb(e.anchor.getNode(),jb);if(o&&!l.includes(o)){l.unshift(o)}a.add(r.getKey());a.add(r.getTitleNode().getKey());a.add(r.getContentNode().getKey());let n=true;for(const e of l){if(!jb(e)||a.has(e.getKey())){continue}const t=kb(e.getParent(),(e=>a.has(e.getKey())));if(t){continue}if(n){n=false;e.replace(r);r.getContentNode().append(e)}else{r.getContentNode().append(e)}a.add(e.getKey())}return r}function jb(e){return(f.$isElementNode(e)||f.$isDecoratorNode(e))&&!e.isInline()&&!e.isParentRequired()}function kb(e,t){let s=e;while(s!==null&&s.getParent()!==null&&!t(s)){s=s.getParentOrThrow()}return t(s)?s:null}function Ub(e){return e.trim().replaceAll(/\r?\n|\t/gm,"").replace("\r","").replaceAll(/\s+/g," ")}function Wb(e){const t=zb();return{node:t}}class Yb extends f.ElementNode{constructor(...e){super(...e);this.__language="hack";this.__flags=C}static getType(){return"spoiler-title"}static clone(e){return new Yb(e.__key)}createDOM(e,t){var s,i;const r=document.createElement("summary");if(m.Type.isStringFilled(e==null?void 0:(s=e.theme)==null?void 0:(i=s.spoiler)==null?void 0:i.title)){m.Dom.addClass(r,e.theme.spoiler.title)}m.Dom.addClass(r,"ui-icon-set__scope");return r}updateDOM(e,t,s){return false}static importDOM(){return{summary:e=>({conversion:Wb,priority:1})}}static importJSON(e){return zb()}exportDOM(){const e=document.createElement("summary");return{element:e}}exportJSON(){return{...super.exportJSON(),type:"spoiler-title",version:1}}collapseAtStart(e){const t=this.getParent();if(!Qb(t)){return false}return Gb(t)}insertNewAfter(e,t=true){const s=this.getParentOrThrow();if(!Qb(s)){throw new Error("SpoilerTitleNode expects to be child of SpoilerNode")}if(s.getOpen()){const e=this.getNextSibling();if(!fb(e)){throw new Error("SpoilerTitleNode expects to have SpoilerContentNode sibling")}const t=e.getFirstChild();if(f.$isElementNode(t)||f.$isDecoratorNode(t)){return t}const s=f.$createParagraphNode();e.append(s);return s}const i=f.$createParagraphNode();s.insertAfter(i,t);return i}isParentRequired(){return true}createParentElementNode(){return qb()}canIndent(){return false}insertAfter(e){const t=e.getTextContent();this.clear();this.append(mb(Ub(t)));return this}}function zb(){return new Yb}function Xb(e){return e instanceof Yb}function Gb(e){if(!Qb(e)){return false}const t=e.getContentNode();let s=e;if(t!==null){for(const e of t.getChildren()){if(f.$isElementNode(e)||f.$isDecoratorNode(e)){s=s.insertAfter(e)}else{s=s.insertAfter(f.$createParagraphNode().append(e))}}}e.remove();return true}class Vb extends f.ElementNode{constructor(e,t){super(t);this.__open=e}static getType(){return"spoiler"}static clone(e){return new Vb(e.__open,e.__key)}createDOM(e,t){var s,i;const r=document.createElement("details");if(m.Type.isStringFilled(e==null?void 0:(s=e.theme)==null?void 0:(i=s.spoiler)==null?void 0:i.container)){m.Dom.addClass(r,e.theme.spoiler.container)}r.open=this.__open;m.Event.bind(r,"toggle",(()=>{const e=t.getEditorState().read((()=>this.getOpen()));if(e!==r.open){t.update((()=>this.toggleOpen()))}}));return r}updateDOM(e,t,s){if(e.__open!==this.__open){t.open=this.__open}return false}static importDOM(){return{details:e=>({conversion:e=>{const t=m.Type.isBoolean(e.open)?e.open:true;return{node:Jb(t)}},priority:1})}}static importJSON(e){return qb(e.open)}exportDOM(e){const t=document.createElement("details");if(this.__open){t.setAttribute("open",true)}return{element:t}}exportJSON(){return{...super.exportJSON(),open:this.__open,type:"spoiler",version:1}}isShadowRoot(){return true}canBeEmpty(){return false}append(...e){for(const t of e){if(Xb(t)){const e=t;if(this.getTitleNode()===null){super.append(e)}else{this.getTitleNode().clear();this.getTitleNode().append(mb(t.getTextContent()))}}else if(fb(t)){const e=t;if(this.getContentNode()===null){super.append(e)}else{this.getContentNode().append(...e.getChildren())}}else if(f.$isElementNode(t)||f.$isDecoratorNode(t)){this.getContentNode().append(t)}else{this.getContentNode().append(f.$createParagraphNode().append(t))}}return this}getTitleNode(){return this.getChildren()[0]||null}getContentNode(){return this.getChildren()[1]||null}setOpen(e){const t=this.getWritable();t.__open=e}getOpen(){return this.getLatest().__open}toggleOpen(){this.setOpen(!this.getOpen())}}function Jb(e,t=m.Loc.getMessage("TEXT_EDITOR_SPOILER_TITLE")){return qb(e).append(zb().append(mb(t)),vb())}function qb(e){return new Vb(e)}function Qb(e){return e instanceof Vb}var Zb=Object.freeze({SpoilerNode:Vb,$createSpoiler:Jb,$createSpoilerNode:qb,$isSpoilerNode:Qb,convertSummaryElement:Wb,SpoilerTitleNode:Yb,$createSpoilerTitleNode:zb,$isSpoilerTitleNode:Xb,$removeSpoiler:Gb,convertSpoilerContentElement:pb,SpoilerContentNode:gb,$createSpoilerContentNode:vb,$isSpoilerContentNode:fb,INSERT_SPOILER_COMMAND:Fb,REMOVE_SPOILER_COMMAND:yb,SpoilerPlugin:Mb,insertSpoiler:Kb,$getAncestor:kb,trimSpoilerTitle:Ub});let eh=e=>e,th,sh,ih,rh;var ah=babelHelpers.classPrivateFieldLooseKey("popup");var lh=babelHelpers.classPrivateFieldLooseKey("targetNode");var oh=babelHelpers.classPrivateFieldLooseKey("refs");var nh=babelHelpers.classPrivateFieldLooseKey("lastSelectedBox");var dh=babelHelpers.classPrivateFieldLooseKey("handleMouseMove");var ch=babelHelpers.classPrivateFieldLooseKey("handleClick");var bh=babelHelpers.classPrivateFieldLooseKey("highlightBoxes");class hh extends d.EventEmitter{constructor(e){super();Object.defineProperty(this,bh,{value:gh});Object.defineProperty(this,ch,{value:ph});Object.defineProperty(this,dh,{value:uh});Object.defineProperty(this,ah,{writable:true,value:null});Object.defineProperty(this,lh,{writable:true,value:null});Object.defineProperty(this,oh,{writable:true,value:new h.MemoryCache});Object.defineProperty(this,nh,{writable:true,value:null});this.setEventNamespace("BX.UI.TextEditor.TableDialog");const t=m.Type.isPlainObject(e)?e:{};this.setTargetNode(t.targetNode);this.subscribeFromOptions(t.events)}show(){this.getPopup().adjustPosition({forceBindPosition:true});this.getPopup().show()}hide(){this.getPopup().close()}isShown(){return babelHelpers.classPrivateFieldLooseBase(this,ah)[ah]!==null&&babelHelpers.classPrivateFieldLooseBase(this,ah)[ah].isShown()}destroy(){this.getPopup().destroy()}setTargetNode(e){if(m.Type.isElementNode(e)){babelHelpers.classPrivateFieldLooseBase(this,lh)[lh]=e}}getTargetNode(){return babelHelpers.classPrivateFieldLooseBase(this,lh)[lh]}getPopup(){if(babelHelpers.classPrivateFieldLooseBase(this,ah)[ah]===null){const e=this.getTargetNode();const t=e.getBoundingClientRect();const s=t.width;babelHelpers.classPrivateFieldLooseBase(this,ah)[ah]=new b.Popup({autoHide:true,closeByEsc:true,padding:0,content:m.Tag.render(th||(th=eh`
					<div class="ui-text-editor-table-dialog" onclick="${0}">
						${0}
						${0}
					</div>
				`),babelHelpers.classPrivateFieldLooseBase(this,ch)[ch].bind(this),this.getGridContainer(),this.getCaptionContainer()),bindElement:this.getTargetNode(),events:{onClose:()=>{this.emit("onClose")},onDestroy:()=>{this.emit("onDestroy")},onShow:e=>{const t=e.getTarget();const i=t.getPopupContainer().offsetWidth;const r=s/2-i/2;const a=b.Popup.getOption("angleLeftOffset")-b.Popup.getOption("angleMinTop");t.setAngle({offset:i/2-a});t.setOffset({offsetLeft:r+b.Popup.getOption("angleLeftOffset")});babelHelpers.classPrivateFieldLooseBase(this,nh)[nh]=null;babelHelpers.classPrivateFieldLooseBase(this,bh)[bh](1,1)}}})}return babelHelpers.classPrivateFieldLooseBase(this,ah)[ah]}getGridContainer(){return babelHelpers.classPrivateFieldLooseBase(this,oh)[oh].remember("grid",(()=>{const e=[];for(let t=0;t<100;t++){const s=Math.floor(t/10);const i=t%10;e.push(m.Tag.render(sh||(sh=eh`
					<button
						class="ui-text-editor-table-dialog-box"
						data-column="${0}"
						data-row="${0}"
					></button>
				`),i+1,s+1))}return m.Tag.render(ih||(ih=eh`
				<div 
					class="ui-text-editor-table-dialog-grid" 
					onmousemove="${0}"
				>${0}</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,dh)[dh].bind(this),e)}))}getCaptionContainer(){return babelHelpers.classPrivateFieldLooseBase(this,oh)[oh].remember("caption",(()=>m.Tag.render(rh||(rh=eh`<div class="ui-text-editor-table-dialog-caption"></div>`))))}}function uh(e){if(babelHelpers.classPrivateFieldLooseBase(this,nh)[nh]!==e.target&&m.Dom.hasClass(e.target,"ui-text-editor-table-dialog-box")){const{row:t,column:s}=e.target.dataset;babelHelpers.classPrivateFieldLooseBase(this,bh)[bh](t,s);babelHelpers.classPrivateFieldLooseBase(this,nh)[nh]=e.target}}function ph(e){if(babelHelpers.classPrivateFieldLooseBase(this,nh)[nh]){const{row:e,column:t}=babelHelpers.classPrivateFieldLooseBase(this,nh)[nh].dataset;this.emit("onSelect",{rows:e,columns:t})}}function gh(e,t){let s=0;for(const i of this.getGridContainer().children){const r=Math.floor(s/10);const a=s%10;const l=r<e&&a<t;if(l){m.Dom.addClass(i,"--selected")}else{m.Dom.removeClass(i,"--selected")}s++}this.getCaptionContainer().textContent=e&&t?`${e} x ${t}`:""}const vh=f.createCommand("INSERT_TABLE_DIALOG_COMMAND");var fh=babelHelpers.classPrivateFieldLooseKey("tableDialog");var Ph=babelHelpers.classPrivateFieldLooseKey("registerComponents");var mh=babelHelpers.classPrivateFieldLooseKey("registerCommands");var Lh=babelHelpers.classPrivateFieldLooseKey("registerListeners");class Fh extends Z{constructor(e){super(e);Object.defineProperty(this,Lh,{value:Bh});Object.defineProperty(this,mh,{value:Hh});Object.defineProperty(this,Ph,{value:yh});Object.defineProperty(this,fh,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,mh)[mh]();babelHelpers.classPrivateFieldLooseBase(this,Lh)[Lh]();babelHelpers.classPrivateFieldLooseBase(this,Ph)[Ph]()}static getName(){return"Table"}static getNodes(e){return[n.TableNode,n.TableCellNode,n.TableRowNode]}importBBCode(){return{table:()=>({conversion:e=>({node:n.$createTableNode()}),priority:0}),tr:()=>({conversion:e=>({node:n.$createTableRowNode()}),priority:0}),td:()=>({conversion:e=>({node:n.$createTableCellNode(),after:e=>$(e,this.getEditor())}),priority:0}),th:()=>({conversion:e=>({node:n.$createTableCellNode(n.TableCellHeaderStates.ROW),after:e=>$(e,this.getEditor())}),priority:0})}}exportBBCode(){return{table:()=>{const e=this.getEditor().getBBCodeScheme();return{node:e.createElement({name:"table"})}},tablerow:()=>{const e=this.getEditor().getBBCodeScheme();return{node:e.createElement({name:"tr"})}},tablecell:e=>{const t=this.getEditor().getBBCodeScheme();return{node:t.createElement({name:e.hasHeader()?"th":"td"})}}}}validateScheme(){return{nodes:[{nodeClass:n.TableNode,validate:e=>{if(e.getChildrenSize()===0){e.remove();return true}return false}},{nodeClass:n.TableCellNode,validate:e=>{e.getChildren().forEach((e=>{if(A(e)){const t=f.$createParagraphNode();e.replace(t);t.append(e)}}));return false}}],bbcodeMap:{table:"table",tablerow:"tr",tablecell:"td"}}}destroy(){super.destroy();if(babelHelpers.classPrivateFieldLooseBase(this,fh)[fh]!==null){babelHelpers.classPrivateFieldLooseBase(this,fh)[fh].destroy()}}}function yh(){this.getEditor().getComponentRegistry().register("table",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --table-editor"></span>');e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_TABLE"));e.subscribe("onClick",(()=>{this.getEditor().dispatchCommand(vh,{targetNode:e.getContainer()})}));return e}))}function Hh(){this.cleanUpRegister(this.getEditor().registerCommand(n.INSERT_TABLE_COMMAND,(({columns:e,rows:t})=>{const s=Math.max(1,m.Text.toNumber(t));const i=Math.max(1,m.Text.toNumber(e));const r=n.$createTableNodeWithDimensions(s,i,false);P.$insertNodeToNearestRoot(r);const a=r.getFirstDescendant();if(f.$isTextNode(a)){a.select()}return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(vh,(e=>{if(!m.Type.isPlainObject(e)||!m.Type.isElementNode(e.targetNode)){return false}if(babelHelpers.classPrivateFieldLooseBase(this,fh)[fh]!==null){if(babelHelpers.classPrivateFieldLooseBase(this,fh)[fh].getTargetNode()===e.targetNode){babelHelpers.classPrivateFieldLooseBase(this,fh)[fh].show();return true}babelHelpers.classPrivateFieldLooseBase(this,fh)[fh].destroy()}babelHelpers.classPrivateFieldLooseBase(this,fh)[fh]=new hh({targetNode:e.targetNode,events:{onSelect:e=>{this.getEditor().dispatchCommand(n.INSERT_TABLE_COMMAND,e.getData());babelHelpers.classPrivateFieldLooseBase(this,fh)[fh].hide()},onDestroy:()=>{babelHelpers.classPrivateFieldLooseBase(this,fh)[fh]=null}}});babelHelpers.classPrivateFieldLooseBase(this,fh)[fh].show();return true}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(L,(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,fh)[fh]!==null){babelHelpers.classPrivateFieldLooseBase(this,fh)[fh].hide()}return false}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(F,(()=>babelHelpers.classPrivateFieldLooseBase(this,fh)[fh]!==null&&babelHelpers.classPrivateFieldLooseBase(this,fh)[fh].isShown()),f.COMMAND_PRIORITY_LOW))}function Bh(){const e=new Map;const t=t=>{const s=t.getKey();const i=this.getEditor().getElementByKey(s);if(i&&!e.has(s)){const r=n.applyTableHandlers(t,i,this.getLexicalEditor(),true);e.set(s,r)}};this.cleanUpRegister(this.getEditor().registerMutationListener(n.TableNode,(s=>{for(const[i,r]of s){if(r==="created"){this.getEditor().getEditorState().read((()=>{const e=f.$getNodeByKey(i);if(n.$isTableNode(e)){t(e)}}))}else if(r==="destroyed"){const t=e.get(i);if(t!==undefined){t.removeListeners();e.delete(i)}}}})))}var Ch=Object.freeze({INSERT_TABLE_DIALOG_COMMAND:vh,TablePlugin:Fh});class Th extends f.TextNode{static getType(){return"hashtag"}static clone(e){return new Th(e.__text,e.__key)}constructor(e,t){super(e,t)}createDOM(e){var t;const s=super.createDOM(e);if(m.Type.isStringFilled(e==null?void 0:(t=e.theme)==null?void 0:t.hashtag)){m.Dom.addClass(s,e.theme.hashtag)}return s}static importJSON(e){const t=Oh(e.text);t.setFormat(e.format);t.setDetail(e.detail);t.setMode(e.mode);t.setStyle(e.style);return t}exportJSON(){return{...super.exportJSON(),type:"hashtag"}}canInsertTextBefore(){return false}isTextEntity(){return true}}function Oh(e=""){return f.$applyNodeReplacement(new Th(e))}function Eh(e){return e instanceof Th}var Nh=babelHelpers.classPrivateFieldLooseKey("registerListeners");class _h extends Z{constructor(e){super(e);Object.defineProperty(this,Nh,{value:Mh});babelHelpers.classPrivateFieldLooseBase(this,Nh)[Nh]()}static getName(){return"Hashtag"}static getNodes(e){return[Th]}importBBCode(){return null}exportBBCode(){return{hashtag:(e,t)=>{const s=this.getEditor().getBBCodeScheme();return{node:s.createText(e.getTextContent())}}}}validateScheme(){return{bbcodeMap:{hashtag:"#text"}}}}function Mh(){const e=e=>Oh(e.getTextContent());const t=e=>{const t=/(?<=\s+|^)#([^\s,.<>[\]]+)/is.exec(e);if(t===null){return null}const s=t[0].length;const i=t.index;const r=i+s;return{end:r,start:i}};this.cleanUpRegister(...v.registerLexicalTextEntity(this.getLexicalEditor(),t,Th,e))}var Sh=Object.freeze({HashtagNode:Th,$createHashtagNode:Oh,$isHashtagNode:Eh,HashtagPlugin:_h});function Dh(e){if(!m.Type.isStringFilled(e)){return[]}const t=[];const s=e.split(/(\r?\n|\t)/);const i=s.length;for(let e=0;e<i;e++){const i=s[e];if(i==="\n"||i==="\r\n"){t.push(f.$createLineBreakNode())}else if(i==="\t"){t.push(f.$createTabNode())}else{t.push(f.$createTextNode(i))}}return t}let Rh=e=>e,Ih;const xh=f.createCommand("INSERT_COPILOT_DIALOG_COMMAND");const wh={INIT:"init",LOADING:"loading",LOADED:"loaded"};var Ah=babelHelpers.classPrivateFieldLooseKey("copilot");var $h=babelHelpers.classPrivateFieldLooseKey("copilotStatus");var Kh=babelHelpers.classPrivateFieldLooseKey("copilotOptions");var jh=babelHelpers.classPrivateFieldLooseKey("targetParagraph");var kh=babelHelpers.classPrivateFieldLooseKey("lastSelection");var Uh=babelHelpers.classPrivateFieldLooseKey("onEditorScroll");var Wh=babelHelpers.classPrivateFieldLooseKey("triggerBySpace");var Yh=babelHelpers.classPrivateFieldLooseKey("registerListeners");var zh=babelHelpers.classPrivateFieldLooseKey("registerParagraphNodeTransform");var Xh=babelHelpers.classPrivateFieldLooseKey("registerComponents");var Gh=babelHelpers.classPrivateFieldLooseKey("show");var Vh=babelHelpers.classPrivateFieldLooseKey("hide");var Jh=babelHelpers.classPrivateFieldLooseKey("createCopilot");var qh=babelHelpers.classPrivateFieldLooseKey("resetLoader");var Qh=babelHelpers.classPrivateFieldLooseKey("adjustDialogPosition");var Zh=babelHelpers.classPrivateFieldLooseKey("handleEditorScroll");var eu=babelHelpers.classPrivateFieldLooseKey("restoreSelection");var tu=babelHelpers.classPrivateFieldLooseKey("handleCopilotSave");var su=babelHelpers.classPrivateFieldLooseKey("handleCopilotAddBelow");var iu=babelHelpers.classPrivateFieldLooseKey("handleCopilotHide");class ru extends Z{constructor(e){super(e);Object.defineProperty(this,iu,{value:fu});Object.defineProperty(this,su,{value:vu});Object.defineProperty(this,tu,{value:gu});Object.defineProperty(this,eu,{value:pu});Object.defineProperty(this,Zh,{value:uu});Object.defineProperty(this,Qh,{value:hu});Object.defineProperty(this,qh,{value:bu});Object.defineProperty(this,Jh,{value:cu});Object.defineProperty(this,Vh,{value:du});Object.defineProperty(this,Gh,{value:nu});Object.defineProperty(this,Xh,{value:ou});Object.defineProperty(this,zh,{value:lu});Object.defineProperty(this,Yh,{value:au});Object.defineProperty(this,Ah,{writable:true,value:null});Object.defineProperty(this,$h,{writable:true,value:wh.INIT});Object.defineProperty(this,Kh,{writable:true,value:null});Object.defineProperty(this,jh,{writable:true,value:null});Object.defineProperty(this,kh,{writable:true,value:null});Object.defineProperty(this,Uh,{writable:true,value:babelHelpers.classPrivateFieldLooseBase(this,Zh)[Zh].bind(this)});Object.defineProperty(this,Wh,{writable:true,value:false});babelHelpers.classPrivateFieldLooseBase(this,Kh)[Kh]=e.getOption("copilot.copilotOptions");if(m.Type.isPlainObject(babelHelpers.classPrivateFieldLooseBase(this,Kh)[Kh])){babelHelpers.classPrivateFieldLooseBase(this,Yh)[Yh]();babelHelpers.classPrivateFieldLooseBase(this,Xh)[Xh]()}}static getName(){return"Copilot"}shouldTriggerBySpace(){return babelHelpers.classPrivateFieldLooseBase(this,Wh)[Wh]}isCopilotLoaded(){return babelHelpers.classPrivateFieldLooseBase(this,$h)[$h]===wh.LOADED}isCopilotLoading(){return babelHelpers.classPrivateFieldLooseBase(this,$h)[$h]===wh.LOADING}isCopilotShown(){return babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah]!==null&&babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].isShown()}show({onShow:e,onError:t}={}){if(this.isCopilotLoaded()){babelHelpers.classPrivateFieldLooseBase(this,Gh)[Gh]({onShow:e})}else if(!this.isCopilotLoading()){babelHelpers.classPrivateFieldLooseBase(this,Jh)[Jh]().then((()=>{babelHelpers.classPrivateFieldLooseBase(this,Gh)[Gh]({onShow:e})})).catch((()=>{if(m.Type.isFunction(t)){t()}}))}}destroy(){super.destroy();if(babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah]!==null){babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].hide();babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah]=null}}}function au(){babelHelpers.classPrivateFieldLooseBase(this,Wh)[Wh]=this.getEditor().getOption("copilot.triggerBySpace",false);this.cleanUpRegister(this.getEditor().registerCommand(xh,(e=>{const t=m.Type.isPlainObject(e)?e:{};this.show(t);return true}),f.COMMAND_PRIORITY_EDITOR),this.getEditor().registerCommand(L,(()=>{babelHelpers.classPrivateFieldLooseBase(this,Vh)[Vh]();return false}),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(F,(()=>this.isCopilotShown()),f.COMMAND_PRIORITY_LOW),babelHelpers.classPrivateFieldLooseBase(this,Wh)[Wh]?babelHelpers.classPrivateFieldLooseBase(this,zh)[zh]():()=>{})}function lu(){return this.getEditor().registerNodeTransform(ue,(e=>{if(e.getChildrenSize()!==1||!f.$isRootNode(e.getParent())){return}if(!f.$isTextNode(e.getFirstChild())||e.getFirstChild().getTextContent()!==" "){babelHelpers.classPrivateFieldLooseBase(this,qh)[qh]();return}const t=f.$getSelection();if(!f.$isRangeSelection(t)||!t.isCollapsed()){return}const s=t.anchor.getNode();if(s!==e.getFirstChild()){return}if(!this.isCopilotLoaded()&&!this.isCopilotLoading()){babelHelpers.classPrivateFieldLooseBase(this,qh)[qh]();babelHelpers.classPrivateFieldLooseBase(this,jh)[jh]=this.getEditor().getElementByKey(e.getKey());if(babelHelpers.classPrivateFieldLooseBase(this,jh)[jh]){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,jh)[jh],"ui-text-editor-loading-ellipsis")}}e.getFirstChild().remove();e.select();this.show({onShow:()=>babelHelpers.classPrivateFieldLooseBase(this,qh)[qh](),onError:()=>babelHelpers.classPrivateFieldLooseBase(this,qh)[qh]()})}))}function ou(){this.getEditor().getComponentRegistry().register("copilot",(()=>{const e=new be;const t="--copilot-ai";const s="--refresh-5 ui-text-editor-copilot-loading";const i=m.Tag.render(Ih||(Ih=Rh`
				<span class="ui-icon-set ${0}" style="--ui-icon-set__icon-color: #8e52ec"></span>
			`),t);e.setContent(i);e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_COPILOT"));e.subscribe("onClick",(()=>{this.getEditor().focus();if(this.isCopilotLoading()){return}const e=()=>{if(!m.Dom.hasClass(i,t)){m.Dom.removeClass(i,s);m.Dom.addClass(i,t)}};this.getEditor().dispatchCommand(xh,{onShow:e,onError:e});if(!this.isCopilotLoaded()){setTimeout((()=>{if(!this.isCopilotLoaded()){m.Dom.removeClass(i,t);m.Dom.addClass(i,s)}}),500)}}));return e}))}function nu({onShow:e}={}){this.getEditor().update((()=>{const t=f.$getSelection();if(!f.$isRangeSelection(t)||!this.getEditor().isEditable()){return}this.getEditor().dispatchCommand(L);const s=t.getTextContent();const i=s.trim().length>0?s:f.$getRoot().getTextContent();const r=m.Dom.getPosition(this.getEditor().getScrollerContainer());const a=Math.min(r.width,600);babelHelpers.classPrivateFieldLooseBase(this,kh)[kh]=t.clone();babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].setSelectedText(i);babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].show({width:a});babelHelpers.classPrivateFieldLooseBase(this,Qh)[Qh]();m.Event.bind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,Uh)[Uh]);if(!t.isCollapsed()){this.getEditor().highlightSelection()}if(m.Type.isFunction(e)){e()}}))}function du(){if(this.isCopilotLoaded()&&babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].isShown()){babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].hide()}}function cu(){if(this.isDestroyed()){return Promise.reject(new Error("Copilot plugin was destroyed."))}babelHelpers.classPrivateFieldLooseBase(this,$h)[$h]=wh.LOADING;return new Promise(((e,t)=>{m.Runtime.loadExtension("ai.copilot").then((({Copilot:s})=>{if(this.isDestroyed()){t(new Error("Copilot plugin was destroyed."));return}babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah]=new s({...babelHelpers.classPrivateFieldLooseBase(this,Kh)[Kh],autoHide:true});babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].subscribe("finish-init",(()=>{if(this.isDestroyed()){t(new Error("Copilot plugin was destroyed."));return}babelHelpers.classPrivateFieldLooseBase(this,$h)[$h]=wh.LOADED;e()}));babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].subscribe("save",babelHelpers.classPrivateFieldLooseBase(this,tu)[tu].bind(this));babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].subscribe("add_below",babelHelpers.classPrivateFieldLooseBase(this,su)[su].bind(this));babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].subscribe("hide",babelHelpers.classPrivateFieldLooseBase(this,iu)[iu].bind(this));babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].init()})).catch((()=>{t()}))}))}function bu(){if(babelHelpers.classPrivateFieldLooseBase(this,jh)[jh]){m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,jh)[jh],"ui-text-editor-loading-ellipsis")}}function hu(){this.getEditor().update((()=>{babelHelpers.classPrivateFieldLooseBase(this,eu)[eu]();const e=ji(this.getEditor(),f.$getSelection(),document.body);if(e===null){return}const{top:t,left:s,bottom:i}=e;const r=m.Dom.getPosition(this.getEditor().getScrollerContainer());const a=Math.min(r.width,600);let l=a/2;if(s-l<r.left){const e=r.left-(s-l);l-=e+16}else if(r.right<s+a-l){l+=s+a-l-r.right+16}if(i<r.top||t>r.bottom){babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].adjust({hide:true})}else{babelHelpers.classPrivateFieldLooseBase(this,Ah)[Ah].adjust({hide:false,position:{left:s-l,top:i}})}}))}function uu(){babelHelpers.classPrivateFieldLooseBase(this,Qh)[Qh]()}function pu(){const e=f.$getSelection();if(!f.$isRangeSelection(e)&&babelHelpers.classPrivateFieldLooseBase(this,kh)[kh]!==null){f.$setSelection(babelHelpers.classPrivateFieldLooseBase(this,kh)[kh]);babelHelpers.classPrivateFieldLooseBase(this,kh)[kh]=null;return true}return false}function gu(e){const{result:t}=e.getData();this.getEditor().update((()=>{babelHelpers.classPrivateFieldLooseBase(this,eu)[eu]();const e=f.$getSelection();if(f.$isRangeSelection(e)){e.insertRawText(t)}babelHelpers.classPrivateFieldLooseBase(this,Vh)[Vh]()}))}function vu(e){const{result:t}=e.getData();this.getEditor().update((()=>{babelHelpers.classPrivateFieldLooseBase(this,eu)[eu]();const e=f.$getSelection();if(f.$isRangeSelection(e)){const s=e.focus;const i=s.getNode();if(!e.isCollapsed()){i.selectEnd()}const r=i.getParent();if(f.$isParagraphNode(r)){const e=f.$createParagraphNode();e.append(...Dh(t));r.insertAfter(e)}else{e.insertLineBreak();e.insertRawText(t)}}babelHelpers.classPrivateFieldLooseBase(this,Vh)[Vh]()}))}function fu(){m.Event.unbind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,Uh)[Uh]);this.getEditor().resetHighlightSelection();this.getEditor().update((()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,eu)[eu]()){this.getEditor().focus()}}))}var Pu=babelHelpers.classPrivateFieldLooseKey("registerComponents");class mu extends Z{constructor(e){super(e);Object.defineProperty(this,Pu,{value:Lu});const t=c.createEmptyHistoryState();this.cleanUpRegister(c.registerHistory(e.getLexicalEditor(),t,1e3));babelHelpers.classPrivateFieldLooseBase(this,Pu)[Pu]()}static getName(){return"History"}}function Lu(){let e=false;this.getEditor().getComponentRegistry().register("undo",(()=>{const t=new be;t.setContent('<span class="ui-icon-set --undo"></span>');t.setDisabled(!e);t.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_UNDO",{"#keystroke#":m.Browser.isMac()?"\u2318Z":"Ctrl+Z"}));t.subscribe("onClick",(()=>{this.getEditor().dispatchCommand(f.UNDO_COMMAND)}));t.setDisableCallback((()=>!e||!this.getEditor().isEditable()));this.getEditor().registerCommand(f.CAN_UNDO_COMMAND,(s=>{e=s;t.setDisabled(!e);return false}),f.COMMAND_PRIORITY_CRITICAL);return t}));let t=false;this.getEditor().getComponentRegistry().register("redo",(()=>{const e=new be;e.setContent('<span class="ui-icon-set --redo"></span>');e.setDisabled(!t);e.setTooltip(m.Loc.getMessage("TEXT_EDITOR_BTN_REDO",{"#keystroke#":m.Browser.isMac()?"\u2318\u21e7Z":"Ctrl+Y"}));e.subscribe("onClick",(()=>{this.getEditor().dispatchCommand(f.REDO_COMMAND)}));e.setDisableCallback((()=>!t||!this.getEditor().isEditable()));this.getEditor().registerCommand(f.CAN_REDO_COMMAND,(s=>{t=s;e.setDisabled(!t);return false}),f.COMMAND_PRIORITY_CRITICAL);return e}))}var Fu=Object.freeze({HistoryPlugin:mu});let yu=e=>e,Hu,Bu;const Cu={DOWNWARD:1,UPWARD:-1,INDETERMINATE:0};const Tu="application/x-ui-text-editor-drag-block";var Ou=babelHelpers.classPrivateFieldLooseKey("draggableBlockElement");var Eu=babelHelpers.classPrivateFieldLooseKey("lastBlockElementIndex");var Nu=babelHelpers.classPrivateFieldLooseKey("lastTargetElement");var _u=babelHelpers.classPrivateFieldLooseKey("container");var Mu=babelHelpers.classPrivateFieldLooseKey("dropLine");var Su=babelHelpers.classPrivateFieldLooseKey("isDragging");var Du=babelHelpers.classPrivateFieldLooseKey("bodyDragDropHandler");var Ru=babelHelpers.classPrivateFieldLooseKey("bodyDragOverHandler");var Iu=babelHelpers.classPrivateFieldLooseKey("registerEvents");var xu=babelHelpers.classPrivateFieldLooseKey("registerListeners");var wu=babelHelpers.classPrivateFieldLooseKey("handleMouseMove");var Au=babelHelpers.classPrivateFieldLooseKey("handleMouseLeave");var $u=babelHelpers.classPrivateFieldLooseKey("findBlockElement");var Ku=babelHelpers.classPrivateFieldLooseKey("getCurrentIndex");var ju=babelHelpers.classPrivateFieldLooseKey("updatePosition");var ku=babelHelpers.classPrivateFieldLooseKey("setDraggableBlockElement");var Uu=babelHelpers.classPrivateFieldLooseKey("handleDragStart");var Wu=babelHelpers.classPrivateFieldLooseKey("handleDragEnd");var Yu=babelHelpers.classPrivateFieldLooseKey("handleDragOver");var zu=babelHelpers.classPrivateFieldLooseKey("handleDragDrop");var Xu=babelHelpers.classPrivateFieldLooseKey("showDropLine");var Gu=babelHelpers.classPrivateFieldLooseKey("hideDropLine");class Vu extends Z{constructor(e){super(e);Object.defineProperty(this,Gu,{value:dp});Object.defineProperty(this,Xu,{value:np});Object.defineProperty(this,zu,{value:op});Object.defineProperty(this,Yu,{value:lp});Object.defineProperty(this,Wu,{value:ap});Object.defineProperty(this,Uu,{value:rp});Object.defineProperty(this,ku,{value:ip});Object.defineProperty(this,ju,{value:sp});Object.defineProperty(this,Ku,{value:tp});Object.defineProperty(this,$u,{value:ep});Object.defineProperty(this,Au,{value:Zu});Object.defineProperty(this,wu,{value:Qu});Object.defineProperty(this,xu,{value:qu});Object.defineProperty(this,Iu,{value:Ju});Object.defineProperty(this,Ou,{writable:true,value:null});Object.defineProperty(this,Eu,{writable:true,value:Infinity});Object.defineProperty(this,Nu,{writable:true,value:null});Object.defineProperty(this,_u,{writable:true,value:null});Object.defineProperty(this,Mu,{writable:true,value:null});Object.defineProperty(this,Su,{writable:true,value:false});Object.defineProperty(this,Du,{writable:true,value:null});Object.defineProperty(this,Ru,{writable:true,value:null});this.cleanUpRegister(babelHelpers.classPrivateFieldLooseBase(this,Iu)[Iu](),babelHelpers.classPrivateFieldLooseBase(this,xu)[xu]());babelHelpers.classPrivateFieldLooseBase(this,Du)[Du]=e=>{this.getEditor().dispatchCommand(f.DROP_COMMAND,e)};babelHelpers.classPrivateFieldLooseBase(this,Ru)[Ru]=e=>{e.preventDefault()};m.Dom.append(this.getContainer(),this.getEditor().getScrollerContainer());m.Dom.append(this.getDropLine(),this.getEditor().getScrollerContainer())}static getName(){return"BlockToolbar"}getContainer(){if(babelHelpers.classPrivateFieldLooseBase(this,_u)[_u]===null){babelHelpers.classPrivateFieldLooseBase(this,_u)[_u]=m.Tag.render(Hu||(Hu=yu`
				<div class="ui-text-editor-block-toolbar">
					<div 
						class="ui-text-editor-block-drag-icon" 
						draggable="true"
						ondragstart="${0}" 
						ondragend="${0}"
					>
						<div 
							class="ui-icon-set --more-points" 
							style="--ui-icon-set__icon-size: 24px; margin-left: -4px"
						></div>
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Uu)[Uu].bind(this),babelHelpers.classPrivateFieldLooseBase(this,Wu)[Wu].bind(this))}return babelHelpers.classPrivateFieldLooseBase(this,_u)[_u]}getDropLine(){if(babelHelpers.classPrivateFieldLooseBase(this,Mu)[Mu]===null){babelHelpers.classPrivateFieldLooseBase(this,Mu)[Mu]=m.Tag.render(Bu||(Bu=yu`
				<div class="ui-text-editor-block-drop-line"></div>
			`))}return babelHelpers.classPrivateFieldLooseBase(this,Mu)[Mu]}destroy(){super.destroy();m.Dom.remove(this.getContainer());m.Dom.remove(this.getDropLine())}}function Ju(){const e=this.getEditor().getScrollerContainer();const t=babelHelpers.classPrivateFieldLooseBase(this,wu)[wu].bind(this);const s=babelHelpers.classPrivateFieldLooseBase(this,Au)[Au].bind(this);m.Event.bind(e,"mousemove",t);m.Event.bind(e,"mouseleave",s);return()=>{m.Event.unbind(e,"mousemove",t);m.Event.unbind(e,"mouseleave",s)}}function qu(){return P.mergeRegister(this.getEditor().registerCommand(f.DRAGOVER_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,Yu)[Yu].bind(this),f.COMMAND_PRIORITY_LOW),this.getEditor().registerCommand(f.DROP_COMMAND,babelHelpers.classPrivateFieldLooseBase(this,zu)[zu].bind(this),f.COMMAND_PRIORITY_HIGH),this.getEditor().registerTextContentListener((()=>{babelHelpers.classPrivateFieldLooseBase(this,ku)[ku](null);babelHelpers.classPrivateFieldLooseBase(this,ju)[ju]()})))}function Qu(e){if(!this.getEditor().isEditable()){return}const t=e.target;if(!(t instanceof HTMLElement)){babelHelpers.classPrivateFieldLooseBase(this,ku)[ku](null);return}if(t.closest(".ui-text-editor-block-toolbar")!==null){return}const s=babelHelpers.classPrivateFieldLooseBase(this,$u)[$u](e);babelHelpers.classPrivateFieldLooseBase(this,ku)[ku](s)}function Zu(){babelHelpers.classPrivateFieldLooseBase(this,ku)[ku](null)}function ep(e){const t=this.getEditor().getScrollerContainer();const s=t.getBoundingClientRect();let i=null;this.getEditor().getEditorState().read((()=>{const t=f.$getRoot();const r=t.getChildrenKeys();let a=babelHelpers.classPrivateFieldLooseBase(this,Ku)[Ku](r.length);let l=Cu.INDETERMINATE;while(a>=0&&a<r.length){const t=r[a];const o=this.getEditor().getElementByKey(t);if(o===null){break}const n=o.getBoundingClientRect();const{marginLeft:d,marginRight:c,marginTop:b,marginBottom:h}=window.getComputedStyle(o);const u=new DOMRect(s.left+parseFloat(d),n.y-parseFloat(b),n.width+parseFloat(c),n.height+parseFloat(h));const{x:p,y:g}=e;const v=g<u.top;const f=g>u.bottom;const P=p<u.left;const m=p>u.right;const L=!v&&!f&&!P&&!m;if(L){i=o;babelHelpers.classPrivateFieldLooseBase(this,Eu)[Eu]=a;break}if(l===Cu.INDETERMINATE){if(v){l=Cu.UPWARD}else if(f){l=Cu.DOWNWARD}else{l=Infinity}}a+=l}}));return i}function tp(e){if(e===0){return Infinity}if(babelHelpers.classPrivateFieldLooseBase(this,Eu)[Eu]>=0&&babelHelpers.classPrivateFieldLooseBase(this,Eu)[Eu]<e){return babelHelpers.classPrivateFieldLooseBase(this,Eu)[Eu]}return Math.floor(e/2)}function sp(){if(babelHelpers.classPrivateFieldLooseBase(this,Ou)[Ou]===null){m.Dom.style(this.getContainer(),{opacity:0,transform:"translateY(-10000px)"})}else{const e=m.Text.toNumber(m.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,Ou)[Ou],"margin-top"));const t=babelHelpers.classPrivateFieldLooseBase(this,Ou)[Ou].offsetTop+e;m.Dom.style(this.getContainer(),{opacity:1,transform:`translateY(${t}px)`})}}function ip(e){const t=babelHelpers.classPrivateFieldLooseBase(this,Ou)[Ou]!==e;babelHelpers.classPrivateFieldLooseBase(this,Ou)[Ou]=e;if(t){babelHelpers.classPrivateFieldLooseBase(this,ju)[ju]()}}function rp(e){const t=e.dataTransfer;if(!t||babelHelpers.classPrivateFieldLooseBase(this,Ou)[Ou]===null){return}this.getEditor().dispatchCommand(L);t.setDragImage(babelHelpers.classPrivateFieldLooseBase(this,Ou)[Ou],0,0);let s="";this.getEditor().update((()=>{const e=f.$getNearestNodeFromDOMNode(babelHelpers.classPrivateFieldLooseBase(this,Ou)[Ou]);if(e){s=e.getKey()}}));t.setData(Tu,s);babelHelpers.classPrivateFieldLooseBase(this,Su)[Su]=true;m.Event.bind(document.body,"drop",babelHelpers.classPrivateFieldLooseBase(this,Du)[Du]);m.Event.bind(document.body,"dragover",babelHelpers.classPrivateFieldLooseBase(this,Ru)[Ru])}function ap(e){babelHelpers.classPrivateFieldLooseBase(this,Su)[Su]=false;babelHelpers.classPrivateFieldLooseBase(this,Gu)[Gu]();m.Event.unbind(document.body,"drop",babelHelpers.classPrivateFieldLooseBase(this,Du)[Du]);m.Event.unbind(document.body,"dragover",babelHelpers.classPrivateFieldLooseBase(this,Ru)[Ru])}function lp(e){if(babelHelpers.classPrivateFieldLooseBase(this,Su)[Su]===false){return false}const t=e.dataTransfer.types.includes("Files");if(t||!(e.target instanceof HTMLElement)){return false}const s=babelHelpers.classPrivateFieldLooseBase(this,$u)[$u](e);if(s===null){return false}babelHelpers.classPrivateFieldLooseBase(this,Nu)[Nu]=s;babelHelpers.classPrivateFieldLooseBase(this,Xu)[Xu](s,e);e.preventDefault();return true}function op(e){var t;if(babelHelpers.classPrivateFieldLooseBase(this,Su)[Su]===false){return false}const s=e.dataTransfer.types.includes("Files");const i=((t=e.dataTransfer)==null?void 0:t.getData(Tu))||"";if(s||!(e.target instanceof HTMLElement)||!m.Type.isStringFilled(i)){return false}const r=f.$getNodeByKey(i);if(!r||!(e.target instanceof HTMLElement)){return false}const a=babelHelpers.classPrivateFieldLooseBase(this,$u)[$u](e)||babelHelpers.classPrivateFieldLooseBase(this,Nu)[Nu];if(!a){return false}const l=f.$getNearestNodeFromDOMNode(a);if(!l){return false}m.Event.unbind(document.body,"drop",babelHelpers.classPrivateFieldLooseBase(this,Du)[Du]);m.Event.unbind(document.body,"dragover",babelHelpers.classPrivateFieldLooseBase(this,Ru)[Ru]);if(l===r){return true}const{top:o,height:n}=a.getBoundingClientRect();const d=e.clientY-o>n/2;if(d){l.insertAfter(r)}else{l.insertBefore(r)}babelHelpers.classPrivateFieldLooseBase(this,ku)[ku](null);return true}function np(e,t){const{top:s,height:i}=e.getBoundingClientRect();const r=window.getComputedStyle(e);const a=m.Dom.getRelativePosition(e,e.offsetParent);let l=a.top;const o=t.clientY-s>i/2;if(o){l+=i+parseFloat(r.marginBottom)*1.5}else{l+=parseFloat(r.marginTop)/2}const n=2;const d=16;const c=l-n;m.Dom.style(this.getDropLine(),{opacity:.4,left:`${d}px`,right:`${d}px`,transform:`translateY(${c}px)`})}function dp(){m.Dom.style(this.getDropLine(),{opacity:0,transform:"translate(-10000px, -10000px)"})}var cp=Object.freeze({BlockToolbarPlugin:Vu});let bp=e=>e,hp;var up=babelHelpers.classPrivateFieldLooseKey("container");class pp extends ee{constructor(...e){super(...e);Object.defineProperty(this,up,{writable:true,value:null})}getContainer(){if(babelHelpers.classPrivateFieldLooseBase(this,up)[up]===null){babelHelpers.classPrivateFieldLooseBase(this,up)[up]=m.Tag.render(hp||(hp=bp`<span class="ui-text-editor-toolbar-separator"></span>`))}return babelHelpers.classPrivateFieldLooseBase(this,up)[up]}render(){return this.getContainer()}}let gp=e=>e,vp,fp,Pp;var mp=babelHelpers.classPrivateFieldLooseKey("textEditor");var Lp=babelHelpers.classPrivateFieldLooseKey("items");var Fp=babelHelpers.classPrivateFieldLooseKey("rendered");var yp=babelHelpers.classPrivateFieldLooseKey("moreBtn");var Hp=babelHelpers.classPrivateFieldLooseKey("refs");var Bp=babelHelpers.classPrivateFieldLooseKey("resizeObserver");var Cp=babelHelpers.classPrivateFieldLooseKey("timeoutId");var Tp=babelHelpers.classPrivateFieldLooseKey("removeListeners");var Op=babelHelpers.classPrivateFieldLooseKey("registerListeners");var Ep=babelHelpers.classPrivateFieldLooseKey("fillFromOptions");var Np=babelHelpers.classPrivateFieldLooseKey("handleResize");var _p=babelHelpers.classPrivateFieldLooseKey("getSelectionBlockTypes");var Mp=babelHelpers.classPrivateFieldLooseKey("getBlockType");class Sp{constructor(e,t){Object.defineProperty(this,Mp,{value:wp});Object.defineProperty(this,_p,{value:xp});Object.defineProperty(this,Np,{value:Ip});Object.defineProperty(this,Ep,{value:Rp});Object.defineProperty(this,Op,{value:Dp});Object.defineProperty(this,mp,{writable:true,value:null});Object.defineProperty(this,Lp,{writable:true,value:[]});Object.defineProperty(this,Fp,{writable:true,value:false});Object.defineProperty(this,yp,{writable:true,value:null});Object.defineProperty(this,Hp,{writable:true,value:new h.MemoryCache});Object.defineProperty(this,Bp,{writable:true,value:null});Object.defineProperty(this,Cp,{writable:true,value:null});Object.defineProperty(this,Tp,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,mp)[mp]=e;const s=m.Type.isArray(t)?t:[];babelHelpers.classPrivateFieldLooseBase(this,Ep)[Ep](s);if(babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp].length>0){babelHelpers.classPrivateFieldLooseBase(this,Tp)[Tp]=babelHelpers.classPrivateFieldLooseBase(this,Op)[Op]();babelHelpers.classPrivateFieldLooseBase(this,Bp)[Bp]=new ResizeObserver(babelHelpers.classPrivateFieldLooseBase(this,Np)[Np].bind(this))}}renderTo(e){if(this.isRendered()){return}if(m.Type.isElementNode(e)){babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp].forEach((e=>{m.Dom.append(e.render(),this.getItemsContainer())}));m.Dom.append(this.getContainer(),e);if(babelHelpers.classPrivateFieldLooseBase(this,Bp)[Bp]!==null){babelHelpers.classPrivateFieldLooseBase(this,Bp)[Bp].observe(this.getContainer())}babelHelpers.classPrivateFieldLooseBase(this,Fp)[Fp]=true}}isEmpty(){return babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp].length===0}getContainer(){return babelHelpers.classPrivateFieldLooseBase(this,Hp)[Hp].remember("container",(()=>m.Tag.render(vp||(vp=gp`
				<div class="ui-text-editor-toolbar-container">
					${0}
					${0}
				</div>
			`),this.getItemsContainer(),this.getMoreBtnContainer())))}getItemsContainer(){return babelHelpers.classPrivateFieldLooseBase(this,Hp)[Hp].remember("items-container",(()=>m.Tag.render(fp||(fp=gp`
				<div class="ui-text-editor-toolbar-items"></div>
			`))))}getMoreBtnContainer(){return babelHelpers.classPrivateFieldLooseBase(this,Hp)[Hp].remember("more-btn-container",(()=>m.Tag.render(Pp||(Pp=gp`
				<div class="ui-text-editor-toolbar-more-btn">
				${0}
				</div>
			`),this.getMoreBtn().render())))}getMoreBtn(){if(babelHelpers.classPrivateFieldLooseBase(this,yp)[yp]===null){const e=()=>{m.Event.unbind(this.getItemsContainer(),"transitionend",e);m.Dom.style(this.getItemsContainer(),{height:null});m.Dom.removeClass(this.getItemsContainer(),"--animating")};babelHelpers.classPrivateFieldLooseBase(this,yp)[yp]=new be;babelHelpers.classPrivateFieldLooseBase(this,yp)[yp].setContent('<span class="ui-text-editor-toolbar-more-btn-icon"></span>');babelHelpers.classPrivateFieldLooseBase(this,yp)[yp].subscribe("onClick",(()=>{m.Event.unbind(this.getItemsContainer(),"transitionend",e);if(m.Dom.hasClass(this.getContainer(),"--expanded")){m.Dom.style(this.getItemsContainer(),{height:`${this.getItemsContainer().scrollHeight}px`});requestAnimationFrame((()=>{m.Dom.removeClass(this.getContainer(),"--expanded");m.Dom.addClass(this.getItemsContainer(),"--animating");m.Dom.style(this.getItemsContainer(),{height:null})}))}else{m.Dom.addClass(this.getItemsContainer(),"--animating");m.Dom.style(this.getItemsContainer(),{height:`${this.getItemsContainer().scrollHeight}px`});m.Dom.addClass(this.getContainer(),"--expanded")}m.Event.bind(this.getItemsContainer(),"transitionend",e)}))}return babelHelpers.classPrivateFieldLooseBase(this,yp)[yp]}getItems(){return babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp]}isRendered(){return babelHelpers.classPrivateFieldLooseBase(this,Fp)[Fp]}destroy(){if(babelHelpers.classPrivateFieldLooseBase(this,Tp)[Tp]!==null){babelHelpers.classPrivateFieldLooseBase(this,Tp)[Tp]()}if(babelHelpers.classPrivateFieldLooseBase(this,Bp)[Bp]!==null){babelHelpers.classPrivateFieldLooseBase(this,Bp)[Bp].disconnect();babelHelpers.classPrivateFieldLooseBase(this,Bp)[Bp]=null}if(this.isRendered()){m.Dom.remove(this.getContainer())}if(babelHelpers.classPrivateFieldLooseBase(this,Cp)[Cp]){clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,Cp)[Cp])}babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp]=null;babelHelpers.classPrivateFieldLooseBase(this,Hp)[Hp]=null}update(){babelHelpers.classPrivateFieldLooseBase(this,mp)[mp].getEditorState().read((()=>{let e=f.$getSelection();if(!f.$isRangeSelection(e)){e=null}let t=null;if(e!==null){t=P.$findMatchingParent(e.anchor.getNode(),(e=>(e.__flags&C)!==0))}const s=e===null?new Set:babelHelpers.classPrivateFieldLooseBase(this,_p)[_p](e);const i=!babelHelpers.classPrivateFieldLooseBase(this,mp)[mp].isEditable();babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp].forEach((r=>{if(!(r instanceof be)){return}if(r.hasOwnDisableCallback()){r.setDisabled(r.invokeDisableCallback())}else if(i){r.disable()}else if(t!==null&&r.shouldDisableInsideUnformatted()){r.disable()}else{r.enable()}if(r.isDisabled()){r.setActive(false)}else if(r.hasFormat()){const t=r.getFormat();r.setActive(e===null?false:e.hasFormat(t))}else if(r.getBlockType()!==null){r.setActive(s.has(r.getBlockType()))}}))}))}reset(){babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp].forEach((e=>{if(e instanceof be){e.setActive(false)}}))}}function Dp(){return P.mergeRegister(babelHelpers.classPrivateFieldLooseBase(this,mp)[mp].registerCommand(f.SELECTION_CHANGE_COMMAND,(()=>{this.update();return false}),f.COMMAND_PRIORITY_CRITICAL),babelHelpers.classPrivateFieldLooseBase(this,mp)[mp].registerCommand(f.FOCUS_COMMAND,(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,Cp)[Cp]){clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,Cp)[Cp]);babelHelpers.classPrivateFieldLooseBase(this,Cp)[Cp]=null}return false}),f.COMMAND_PRIORITY_CRITICAL),babelHelpers.classPrivateFieldLooseBase(this,mp)[mp].registerCommand(f.BLUR_COMMAND,(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,Cp)[Cp]){clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,Cp)[Cp])}babelHelpers.classPrivateFieldLooseBase(this,Cp)[Cp]=setTimeout((()=>{const e=document.activeElement;const t=babelHelpers.classPrivateFieldLooseBase(this,mp)[mp].getScrollerContainer();if(e===null||!t.contains(e)){this.reset()}}),400);return false}),f.COMMAND_PRIORITY_CRITICAL),babelHelpers.classPrivateFieldLooseBase(this,mp)[mp].registerUpdateListener((()=>{this.update()})),babelHelpers.classPrivateFieldLooseBase(this,mp)[mp].registerEditableListener((()=>{this.update()})))}function Rp(e){e.forEach((e=>{if(e==="|"){babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp].push(new pp)}else{const t=babelHelpers.classPrivateFieldLooseBase(this,mp)[mp].getComponentRegistry().create(e);if(t===null){console.warn(`TextEditor Toolbar: "${e}" component doesn't exist.`)}else{babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp].push(t)}}}))}function Ip(e){if(this.getContainer().offsetWidth===0||m.Dom.hasClass(this.getItemsContainer(),"--animating")){return}const t=babelHelpers.classPrivateFieldLooseBase(this,Lp)[Lp].at(-1);if(!t||t.getContainer().offsetTop>=t.getContainer().offsetHeight){m.Dom.addClass(this.getContainer(),"--overflowed")}else{m.Dom.removeClass(this.getContainer(),["--overflowed","--expanded"])}}function xp(e){const t=e.anchor.getNode();const s=new Set;let i=t;while(i!==f.$getRoot()&&i!==null){const e=babelHelpers.classPrivateFieldLooseBase(this,Mp)[Mp](i);s.add(e);i=i.getParent()}return s}function wp(e){if(p.$isListNode(e)){const t=e;const s=P.$getNearestNodeOfType(t,p.ListNode);return s?s.getListType():t.getListType()}if(g.$isLinkNode(e)||g.$isAutoLinkNode(e)){return"link"}if(Te(e)){return"code"}return e.getType()}let Ap=e=>e,$p;var Kp=babelHelpers.classPrivateFieldLooseKey("popup");var jp=babelHelpers.classPrivateFieldLooseKey("toolbar");var kp=babelHelpers.classPrivateFieldLooseKey("showDebounced");var Up=babelHelpers.classPrivateFieldLooseKey("onEditorScroll");var Wp=babelHelpers.classPrivateFieldLooseKey("registerListeners");var Yp=babelHelpers.classPrivateFieldLooseKey("show");var zp=babelHelpers.classPrivateFieldLooseKey("adjustDialogPosition");var Xp=babelHelpers.classPrivateFieldLooseKey("initDialogPosition");var Gp=babelHelpers.classPrivateFieldLooseKey("handleEditorScroll");var Vp=babelHelpers.classPrivateFieldLooseKey("shouldShowDialog");class Jp extends Z{constructor(e){super(e);Object.defineProperty(this,Vp,{value:sg});Object.defineProperty(this,Gp,{value:tg});Object.defineProperty(this,Xp,{value:eg});Object.defineProperty(this,zp,{value:Zp});Object.defineProperty(this,Yp,{value:Qp});Object.defineProperty(this,Wp,{value:qp});Object.defineProperty(this,Kp,{writable:true,value:null});Object.defineProperty(this,jp,{writable:true,value:null});Object.defineProperty(this,kp,{writable:true,value:null});Object.defineProperty(this,Up,{writable:true,value:babelHelpers.classPrivateFieldLooseBase(this,Gp)[Gp].bind(this)});babelHelpers.classPrivateFieldLooseBase(this,kp)[kp]=m.Runtime.debounce((()=>{this.getEditor().update((()=>{if(babelHelpers.classPrivateFieldLooseBase(this,Vp)[Vp]()){babelHelpers.classPrivateFieldLooseBase(this,Yp)[Yp]()}}))}),700)}static getName(){return"FloatingToolbar"}afterInit(){const e=this.getEditor().getOption("floatingToolbar",[]);babelHelpers.classPrivateFieldLooseBase(this,jp)[jp]=new Sp(this.getEditor(),e);if(!babelHelpers.classPrivateFieldLooseBase(this,jp)[jp].isEmpty()){this.cleanUpRegister(babelHelpers.classPrivateFieldLooseBase(this,Wp)[Wp]())}}update(){if(babelHelpers.classPrivateFieldLooseBase(this,Vp)[Vp]()){if(this.getPopup().isShown()){babelHelpers.classPrivateFieldLooseBase(this,Yp)[Yp]()}else{babelHelpers.classPrivateFieldLooseBase(this,kp)[kp]()}}else{this.getPopup().close()}}getPopup(){if(babelHelpers.classPrivateFieldLooseBase(this,Kp)[Kp]===null){const e=m.Tag.render($p||($p=Ap`<div class="ui-text-editor-floating-toolbar"></div>`));babelHelpers.classPrivateFieldLooseBase(this,Kp)[Kp]=new b.Popup({closeByEsc:true,targetContainer:document.body,autoHide:true,content:e,autoHideHandler:e=>{let t=true;const s=window.getSelection();if(s.isCollapsed){return true}this.getEditor().update((()=>{const e=f.$getSelection();t=e===null||e.isCollapsed()}));return t},events:{onShow:()=>{if(babelHelpers.classPrivateFieldLooseBase(this,zp)[zp]()){m.Event.bind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,Up)[Up])}},onClose:()=>{m.Event.unbind(this.getEditor().getScrollerContainer(),"scroll",babelHelpers.classPrivateFieldLooseBase(this,Up)[Up]);Gi(this.getPopup())}}});babelHelpers.classPrivateFieldLooseBase(this,jp)[jp].renderTo(e)}return babelHelpers.classPrivateFieldLooseBase(this,Kp)[Kp]}hide(){if(babelHelpers.classPrivateFieldLooseBase(this,Kp)[Kp]===null){return}this.getPopup().close()}destroy(){super.destroy();if(babelHelpers.classPrivateFieldLooseBase(this,Kp)[Kp]!==null){babelHelpers.classPrivateFieldLooseBase(this,Kp)[Kp].destroy();babelHelpers.classPrivateFieldLooseBase(this,Kp)[Kp]=null}babelHelpers.classPrivateFieldLooseBase(this,jp)[jp].destroy();babelHelpers.classPrivateFieldLooseBase(this,jp)[jp]=null}}function qp(){return P.mergeRegister(this.getEditor().registerCommand(f.SELECTION_CHANGE_COMMAND,(()=>{this.update();return false}),f.COMMAND_PRIORITY_CRITICAL),this.getEditor().registerUpdateListener((({editorState:e})=>{e.read((()=>{this.update()}))})),this.getEditor().registerCommand(L,(()=>{this.hide();return false}),f.COMMAND_PRIORITY_LOW))}function Qp(){this.getPopup().show();Gi(this.getPopup());babelHelpers.classPrivateFieldLooseBase(this,zp)[zp]()}function Zp(){return Xi(this.getPopup(),this.getEditor(),babelHelpers.classPrivateFieldLooseBase(this,Xp)[Xp])}function eg(e){const{isBackward:t,isMultiline:s}=e;return t||!s?"top":"bottom"}function tg(){this.getEditor().update((()=>{babelHelpers.classPrivateFieldLooseBase(this,zp)[zp]()}))}function sg(){if(this.getEditor().isComposing()||!this.getEditor().isEditable()){return false}const e=f.$getSelection();if(!f.$isRangeSelection(e)||e.isCollapsed()){return false}const t=window.getSelection();if(t===null||t.isCollapsed){return false}const s=this.getEditor().getScrollerContainer();if(!s.contains(t.anchorNode)){return false}const i=P.$findMatchingParent(e.anchor.getNode(),(e=>(e.__flags&C)!==0));if(i||e.getTextContent()===""){return false}const r=e.getTextContent().replaceAll("\n","");if(!e.isCollapsed()&&r===""){return false}const a=V(e);const l=a.getParent();if(g.$isLinkNode(l)||g.$isLinkNode(a)){return false}const o=this.getEditor().dispatchCommand(F);if(o){return false}return f.$isTextNode(a)}var ig=Object.freeze({FloatingToolbarPlugin:Jp});var rg=babelHelpers.classPrivateFieldLooseKey("toolbar");class ag extends Z{constructor(...e){super(...e);Object.defineProperty(this,rg,{writable:true,value:null})}static getName(){return"Toolbar"}getToolbar(){return babelHelpers.classPrivateFieldLooseBase(this,rg)[rg]}afterInit(){babelHelpers.classPrivateFieldLooseBase(this,rg)[rg]=new Sp(this.getEditor(),this.getEditor().getOption("toolbar"));if(!babelHelpers.classPrivateFieldLooseBase(this,rg)[rg].isEmpty()){babelHelpers.classPrivateFieldLooseBase(this,rg)[rg].renderTo(this.getEditor().getToolbarContainer())}}destroy(){super.destroy();babelHelpers.classPrivateFieldLooseBase(this,rg)[rg].destroy()}}var lg=Object.freeze({ToolbarPlugin:ag});let og=e=>e,ng;var dg=babelHelpers.classPrivateFieldLooseKey("placeholder");var cg=babelHelpers.classPrivateFieldLooseKey("placeholderNode");var bg=babelHelpers.classPrivateFieldLooseKey("paragraphPlaceholder");var hg=babelHelpers.classPrivateFieldLooseKey("registerPlaceholderListeners");var ug=babelHelpers.classPrivateFieldLooseKey("togglePlaceholder");var pg=babelHelpers.classPrivateFieldLooseKey("hasFocus");var gg=babelHelpers.classPrivateFieldLooseKey("hidePlaceholder");var vg=babelHelpers.classPrivateFieldLooseKey("registerParagraphListeners");class fg extends Z{constructor(...e){super(...e);Object.defineProperty(this,vg,{value:yg});Object.defineProperty(this,gg,{value:Fg});Object.defineProperty(this,pg,{value:Lg});Object.defineProperty(this,ug,{value:mg});Object.defineProperty(this,hg,{value:Pg});Object.defineProperty(this,dg,{writable:true,value:null});Object.defineProperty(this,cg,{writable:true,value:null});Object.defineProperty(this,bg,{writable:true,value:null})}afterInit(){const e=this.getEditor().getOption("placeholder");if(m.Type.isStringFilled(e)){babelHelpers.classPrivateFieldLooseBase(this,dg)[dg]=e;babelHelpers.classPrivateFieldLooseBase(this,cg)[cg]=m.Tag.render(ng||(ng=og`
				<div class="ui-text-editor-placeholder">${0}</div>
			`),m.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,dg)[dg]));m.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,cg)[cg],this.getEditor().getScrollerContainer());babelHelpers.classPrivateFieldLooseBase(this,hg)[hg]()}let t=this.getEditor().getOption("paragraphPlaceholder");if(m.Type.isStringFilled(t)){if(t==="auto"){const e=this.getEditor().getPlugin("Copilot");const s=e!==null&&e.shouldTriggerBySpace();const i=this.getEditor().getPlugin("Mention");const r=i!==null&&i.shouldTriggerByAtSign();if(s&&r){t=m.Loc.getMessage("TEXT_EDITOR_PLACEHOLDER_MENTION_COPILOT")}else if(s){t=m.Loc.getMessage("TEXT_EDITOR_PLACEHOLDER_COPILOT")}else if(r){t=m.Loc.getMessage("TEXT_EDITOR_PLACEHOLDER_MENTION")}}babelHelpers.classPrivateFieldLooseBase(this,bg)[bg]=t;babelHelpers.classPrivateFieldLooseBase(this,vg)[vg]()}}static getName(){return"Placeholder"}}function Pg(){this.cleanUpRegister(this.getEditor().registerUpdateListener((()=>{this.getEditor().getEditorState().read((()=>{babelHelpers.classPrivateFieldLooseBase(this,ug)[ug]()}))})))}function mg(){if(babelHelpers.classPrivateFieldLooseBase(this,dg)[dg]===null){return}let e=v.$canShowPlaceholder(this.getLexicalEditor().isComposing());if(e&&babelHelpers.classPrivateFieldLooseBase(this,bg)[bg]!==null&&babelHelpers.classPrivateFieldLooseBase(this,pg)[pg]()){e=false}if(e){m.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,cg)[cg],"--shown")}else{m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,cg)[cg],"--shown")}}function Lg(){const e=document.activeElement;const t=this.getEditor().getRootElement();return t!==null&&e!==null&&t.contains(e)}function Fg(){if(babelHelpers.classPrivateFieldLooseBase(this,cg)[cg]!==null){m.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,cg)[cg],"--shown")}}function yg(){let e=null;const t=()=>{if(e){const t=this.getEditor().getElementByKey(e.getKey());if(t){delete t.dataset.placeholder}}};this.cleanUpRegister(this.getEditor().registerCommand(f.SELECTION_CHANGE_COMMAND,(()=>{if(!this.getEditor().isEditable()){return false}const s=f.$getSelection();let i=null;if(f.$isRangeSelection(s)&&s.isCollapsed()){const e=s.anchor.getNode();if(f.$isParagraphNode(e)&&f.$isRootNode(e.getParent())&&e.isEmpty()){const t=this.getEditor().getElementByKey(e.getKey());if(t&&babelHelpers.classPrivateFieldLooseBase(this,pg)[pg]()){t.dataset.placeholder=babelHelpers.classPrivateFieldLooseBase(this,bg)[bg];i=e;babelHelpers.classPrivateFieldLooseBase(this,gg)[gg]()}}}if(e&&e!==i){t()}e=i;return false}),f.COMMAND_PRIORITY_CRITICAL),this.getEditor().registerCommand(f.PASTE_COMMAND,(()=>{t();return false}),f.COMMAND_PRIORITY_CRITICAL),this.getEditor().registerCommand(f.BLUR_COMMAND,(()=>{t();babelHelpers.classPrivateFieldLooseBase(this,ug)[ug]();return false}),f.COMMAND_PRIORITY_CRITICAL))}let Hg=e=>e,Bg,Cg,Tg,Og,Eg,Ng,_g,Mg,Sg,Dg;const Rg={COLLAPSED:"collapsed",COLLAPSING:"collapsing",EXPANDED:"expanded",EXPANDING:"expanding"};var Ig=babelHelpers.classPrivateFieldLooseKey("lexicalEditor");var xg=babelHelpers.classPrivateFieldLooseKey("componentRegistry");var wg=babelHelpers.classPrivateFieldLooseKey("refs");var Ag=babelHelpers.classPrivateFieldLooseKey("options");var $g=babelHelpers.classPrivateFieldLooseKey("plugins");var Kg=babelHelpers.classPrivateFieldLooseKey("newLineMode");var jg=babelHelpers.classPrivateFieldLooseKey("bbcodeScheme");var kg=babelHelpers.classPrivateFieldLooseKey("schemeValidation");var Ug=babelHelpers.classPrivateFieldLooseKey("bbcodeImportMap");var Wg=babelHelpers.classPrivateFieldLooseKey("bbcodeExportMap");var Yg=babelHelpers.classPrivateFieldLooseKey("themeClasses");var zg=babelHelpers.classPrivateFieldLooseKey("decoratorNodes");var Xg=babelHelpers.classPrivateFieldLooseKey("decoratorComponents");var Gg=babelHelpers.classPrivateFieldLooseKey("removeListeners");var Vg=babelHelpers.classPrivateFieldLooseKey("highlightContainer");var Jg=babelHelpers.classPrivateFieldLooseKey("autoFocus");var qg=babelHelpers.classPrivateFieldLooseKey("minHeight");var Qg=babelHelpers.classPrivateFieldLooseKey("maxHeight");var Zg=babelHelpers.classPrivateFieldLooseKey("collapsingMode");var ev=babelHelpers.classPrivateFieldLooseKey("collapsingState");var tv=babelHelpers.classPrivateFieldLooseKey("collapsingTransitionEnd");var sv=babelHelpers.classPrivateFieldLooseKey("paragraphHeight");var iv=babelHelpers.classPrivateFieldLooseKey("resizeObserver");var rv=babelHelpers.classPrivateFieldLooseKey("destroying");var av=babelHelpers.classPrivateFieldLooseKey("rendered");var lv=babelHelpers.classPrivateFieldLooseKey("prevEmptyStatus");var ov=babelHelpers.classPrivateFieldLooseKey("initEditorState");var nv=babelHelpers.classPrivateFieldLooseKey("initDecorateNodes");var dv=babelHelpers.classPrivateFieldLooseKey("registerCommands");var cv=babelHelpers.classPrivateFieldLooseKey("initBBCodeImportMap");var bv=babelHelpers.classPrivateFieldLooseKey("initBBCodeExportMap");var hv=babelHelpers.classPrivateFieldLooseKey("initBBCodeScheme");var uv=babelHelpers.classPrivateFieldLooseKey("initCollapsingMode");var pv=babelHelpers.classPrivateFieldLooseKey("handleCollapsingTransition");class gv extends d.EventEmitter{constructor(e){super();Object.defineProperty(this,pv,{value:Hv});Object.defineProperty(this,uv,{value:yv});Object.defineProperty(this,hv,{value:Fv});Object.defineProperty(this,bv,{value:Lv});Object.defineProperty(this,cv,{value:mv});Object.defineProperty(this,dv,{value:Pv});Object.defineProperty(this,nv,{value:fv});Object.defineProperty(this,ov,{value:vv});Object.defineProperty(this,Ig,{writable:true,value:null});Object.defineProperty(this,xg,{writable:true,value:new Xn});Object.defineProperty(this,wg,{writable:true,value:new m.Cache.MemoryCache});Object.defineProperty(this,Ag,{writable:true,value:null});Object.defineProperty(this,$g,{writable:true,value:null});Object.defineProperty(this,Kg,{writable:true,value:T.MIXED});Object.defineProperty(this,jg,{writable:true,value:null});Object.defineProperty(this,kg,{writable:true,value:null});Object.defineProperty(this,Ug,{writable:true,value:void 0});Object.defineProperty(this,Wg,{writable:true,value:void 0});Object.defineProperty(this,Yg,{writable:true,value:{}});Object.defineProperty(this,zg,{writable:true,value:new Set});Object.defineProperty(this,Xg,{writable:true,value:new Map});Object.defineProperty(this,Gg,{writable:true,value:null});Object.defineProperty(this,Vg,{writable:true,value:m.Tag.render(Bg||(Bg=Hg`<div class="ui-text-editor-selection-highlighting"></div>`))});Object.defineProperty(this,Jg,{writable:true,value:false});Object.defineProperty(this,qg,{writable:true,value:null});Object.defineProperty(this,Qg,{writable:true,value:null});Object.defineProperty(this,Zg,{writable:true,value:false});Object.defineProperty(this,ev,{writable:true,value:Rg.EXPANDED});Object.defineProperty(this,tv,{writable:true,value:babelHelpers.classPrivateFieldLooseBase(this,pv)[pv].bind(this)});Object.defineProperty(this,sv,{writable:true,value:null});Object.defineProperty(this,iv,{writable:true,value:null});Object.defineProperty(this,rv,{writable:true,value:false});Object.defineProperty(this,av,{writable:true,value:false});Object.defineProperty(this,lv,{writable:true,value:true});this.setEventNamespace("BX.UI.TextEditor.Editor");const t=m.Type.isPlainObject(e)?e:{};babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag]=new i.SettingsCollection(t);const s=this.constructor.getBuiltinPlugins();const r=babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get("plugins",s);const a=babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get("extraPlugins",[]);const l=babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get("removePlugins",[]);const o=babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get("newLineMode");if([T.LINE_BREAK,T.PARAGRAPH].includes(o)){babelHelpers.classPrivateFieldLooseBase(this,Kg)[Kg]=o}babelHelpers.classPrivateFieldLooseBase(this,Yg)[Yg]=$n;babelHelpers.classPrivateFieldLooseBase(this,$g)[$g]=new Wn(s,[...r,...a],l);const n=babelHelpers.classPrivateFieldLooseBase(this,$g)[$g].getConstructors().map((e=>e.getNodes(this)));babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig]=f.createEditor({namespace:"TextEditor",nodes:n.flat(),onError:e=>{console.error(e)},theme:babelHelpers.classPrivateFieldLooseBase(this,Yg)[Yg],editable:babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get("editable")!==false});this.setMinHeight(t.minHeight);this.setMaxHeight(t.maxHeight);this.setAutoFocus(t.autoFocus);babelHelpers.classPrivateFieldLooseBase(this,Gg)[Gg]=P.mergeRegister(babelHelpers.classPrivateFieldLooseBase(this,dv)[dv](),babelHelpers.classPrivateFieldLooseBase(this,nv)[nv](n.flat()));babelHelpers.classPrivateFieldLooseBase(this,$g)[$g].init(this);babelHelpers.classPrivateFieldLooseBase(this,Ug)[Ug]=babelHelpers.classPrivateFieldLooseBase(this,cv)[cv]();babelHelpers.classPrivateFieldLooseBase(this,Wg)[Wg]=babelHelpers.classPrivateFieldLooseBase(this,bv)[bv]();babelHelpers.classPrivateFieldLooseBase(this,jg)[jg]=babelHelpers.classPrivateFieldLooseBase(this,hv)[hv]();babelHelpers.classPrivateFieldLooseBase(this,kg)[kg]=new ed(this);this.subscribeFromOptions(t.events)}static getBuiltinPlugins(){return[id,Pe,ad,md,dd,pd,eb,rt,Nd,nb,La,Pc,wc,yr,pn,Kl,Mb,Fh,_h,ru,mu,Vu,Jp,ag,fg,gi]}static getDefaultOptions(){return{plugins:[]}}getComponentRegistry(){return babelHelpers.classPrivateFieldLooseBase(this,xg)[xg]}getOptions(){return babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag]}getOption(e,t=null){return babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get(e,t)}getThemeClasses(){return babelHelpers.classPrivateFieldLooseBase(this,Yg)[Yg]}getThemeClass(e){const t=babelHelpers.classPrivateFieldLooseBase(this,Yg)[Yg][e];if(t!==undefined){return t}return""}getNewLineMode(){return babelHelpers.classPrivateFieldLooseBase(this,Kg)[Kg]}getBBCodeScheme(){return babelHelpers.classPrivateFieldLooseBase(this,jg)[jg]}getSchemeValidation(){return babelHelpers.classPrivateFieldLooseBase(this,kg)[kg]}setText(e,t){if(m.Type.isString(e)){const s={discrete:m.Type.isPlainObject(t)&&t.discrete===true};babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].update((()=>{const t=x(e,this);const s=f.$getRoot();s.clear();s.append(...t);f.$setSelection(null)}),s)}}clear(e){const t={discrete:m.Type.isPlainObject(e)&&e.discrete===true};babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].update((()=>{const e=f.$getRoot();const t=f.$createParagraphNode();e.clear();e.append(t);f.$setSelection(null)}),t)}clearHistory(){this.dispatchCommand(f.CLEAR_HISTORY_COMMAND)}getText(){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].getEditorState().read((()=>{const e=W(f.$getRoot(),this);return e.toString()}))}isEmpty(e=true){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].getEditorState().read((()=>An(e)))}setAutoFocus(e){if(m.Type.isBoolean(e)){babelHelpers.classPrivateFieldLooseBase(this,Jg)[Jg]=e}}hasAutoFocus(){return babelHelpers.classPrivateFieldLooseBase(this,Jg)[Jg]}setMinHeight(e){if(m.Type.isNumber(e)&&e>0||e===null){const t=babelHelpers.classPrivateFieldLooseBase(this,qg)[qg]!==e;babelHelpers.classPrivateFieldLooseBase(this,qg)[qg]=e;if(t){m.Dom.style(this.getScrollerContainer(),"--ui-text-editor-min-height",e>0?`${e}px`:null)}}}getMinHeight(){return babelHelpers.classPrivateFieldLooseBase(this,qg)[qg]}setMaxHeight(e){if(m.Type.isNumber(e)&&e>0||e===null){const t=babelHelpers.classPrivateFieldLooseBase(this,Qg)[Qg]!==e;babelHelpers.classPrivateFieldLooseBase(this,Qg)[Qg]=e;if(t){m.Dom.style(this.getScrollerContainer(),"--ui-text-editor-max-height",e>0?`${e}px`:null)}}}getMaxHeight(){return babelHelpers.classPrivateFieldLooseBase(this,Qg)[Qg]}isCollapsingModeEnabled(){return babelHelpers.classPrivateFieldLooseBase(this,Zg)[Zg]}isCollapsed(){return babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]===Rg.COLLAPSED}toggleCollapsing(){if(!this.isCollapsingModeEnabled()){return}m.Event.unbind(this.getRootContainer(),"transitionend",babelHelpers.classPrivateFieldLooseBase(this,tv)[tv]);if(babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]===Rg.COLLAPSED||babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]===Rg.COLLAPSING){babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]=Rg.EXPANDING;this.blur();const e=this.getRootContainer().offsetHeight;m.Dom.removeClass(this.getRootContainer(),["--collapsed","--collapsing"]);m.Dom.style(this.getRootContainer(),{height:`${e}px`,overflow:"hidden"});m.Dom.style(this.getInnerContainer(),{opacity:0});requestAnimationFrame((()=>{m.Dom.addClass(this.getRootContainer(),"--expanding");m.Dom.style(this.getRootContainer(),{height:`${this.getRootContainer().scrollHeight}px`});m.Dom.style(this.getInnerContainer(),{opacity:1});this.emit("onCollapsingToggle",{isOpen:true})}))}else{babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]=Rg.COLLAPSING;const e=this.getRootContainer().offsetHeight;m.Dom.removeClass(this.getRootContainer(),["--expanding"]);m.Dom.style(this.getRootContainer(),{height:`${e}px`,overflow:"hidden"});m.Dom.style(this.getInnerContainer(),{opacity:1});this.blur();const t=this.getParagraphHeight();requestAnimationFrame((()=>{m.Dom.addClass(this.getRootContainer(),"--collapsing");m.Dom.style(this.getRootContainer(),{height:`${t}px`});m.Dom.style(this.getInnerContainer(),{opacity:0});this.emit("onCollapsingToggle",{isOpen:false})}))}m.Event.bind(this.getRootContainer(),"transitionend",babelHelpers.classPrivateFieldLooseBase(this,tv)[tv])}getParagraphHeight(){if(babelHelpers.classPrivateFieldLooseBase(this,sv)[sv]!==null){return babelHelpers.classPrivateFieldLooseBase(this,sv)[sv]}const e=this.getThemeClasses().paragraph||"";const t=m.Tag.render(Cg||(Cg=Hg`<p class="${0}"><br /></p>`),e);m.Dom.style(t,{position:"absolute",transform:"translateY(-1000px)"});m.Dom.append(t,this.getScrollerContainer());babelHelpers.classPrivateFieldLooseBase(this,sv)[sv]=t.offsetHeight+m.Text.toNumber(m.Dom.style(t,"margin-top"))+m.Text.toNumber(m.Dom.style(t,"margin-bottom"));m.Dom.remove(t);return babelHelpers.classPrivateFieldLooseBase(this,sv)[sv]}getLexicalEditor(){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig]}setRootElement(e){if(m.Type.isElementNode(e)||e===null){babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].setRootElement(e)}}getBBCodeExportMap(){return babelHelpers.classPrivateFieldLooseBase(this,Wg)[Wg]}getBBCodeImportMap(){return babelHelpers.classPrivateFieldLooseBase(this,Ug)[Ug]}getEditorState(){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].getEditorState()}getPlugins(){return babelHelpers.classPrivateFieldLooseBase(this,$g)[$g]}getPlugin(e){return babelHelpers.classPrivateFieldLooseBase(this,$g)[$g].get(e)}getElementByKey(e){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].getElementByKey(e)}setEditorState(e,t){babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].setEditorState(e,t)}setEditable(e){if(m.Type.isBoolean(e)){this.dispatchCommand(L);if(!e){this.blur()}babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].setEditable(e)}}isEditable(){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].isEditable()}registerUpdateListener(e){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].registerUpdateListener(e)}registerEditableListener(e){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].registerEditableListener(e)}registerCommand(e,t,s){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].registerCommand(e,t,s)}dispatchCommand(e,t){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].dispatchCommand(e,t)}registerMutationListener(e,t){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].registerMutationListener(e,t)}registerNodeTransform(e,t){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].registerNodeTransform(e,t)}registerTextContentListener(e){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].registerTextContentListener(e)}registerDecoratorListener(e){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].registerDecoratorListener(e)}registerRootListener(e){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].registerRootListener(e)}registerEventListener(e,t,s){const i=["mouseenter","mouseleave"].includes(t);const r=t=>{this.update((()=>{const r=f.$getNearestNodeFromDOMNode(t.target);if(r!==null){const a=i?r instanceof e?r:null:P.$findMatchingParent(r,(t=>t instanceof e));if(a!==null){s(t,a.getKey())}}}))};return this.registerRootListener(((e,s)=>{if(e){m.Event.bind(e,t,r,i)}if(s){m.Event.unbind(s,t,r,i)}}))}update(e,t){babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].update(e,t)}focus(e,t){if(!document.hasFocus()){window.focus()}babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].focus(m.Type.isFunction(e)?e:null,m.Type.isPlainObject(t)?t:undefined)}hasFocus(){return this.getRootElement().contains(document.activeElement)}blur(){babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].blur()}isComposing(){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].isComposing()}getRootElement(){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].getRootElement()}hasNodes(e){return babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].hasNodes(e)}getRootContainer(){return babelHelpers.classPrivateFieldLooseBase(this,wg)[wg].remember("root",(()=>{const e=[this.isEditable()?"--editable":"--read-only"];return m.Tag.render(Tg||(Tg=Hg`
				<div class="ui-text-editor ${0}">
					${0}
				</div>
			`),e.join(" "),this.getInnerContainer())}))}getInnerContainer(){return babelHelpers.classPrivateFieldLooseBase(this,wg)[wg].remember("inner",(()=>m.Tag.render(Og||(Og=Hg`
				<div class="ui-text-editor-inner">
					${0}
					${0}
					${0}
					${0}
				</div>
			`),this.getHeaderContainer(),this.getToolbarContainer(),this.getScrollerContainer(),this.getFooterContainer())))}getToolbarContainer(){return babelHelpers.classPrivateFieldLooseBase(this,wg)[wg].remember("toolbar",(()=>m.Tag.render(Eg||(Eg=Hg`
				<div class="ui-text-editor-toolbar" tabindex="-1"></div>
			`))))}getScrollerContainer(){return babelHelpers.classPrivateFieldLooseBase(this,wg)[wg].remember("scroller",(()=>m.Tag.render(Ng||(Ng=Hg`
				<div class="ui-text-editor-scroller">
					${0}
				</div>
			`),this.getEditableContainer())))}getEditableContainer(){return babelHelpers.classPrivateFieldLooseBase(this,wg)[wg].remember("editable",(()=>m.Tag.render(_g||(_g=Hg`
				<div 
					class="ui-text-editor-editable" 
					contenteditable="${0}" 
					spellcheck="true"
				></div>
			`),this.isEditable()?"true":"false")))}getFooterContainer(){return babelHelpers.classPrivateFieldLooseBase(this,wg)[wg].remember("footer",(()=>m.Tag.render(Mg||(Mg=Hg`
				<div class="ui-text-editor-slot ui-text-editor-footer" tabindex="-1"></div>
			`))))}getHeaderContainer(){return babelHelpers.classPrivateFieldLooseBase(this,wg)[wg].remember("header",(()=>m.Tag.render(Sg||(Sg=Hg`
				<div class="ui-text-editor-slot ui-text-editor-header" tabindex="-1"></div>
			`))))}renderTo(e,t=false){if(!m.Type.isElementNode(e)){return}if(!this.isRendered()){if(m.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get("content"))){this.setText(babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get("content"))}else{babelHelpers.classPrivateFieldLooseBase(this,ov)[ov](babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get("editorState"))}}if(t){m.Dom.replace(e,this.getRootContainer())}else{m.Dom.append(this.getRootContainer(),e)}babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].setRootElement(this.getEditableContainer());if(this.hasAutoFocus()){this.focus(null,{defaultSelection:"rootStart"})}if(!babelHelpers.classPrivateFieldLooseBase(this,av)[av]){babelHelpers.classPrivateFieldLooseBase(this,iv)[iv]=new ResizeObserver((()=>{this.emit("onResize");this.dispatchCommand(L,{context:"resize"})}));babelHelpers.classPrivateFieldLooseBase(this,iv)[iv].observe(this.getScrollerContainer())}babelHelpers.classPrivateFieldLooseBase(this,av)[av]=true}isRendered(){return babelHelpers.classPrivateFieldLooseBase(this,av)[av]}highlightSelection(){this.getEditorState().read((()=>{const e=f.$getSelection();if(!f.$isRangeSelection(e)||e.isCollapsed()){return}const t=e.anchor;const s=e.focus;const i=l.createDOMRange(babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig],t.getNode(),t.offset,s.getNode(),s.offset);if(i!==null){const e=this.getScrollerContainer();const t=e.getBoundingClientRect();const s=l.createRectsFromDOMRange(babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig],i);const r=s.length;babelHelpers.classPrivateFieldLooseBase(this,Vg)[Vg].innerHTML="";for(let i=0;i<r;i++){const r=s[i];const a=m.Tag.render(Dg||(Dg=Hg`<span class="ui-text-editor-selection-part"></span>`));const l=r.top-t.top+e.scrollTop;const o=r.left-t.left+e.scrollLeft;m.Dom.style(a,{top:`${l}px`,left:`${o}px`,height:`${r.height}px`,width:`${r.width}px`});m.Dom.append(a,babelHelpers.classPrivateFieldLooseBase(this,Vg)[Vg])}m.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Vg)[Vg],this.getScrollerContainer())}}))}resetHighlightSelection(){m.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,Vg)[Vg])}destroy(){if(babelHelpers.classPrivateFieldLooseBase(this,rv)[rv]){return}babelHelpers.classPrivateFieldLooseBase(this,rv)[rv]=true;this.emit("onDestroy");for(const[,e]of babelHelpers.classPrivateFieldLooseBase(this,$g)[$g]){e.destroy()}babelHelpers.classPrivateFieldLooseBase(this,Gg)[Gg]();if(this.isRendered()){babelHelpers.classPrivateFieldLooseBase(this,iv)[iv].disconnect();this.setRootElement(null);m.Dom.remove(this.getRootContainer())}babelHelpers.classPrivateFieldLooseBase(this,iv)[iv]=null;babelHelpers.classPrivateFieldLooseBase(this,$g)[$g]=null;babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig]=null;this.$refs=null;babelHelpers.classPrivateFieldLooseBase(this,kg)[kg]=null;babelHelpers.classPrivateFieldLooseBase(this,Ug)[Ug]=null;babelHelpers.classPrivateFieldLooseBase(this,Wg)[Wg]=null;babelHelpers.classPrivateFieldLooseBase(this,zg)[zg]=null;babelHelpers.classPrivateFieldLooseBase(this,Xg)[Xg]=null;Object.setPrototypeOf(this,null)}}function vv(e,t){if(m.Type.isNil(e)){babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].update((()=>{const e=f.$getRoot();if(e.isEmpty()){const t=f.$createParagraphNode();e.append(t)}}),t)}else if(m.Type.isPlainObject(e)||m.Type.isStringFilled(e)){const t=babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].parseEditorState(e);babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].setEditorState(t)}else if(m.Type.isFunction(e)){babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].update((()=>{const t=f.$getRoot();if(t.isEmpty()){e(babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig])}}),t)}}function fv(e){const t=[];e.forEach((e=>{if(e.useDecoratorComponent){const s=this.registerMutationListener(e,((e,t)=>{for(const[t,s]of e){if(s==="destroyed"){const e=babelHelpers.classPrivateFieldLooseBase(this,Xg)[Xg].get(t);if(e){e.destroy()}babelHelpers.classPrivateFieldLooseBase(this,Xg)[Xg].delete(t)}else{babelHelpers.classPrivateFieldLooseBase(this,zg)[zg].add(t)}}}));t.push(s)}}));const s=babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].registerDecoratorListener((e=>{babelHelpers.classPrivateFieldLooseBase(this,zg)[zg].forEach((t=>{const s=e[t];const{componentClass:i,options:r}=s;const a=babelHelpers.classPrivateFieldLooseBase(this,Xg)[Xg].get(t);const l=babelHelpers.classPrivateFieldLooseBase(this,Ig)[Ig].getElementByKey(t);if(l!=null&&l.innerHTML&&a){a.update(r)}else if(l){babelHelpers.classPrivateFieldLooseBase(this,Xg)[Xg].set(t,new i({textEditor:this,target:l,nodeKey:t,options:r}))}}));babelHelpers.classPrivateFieldLooseBase(this,zg)[zg].clear()}));t.push(s);return P.mergeRegister(...t)}function Pv(){return P.mergeRegister(this.registerCommand(f.FOCUS_COMMAND,(()=>{if(this.isCollapsingModeEnabled()&&babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]===Rg.COLLAPSED&&this.isEmpty(false)){this.toggleCollapsing();return true}this.emit("onFocus");return false}),f.COMMAND_PRIORITY_CRITICAL),this.registerCommand(f.BLUR_COMMAND,(e=>{if(this.isCollapsingModeEnabled()&&(babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]===Rg.COLLAPSING||babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]===Rg.EXPANDING)){return true}this.emit("onBlur");return false}),f.COMMAND_PRIORITY_CRITICAL),this.registerUpdateListener((({dirtyElements:e,dirtyLeaves:t,prevEditorState:s,tags:i})=>{const r=this.isComposing();const a=t.size>0||e.size>0;if(r||!a){return}const l=s.isEmpty();if(l&&babelHelpers.classPrivateFieldLooseBase(this,Ag)[Ag].get("collapsingMode")===true){babelHelpers.classPrivateFieldLooseBase(this,uv)[uv]()}if(!l&&i.has("history-merge")){return}this.emit("onChange",{isInitialChange:l,tags:i});const o=this.isEmpty();if(babelHelpers.classPrivateFieldLooseBase(this,lv)[lv]!==o){babelHelpers.classPrivateFieldLooseBase(this,lv)[lv]=o;this.emit("onEmptyContentToggle",{isEmpty:o,isInitialChange:l})}})),this.registerCommand(f.KEY_ENTER_COMMAND,(e=>{const{code:t,ctrlKey:s,metaKey:i}=e;if(m.Browser.isMac()&&i||s){this.emit("onMetaEnter");return true}if(t==="Escape"){this.emit("onEscape");return true}return false}),f.COMMAND_PRIORITY_LOW),this.registerEditableListener((e=>{this.getEditableContainer().contentEditable=e;if(e){m.Dom.removeClass(this.getRootContainer(),"--read-only");m.Dom.addClass(this.getRootContainer(),"--editable")}else{m.Dom.removeClass(this.getRootContainer(),"--editable");m.Dom.addClass(this.getRootContainer(),"--read-only")}this.emit("onEditable",{isEditable:e})})))}function mv(){const e=new Map;for(const[,t]of babelHelpers.classPrivateFieldLooseBase(this,$g)[$g]){const s=t.importBBCode();if(s!==null){Object.keys(s).forEach((t=>{let i=e.get(t);if(i===undefined){i=[];e.set(t,i)}i.push(s[t])}))}}return e}function Lv(){const e=new Map;for(const[,t]of babelHelpers.classPrivateFieldLooseBase(this,$g)[$g]){const s=t.exportBBCode();if(s!==null){Object.keys(s).forEach((t=>{if(m.Type.isFunction(s[t])){e.set(t,s[t])}}))}}return e}function Fv(){const e=this.getPlugin("File");const t=e!=null&&e.isEnabled()?e.getMode():"none";return new r.DefaultBBCodeScheme({fileTag:t})}function yv(){babelHelpers.classPrivateFieldLooseBase(this,Zg)[Zg]=true;if(this.isEmpty()){babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]=Rg.COLLAPSED;m.Dom.addClass(this.getRootContainer(),"--collapsed");this.emit("onCollapsingToggle",{isOpen:false})}else{babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]=Rg.EXPANDED;m.Dom.removeClass(this.getRootContainer(),"--collapsed");this.emit("onCollapsingToggle",{isOpen:true})}}function Hv(){m.Event.unbind(this.getRootContainer(),"transitionend",babelHelpers.classPrivateFieldLooseBase(this,tv)[tv]);m.Dom.style(this.getRootContainer(),{height:null,overflow:null});m.Dom.style(this.getInnerContainer(),{opacity:null});m.Dom.removeClass(this.getRootContainer(),["--expanding","--collapsing"]);if(babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]===Rg.COLLAPSING){m.Dom.addClass(this.getRootContainer(),"--collapsed");babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]=Rg.COLLAPSED;this.clear();this.clearHistory();this.blur()}else{this.focus();babelHelpers.classPrivateFieldLooseBase(this,ev)[ev]=Rg.EXPANDED}}const Bv={name:"TextEditorComponent",props:{editorOptions:{type:Object},editorInstance:{type:gv,default:null},events:{type:Object,default:{}},editable:{type:Boolean,default:null}},provide(){return{editor:this.editor}},beforeCreate(){if(this.editorInstance===null){this.hasOwnEditor=true;this.editor=new gv(this.editorOptions)}else{this.hasOwnEditor=false;this.editor=this.editorInstance}if(m.Type.isPlainObject(this.events)){for(const[e,t]of Object.entries(this.events)){this.editor.subscribe(e,t)}}},computed:{headerContainer(){return this.editor.getHeaderContainer()},footerContainer(){return this.editor.getFooterContainer()}},watch:{editable(e){this.editor.setEditable(e)}},mounted(){this.editor.renderTo(this.$refs.container,true)},unmounted(){if(this.hasOwnEditor){this.editor.destroy();this.editor=null}},template:`\n\t\t<div ref="container"></div>\n\t\t<Teleport :to="headerContainer">\n\t\t\t<slot name="header"></slot>\n\t\t</Teleport>\n\t\t<Teleport :to="footerContainer">\n\t\t\t<slot name="footer"></slot>\n\t\t</Teleport>\n\t`};const Cv={Paragraph:ye,AutoLink:Qc,BlockToolbar:cp,Bold:od,Code:Lt,FloatingToolbar:ig,History:Fu,Image:Er,Italic:bd,Link:Sc,List:ub,Mention:Ua,Quote:Sd,Strikethrough:fd,TabIndent:ib,Toolbar:lg,Underline:Fd,Video:Ln,Spoiler:Zb,Smiley:Wl,Table:Ch,Hashtag:Sh,File:fi};const Tv={...B};const Ov={...O};const Ev={generateContent:In};e.TextEditor=gv;e.TextEditorComponent=Bv;e.BasePlugin=Z;e.Button=be;e.Plugins=Cv;e.Commands=Tv;e.Constants=Ov;e.Debug=Ev})(this.BX.UI.TextEditor=this.BX.UI.TextEditor||{},BX.UI.BBCode,BX.UI.TextEditor,BX.Collections,BX.UI.BBCode,BX.UI.Lexical.RichText,BX.UI.Lexical.Selection,BX.UI.Lexical.Clipboard,BX.UI.Lexical.Table,BX.Event,BX.UI.Lexical.History,BX.Main,BX.Cache,BX,BX.UI.Lexical.List,BX.UI.Lexical.Link,BX.UI.Lexical.Text,BX.UI.Lexical.Core,BX.UI.Lexical.Utils,BX);
//# sourceMappingURL=text-editor.bundle.map.js