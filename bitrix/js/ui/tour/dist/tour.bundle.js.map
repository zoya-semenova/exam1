{"version":3,"file":"tour.bundle.js","sources":["../src/guide-condition-color.js","../src/step.js","../src/guide.js","../src/manager.js"],"sourcesContent":["/**\n * @namespace {BX.UI}\n */\nexport default class GuideConditionColor\n{\n\tstatic WARNING = '--condition-warning';\n\tstatic ALERT = '--condition-alert';\n\tstatic PRIMARY = '--condition-primary';\n}\n","import { Dom, Event, Reflection, Type } from 'main.core';\n\nexport class Step extends Event.EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.target = null;\n\t\tif (\n\t\t\tType.isString(options.target) && options.target !== ''\n\t\t\t|| Type.isFunction(options.target)\n\t\t\t|| Type.isDomNode(options.target)\n\t\t)\n\t\t{\n\t\t\tthis.target = options.target;\n\t\t}\n\n\t\tthis.id = options.id || null;\n\t\tthis.text = options.text;\n\t\tthis.areaPadding = options.areaPadding;\n\t\tthis.link = options.link || '';\n\t\tthis.linkTitle = options.linkTitle || null;\n\t\tthis.rounded = options.rounded || false;\n\t\tthis.title = options.title || null;\n\t\tthis.iconSrc = options.iconSrc || null;\n\t\tthis.article = options.article || null;\n\t\tthis.position = options.position || null;\n\t\tthis.cursorMode = options.cursorMode || false;\n\t\tthis.targetEvent = options.targetEvent || null;\n\t\tthis.buttons = options.buttons || [];\n\t\tthis.condition = options.condition || null;\n\n\t\tconst events = Type.isPlainObject(options.events) ? options.events : {};\n\n\t\tfor (const eventName in events)\n\t\t{\n\t\t\tconst callback = Type.isFunction(events[eventName]) ? events[eventName] : Reflection.getClass(events[eventName]);\n\t\t\tif (callback)\n\t\t\t{\n\t\t\t\tthis.subscribe(this.constructor.getFullEventName(eventName), () => {\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCondition()\n\t{\n\t\treturn this.condition;\n\t}\n\n\tgetTarget()\n\t{\n\t\tif (Type.isString(this.target) && this.target !== '')\n\t\t{\n\t\t\treturn document.querySelector(this.target);\n\t\t}\n\n\t\tif (Type.isFunction(this.target))\n\t\t{\n\t\t\treturn this.target();\n\t\t}\n\n\t\treturn this.target;\n\t}\n\n\tgetTargetPos()\n\t{\n\t\tif (Type.isDomNode(this.target))\n\t\t{\n\t\t\treturn Dom.getPosition(this.target);\n\t\t}\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetButtons()\n\t{\n\t\treturn this.buttons;\n\t}\n\n\tgetAreaPadding()\n\t{\n\t\treturn this.areaPadding;\n\t}\n\n\tgetRounded()\n\t{\n\t\treturn this.rounded;\n\t}\n\n\tgetText()\n\t{\n\t\treturn this.text;\n\t}\n\n\tgetLink()\n\t{\n\t\treturn this.link;\n\t}\n\n\tgetLinkTitle(): ?string\n\t{\n\t\treturn this.linkTitle;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.title;\n\t}\n\n\tgetIconSrc(): ?string\n\t{\n\t\treturn this.iconSrc;\n\t}\n\n\tgetPosition()\n\t{\n\t\treturn this.position;\n\t}\n\n\tgetArticle()\n\t{\n\t\treturn this.article;\n\t}\n\n\tgetCursorMode()\n\t{\n\t\treturn this.cursorMode;\n\t}\n\n\tgetTargetEvent()\n\t{\n\t\treturn this.targetEvent;\n\t}\n\n\tstatic getFullEventName(shortName)\n\t{\n\t\treturn `Step:${shortName}`;\n\t}\n\n\tsetTarget(target)\n\t{\n\t\tthis.target = target;\n\t}\n\n\tinitTargetEvent()\n\t{\n\t\tif (Type.isFunction(this.targetEvent))\n\t\t{\n\t\t\tthis.targetEvent();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getTarget().dispatchEvent(new MouseEvent(this.targetEvent));\n\t}\n}\n","import { Dom, Event, Loc, Reflection, Tag, Text, Type, userOptions } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Popup, PopupWindowButton } from 'main.popup';\n\nimport 'ui.design-tokens';\nimport GuideConditionColor from './guide-condition-color';\nimport { Step } from './step.js';\n\nexport class Guide extends Event.EventEmitter\n{\n\tstatic ConditionColor = GuideConditionColor;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\t/** @var {Step[]}*/\n\t\tthis.steps = [];\n\t\tif (Array.isArray(options.steps))\n\t\t{\n\t\t\toptions.steps.forEach(step => {\n\t\t\t\tthis.steps.push(new Step(step));\n\t\t\t});\n\t\t}\n\n\t\tif (this.steps.length < 1)\n\t\t{\n\t\t\tthrow new Error(\"BX.UI.Tour.Guide: 'steps' argument is required.\");\n\t\t}\n\n\t\tthis.id = \"ui-tour-guide-\" + Text.getRandom();\n\t\tthis.setId(options.id);\n\n\t\tthis.autoSave = false;\n\n\t\tthis.popup = null;\n\t\tthis.layout = {\n\t\t\toverlay: null,\n\t\t\telement: null,\n\t\t\ttitle: null,\n\t\t\ttext: null,\n\t\t\tlink: null,\n\t\t\tcloseIcon: { right : '0', top : '0' },\n\t\t\tbtnContainer: null,\n\t\t\tnextBtn: null,\n\t\t\tbackBtn: null,\n\t\t\tcontent: null,\n\t\t\tfinalContent: null,\n\t\t\tcounter: null,\n\t\t\tcurrentCounter: null,\n\t\t\tcounterItems: []\n\t\t};\n\t\tthis.buttons = options.buttons || \"\";\n\t\tthis.onEvents = options.onEvents || false;\n\t\tthis.currentStepIndex = 0;\n\t\tthis.targetPos = null;\n\t\tthis.clickOnBackBtn = false;\n\t\tthis.helper = top.BX.Helper;\n\t\tthis.targetContainer = Type.isDomNode(options.targetContainer) ? options.targetContainer : null;\n\t\tthis.overlay = Type.isBoolean(options.overlay) ? options.overlay : true;\n\n\t\tthis.finalStep = options.finalStep || false;\n\t\tthis.finalText = options.finalText || \"\";\n\t\tthis.finalTitle = options.finalTitle || \"\";\n\n\t\tthis.simpleMode = options.simpleMode || false;\n\n\t\tthis.setAutoSave(options.autoSave);\n\n\t\tconst events = Type.isPlainObject(options.events) ? options.events : {};\n\t\tfor (let eventName in events)\n\t\t{\n\t\t\tlet cb = Type.isFunction(events[eventName]) ? events[eventName] : Reflection.getClass(events[eventName]);\n\t\t\tif (cb)\n\t\t\t{\n\t\t\t\tthis.subscribe(this.constructor.getFullEventName(eventName), () => {\n\t\t\t\t\tcb();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tEvent.bind(window, \"resize\", this.handleResizeWindow.bind(this));\n\t}\n\n\t/**\n\t * @public\n\t * @returns {string}\n\t */\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tif (Type.isString(id) && id !== '')\n\t\t{\n\t\t\tthis.id = id;\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @returns {Boolean}\n\t */\n\tgetAutoSave()\n\t{\n\t\treturn this.autoSave;\n\t}\n\n\tsetAutoSave(mode)\n\t{\n\t\tif (Type.isBoolean(mode))\n\t\t{\n\t\t\tthis.autoSave = mode;\n\t\t}\n\t}\n\n\tsave()\n\t{\n\t\tconst optionName = \"view_date_\" + this.getId();\n\t\tuserOptions.save(\"ui-tour\", optionName, null, Math.floor(Date.now() / 1000));\n\t\tuserOptions.send(null);\n\t}\n\n\t/**\n\t * @public\n\t */\n\tstart()\n\t{\n\t\tthis.emit(this.constructor.getFullEventName(\"onStart\"), {guide: this});\n\n\t\tif (this.getAutoSave())\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\n\t\tif (this.overlay)\n\t\t{\n\t\t\tthis.setOverlay();\n\t\t}\n\n\t\tconst popup = this.getPopup();\n\t\tpopup.show();\n\n\t\tif (this.popup.getPopupContainer())\n\t\t{\n\t\t\tDom.removeClass(this.popup.getPopupContainer(), \"popup-window-ui-tour-opacity\");\n\t\t}\n\n\n\t\tthis.showStep();\n\n\t\tDom.addClass(this.layout.backBtn, \"ui-tour-popup-btn-hidden\");\n\n\t\tif (this.getCurrentStep().getTarget())\n\t\t{\n\t\t\tDom.addClass(this.getCurrentStep().getTarget(), \"ui-tour-selector\");\n\t\t}\n\n\t}\n\n\t/**\n\t * @public\n\t */\n\tclose()\n\t{\n\t\tif (this.currentStepIndex === this.steps.length && this.onEvents)\n\t\t\treturn;\n\n\t\tthis.closeStep();\n\n\t\tthis.emit(this.constructor.getFullEventName(\"onFinish\"), { guide: this});\n\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.destroy();\n\t\t}\n\n\t\tif (this.layout.cursor)\n\t\t{\n\t\t\tDom.remove(this.layout.cursor);\n\t\t\tthis.layout.cursor = null;\n\t\t}\n\n\t\tif (this.onEvents)\n\t\t{\n\t\t\tthis.increaseCurrentStepIndex();\n\t\t}\n\n\t\tDom.remove(this.layout.overlay);\n\t\tDom.removeClass(document.body, \"ui-tour-body-overflow\");\n\n\t\tif (this.getCurrentStep() && this.getCurrentStep().getTarget())\n\t\t{\n\t\t\tthis.getCurrentStep().getTarget().classList.remove(\"ui-tour-selector\");\n\t\t}\n\n\t\tthis.layout.overlay = null;\n\t\tthis.layout.element = null;\n\t\tthis.layout.title = null;\n\t\tthis.layout.text = null;\n\t\tthis.layout.link = null;\n\t\tthis.layout.btnContainer = null;\n\t\tthis.layout.nextBtn = null;\n\t\tthis.layout.backBtn = null;\n\t\tthis.layout.content = null;\n\t\tthis.layout.finalContent = null;\n\t\tthis.layout.counter = null;\n\t\tthis.layout.currentCounter = null;\n\t\tthis.layout.counterItems = [];\n\t\tthis.popup = null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tshowStep()\n\t{\n\t\tthis.adjustEvents();\n\n\t\tDom.removeClass(this.popup.getPopupContainer(), \"popup-window-ui-tour-opacity\");\n\n\t\tif (this.layout.element)\n\t\t{\n\t\t\tDom.removeClass(this.layout.element, \"ui-tour-overlay-element-opacity\");\n\t\t}\n\n\t\tif (this.layout.backBtn)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.layout.backBtn.style.display = \"block\";\n\t\t\t}, 10);\n\t\t}\n\n\t\tif (this.overlay)\n\t\t{\n\t\t\tthis.setOverlayElementForm();\n\t\t}\n\n\t\tif(this.getCurrentStep())\n\t\t{\n\t\t\tthis.setCoords(this.getCurrentStep().getTarget());\n\t\t}\n\t\tthis.setPopupData();\n\t}\n\n\t/**\n\t * @public\n\t */\n\tshowNextStep()\n\t{\n\t\tif (this.currentStepIndex === this.steps.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getCurrentStep().getCursorMode())\n\t\t{\n\t\t\tthis.showCursor();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst popup = this.getPopup();\n\t\t\tpopup.show();\n\n\t\t\tif (popup.getPopupContainer())\n\t\t\t{\n\t\t\t\tDom.removeClass(popup.getPopupContainer(), \"popup-window-ui-tour-opacity\");\n\t\t\t}\n\n\t\t\tif(this.getCurrentStep())\n\t\t\t{\n\t\t\t\tthis.setCoords(this.getCurrentStep().getTarget());\n\t\t\t}\n\t\t\tthis.setPopupData();\n\t\t}\n\n\t\tthis.adjustEvents();\n\n\t\tif (this.getCurrentStep() && this.getCurrentStep().getTarget())\n\t\t{\n\t\t\tDom.addClass(this.getCurrentStep().getTarget(), 'ui-tour-selector');\n\t\t}\n\t}\n\t/**\n\t * @private\n\t */\n\tadjustEvents()\n\t{\n\t\tlet currentStep = this.getCurrentStep();\n\t\tcurrentStep.emit(currentStep.constructor.getFullEventName(\"onShow\"), {\n\t\t\tstep : currentStep,\n\t\t\tguide: this\n\t\t});\n\n\t\tif (currentStep.getTarget())\n\t\t{\n\t\t\tlet close = this.close.bind(this);\n\t\t\tconst clickEvent = (e) => {\n\t\t\t\tif (e.isTrusted) {\n\t\t\t\t\tclose();\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit('UI.Tour.Guide:clickTarget', this);\n\t\t\t\tEvent.unbind(currentStep.getTarget(), 'click', clickEvent);\n\t\t\t};\n\n\t\t\tEvent.bind(currentStep.getTarget(), 'click', clickEvent);\n\n\t\t\tthis.subscribe('UI.Tour.Guide:onFinish', () => {\n\t\t\t\tEvent.unbind(currentStep.getTarget(), 'click', close);\n\t\t\t});\n\n\t\t\tconst targetPosWindow = Dom.getPosition(currentStep.getTarget());\n\t\t\tif (!this.isTargetVisible(targetPosWindow))\n\t\t\t{\n\t\t\t\tthis.scrollToTarget(targetPosWindow);\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * @private\n\t */\n\tcloseStep()\n\t{\n\t\tconst currentStep = this.getCurrentStep();\n\t\tif (currentStep)\n\t\t{\n\t\t\tcurrentStep.emit(currentStep.constructor.getFullEventName(\"onClose\"), {\n\t\t\t\tstep : currentStep,\n\t\t\t\tguide: this\n\t\t\t});\n\n\t\t\tconst target = currentStep.getTarget();\n\t\t\tif (target)\n\t\t\t{\n\t\t\t\tDom.removeClass(target, \"ui-tour-selector\")\n\t\t\t}\n\t\t}\n\t}\n\n\tsetPopupPosition()\n\t{\n\t\tif (!this.getCurrentStep().getTarget()\n\t\t\t|| this.targetPos === null\n\t\t\t|| this.getCurrentStep().getPosition() === 'center')\n\t\t{\n\t\t\tthis.getPopup().setBindElement(null);\n\t\t\tthis.getPopup().setOffset({ offsetLeft: 0, offsetTop: 0});\n\t\t\tthis.getPopup().setAngle(false);\n\t\t\tthis.getPopup().adjustPosition();\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet offsetLeft = 0;\n\t\tlet offsetTop = -15;\n\t\tlet angleOffset = 0;\n\t\tlet anglePosition = \"top\";\n\n\t\tconst bindOptions = {\n\t\t\tforceTop: true,\n\t\t\tforceLeft: true,\n\t\t\tforceBindPosition: true\n\t\t};\n\n\t\tconst popupWidth = this.getPopup().getPopupContainer().offsetWidth;\n\t\tconst clientWidth = document.documentElement.clientWidth;\n\n\t\tif (this.getCurrentStep().getPosition() === \"right\")\n\t\t{\n\t\t\tanglePosition = \"left\";\n\t\t\toffsetLeft = this.targetPos.width + 30;\n\t\t\toffsetTop = this.targetPos.height + this.getAreaPadding();\n\n\t\t\tif ((this.targetPos.left + offsetLeft + popupWidth) > clientWidth)\n\t\t\t{\n\t\t\t\tlet left = this.targetPos.left - popupWidth;\n\t\t\t\tif (left > 0)\n\t\t\t\t{\n\t\t\t\t\toffsetLeft = -popupWidth - 30;\n\t\t\t\t\tanglePosition = \"right\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (this.getCurrentStep().getPosition() === \"left\")\n\t\t{\n\t\t\tanglePosition = \"right\";\n\t\t\toffsetLeft = - this.targetPos.width - (popupWidth - this.targetPos.width) - 40;\n\t\t\toffsetTop = this.targetPos.height + this.getAreaPadding();\n\n\t\t\tif ((this.targetPos.right + offsetLeft + popupWidth) < clientWidth)\n\t\t\t{\n\t\t\t\tlet left =  this.targetPos.left - popupWidth;\n\t\t\t\tif (left < 0)\n\t\t\t\t{\n\t\t\t\t\toffsetLeft = this.targetPos.width  + 40;\n\t\t\t\t\tanglePosition = \"left\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse // top || bottom\n\t\t{\n\t\t\tbindOptions.forceLeft = false;\n\t\t\tbindOptions.forceTop = false;\n\n\t\t\tif (this.getCurrentStep().getRounded())\n\t\t\t{\n\t\t\t\tif (!this.onEvents)\n\t\t\t\t{\n\t\t\t\t\toffsetTop = - (this.layout.element.getAttribute(\"r\") - this.targetPos.height / 2 + 10);\n\t\t\t\t}\n\t\t\t\tangleOffset = 0;\n\t\t\t\toffsetLeft = this.targetPos.width / 2;\n\t\t\t}\n\t\t\telse if (this.targetPos.width < 30)\n\t\t\t{\n\t\t\t\toffsetLeft = this.targetPos.width / 2;\n\t\t\t\toffsetTop = -15;\n\t\t\t\tangleOffset = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\toffsetLeft = 25;\n\n\t\t\t\tif (!this.onEvents)\n\t\t\t\t{\n\t\t\t\t\toffsetTop = - (this.layout.element.getAttribute(\"height\") / 2 - this.targetPos.height / 2 + 10);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\toffsetTop = 0;\n\t\t\t\t}\n\n\t\t\t\tangleOffset = 0;\n\t\t\t}\n\t\t}\n\n\t\tlet bindElement = this.getCurrentStep().getTarget();\n\n\t\tif(this.getCurrentStep().getPosition() === 'center')\n\t\t\tbindElement = window;\n\n\t\tthis.getPopup().setBindElement(bindElement);\n\t\tthis.getPopup().setOffset({offsetLeft: offsetLeft, offsetTop: -offsetTop});\n\t\tthis.getPopup().setAngle({position: anglePosition, offset: angleOffset});\n\t\tthis.getPopup().adjustPosition(bindOptions);\n\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetOverlay()\n\t{\n\t\tthis.layout.overlay = Tag.render`\n\t\t\t<svg class=\"ui-tour-overlay\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" preserveAspectRatio=\"none\">\n\t\t\t\t<mask id=\"hole\">\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<filter id=\"ui-tour-filter\">\n\t\t\t\t\t\t\t<feGaussianBlur stdDeviation=\"0\"/>\n\t\t\t\t\t\t</filter>\n\t\t\t\t\t</defs>\n\t\t\t\t\t<rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill=\"white\"></rect>\n\t\t\t\t\t<rect id=\"rect\" class=\"ui-tour-overlay-element ui-tour-overlay-element-rect\" x=\"1035.5\" y=\"338\" width=\"422\" rx=\"2\" ry=\"2\" height=\"58\" filter=\"url(#ui-tour-filter)\"></rect>\n\t\t\t\t\t<circle id=\"circle\" class=\"ui-tour-overlay-element ui-tour-overlay-element-circle\" cx=\"10\" cy=\"10\" r=\"10\" filter=\"url(#ui-tour-filter)\"></circle>\n\t\t\t\t</mask>\n\t\t\t\t<rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill=\"#000\" mask=\"url(#hole)\"></rect>\n\t\t\t</svg>\n\t\t`;\n\n\t\tDom.addClass(document.body, 'ui-tour-body-overflow');\n\t\tif (this.targetContainer)\n\t\t{\n\t\t\tDom.append(this.layout.overlay, this.targetContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(this.layout.overlay, document.body);\n\t\t}\n\n\t\tthis.setOverlayElementForm();\n\t}\n\n\tsetOverlayElementForm()\n\t{\n\t\tif (this.getCurrentStep().getRounded())\n\t\t{\n\t\t\tthis.layout.overlay.querySelector(\".ui-tour-overlay-element-rect\").style.display = \"none\";\n\t\t\tthis.layout.overlay.querySelector(\".ui-tour-overlay-element-circle\").style.display = \"block\";\n\t\t\tthis.layout.element = this.layout.overlay.querySelector(\".ui-tour-overlay-element-circle\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.layout.overlay.querySelector(\".ui-tour-overlay-element-circle\").style.display = \"none\";\n\t\t\tthis.layout.overlay.querySelector(\".ui-tour-overlay-element-rect\").style.display = \"block\";\n\t\t\tthis.layout.element = this.layout.overlay.querySelector(\".ui-tour-overlay-element-rect\");\n\t\t}\n\n\t\treturn this.layout.element;\n\t}\n\n\thandleResizeWindow()\n\t{\n\t\tif (this.layout.element && this.getCurrentStep())\n\t\t{\n\t\t\tthis.setCoords(this.getCurrentStep().getTarget());\n\t\t}\n\n\t}\n\n\t/**\n\t * @private\n\t * @param {Element} node\n\t */\n\tsetCoords(node)\n\t{\n\t\tif (!node)\n\t\t{\n\t\t\tif(this.layout.element)\n\t\t\t{\n\t\t\t\tthis.layout.element.style.display = \"none\";\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tthis.targetPos = node.getBoundingClientRect();\n\n\t\tif (this.layout.element)\n\t\t{\n\t\t\tthis.layout.element.style.display = \"block\";\n\n\t\t\tif (this.getCurrentStep().getRounded())\n\t\t\t{\n\t\t\t\tthis.layout.element.setAttribute('cx', this.targetPos.left + this.targetPos.width / 2);\n\t\t\t\tthis.layout.element.setAttribute('cy', this.targetPos.top + this.targetPos.height / 2);\n\t\t\t\tthis.layout.element.setAttribute('r', this.targetPos.width / 2 + this.getAreaPadding());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.layout.element.setAttribute('x', this.targetPos.left - this.getAreaPadding());\n\t\t\t\tthis.layout.element.setAttribute('y', this.targetPos.top - this.getAreaPadding());\n\t\t\t\tthis.layout.element.setAttribute('width', this.targetPos.width + this.getAreaPadding()*2);\n\t\t\t\tthis.layout.element.setAttribute('height', this.targetPos.height + this.getAreaPadding()*2);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAreaPadding()\n\t{\n\t\tlet padding = 15;\n\t\tif (this.getCurrentStep().getAreaPadding() >= 0)\n\t\t{\n\t\t\tpadding = this.getCurrentStep().getAreaPadding();\n\t\t}\n\n\t\treturn padding;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tincreaseCurrentStepIndex()\n\t{\n\t\tthis.currentStepIndex++;\n\n\t\tif (this.currentStepIndex + 1 === this.steps.length && !this.finalStep && !this.onEvents)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.layout.nextBtn.textContent = Loc.getMessage(\"JS_UI_TOUR_BUTTON_CLOSE\");\n\t\t\t}, 200);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\treduceCurrentStepIndex()\n\t{\n\t\tif (this.currentStepIndex === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.currentStepIndex < this.steps.length && !this.finalStep)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.layout.nextBtn.textContent = Loc.getMessage(\"JS_UI_TOUR_BUTTON\");\n\t\t\t}, 200);\n\t\t}\n\n\t\tthis.currentStepIndex--;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tgetPopup()\n\t{\n\t\tif (!this.popup)\n\t\t{\n\t\t\tlet bindElement = this.getCurrentStep()\n\t\t\t\t? this.getCurrentStep().getTarget()\n\t\t\t\t: window;\n\n\t\t\tlet className = 'popup-window-ui-tour popup-window-ui-tour-opacity';\n\n\t\t\tif (this.getCurrentStep().getCondition())\n\t\t\t{\n\t\t\t\tif (Type.isString(this.getCurrentStep().getCondition()))\n\t\t\t\t{\n\t\t\t\t\tclassName = className + ' --condition-' + this.getCurrentStep().getCondition().toLowerCase();\n\t\t\t\t}\n\n\t\t\t\tif (Type.isObject(this.getCurrentStep().getCondition()))\n\t\t\t\t{\n\t\t\t\t\tclassName = className + ' --condition-' + this.getCurrentStep().getCondition()?.color.toLowerCase();\n\t\t\t\t}\n\n\t\t\t\tif (this.getCurrentStep().getCondition()?.top !== false)\n\t\t\t\t{\n\t\t\t\t\tclassName = className + ' --condition';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.onEvents\n\t\t\t\t? className = className + ' popup-window-ui-tour-animate'\n\t\t\t\t: null;\n\n\t\t\tlet buttons = [];\n\n\t\t\tif(this.getCurrentStep() && this.getCurrentStep().getButtons().length > 0)\n\t\t\t{\n\t\t\t\tthis.getCurrentStep().getButtons().forEach((item)=> {\n\t\t\t\t\tbuttons.push(new PopupWindowButton({\n\t\t\t\t\t\ttext: item.text,\n\t\t\t\t\t\tclassName: 'ui-btn ui-btn-sm ui-btn-primary ui-btn-round',\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: Type.isFunction(item.event) ? item.event : null\n\t\t\t\t\t\t}\n\t\t\t\t\t}))\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tconst popupWidth = this.onEvents ? 280 : 420;\n\n\t\t\tthis.popup = new Popup({\n\t\t\t\ttargetContainer: this.targetContainer,\n\t\t\t\tcontent: this.getContent(),\n\t\t\t\tbindElement: bindElement,\n\t\t\t\tclassName: className,\n\t\t\t\tautoHide: this.onEvents ? false : true,\n\t\t\t\toffsetTop: 15,\n\t\t\t\twidth: popupWidth,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceTop: true,\n\t\t\t\t\tforceLeft: true,\n\t\t\t\t\tforceBindPosition: true\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose : (popup) => {\n\t\t\t\t\t\tif(popup.destroyed === false && this.onEvents)\n\t\t\t\t\t\t\tEventEmitter.emit('UI.Tour.Guide:onPopupClose', this);\n\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbuttons: buttons\n\t\t\t});\n\n\t\t\tconst conditionNodeTop = Tag.render`\n\t\t\t\t<div class=\"ui-tour-popup-condition-top\">\n\t\t\t\t\t<div class=\"ui-tour-popup-condition-angle\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst conditionNodeBottom = Tag.render`\n\t\t\t\t<div class=\"ui-tour-popup-condition-bottom\"></div>\n\t\t\t`;\n\n\t\t\tif (Type.isString(this.getCurrentStep().getCondition()))\n\t\t\t{\n\t\t\t\tDom.append(conditionNodeTop, this.popup.getContentContainer());\n\t\t\t}\n\n\t\t\tif (Type.isObject(this.getCurrentStep().getCondition()))\n\t\t\t{\n\t\t\t\tif (this.getCurrentStep().getCondition()?.top !== false)\n\t\t\t\t{\n\t\t\t\t\tDom.append(conditionNodeTop, this.popup.getContentContainer());\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif (this.getCurrentStep().getCondition()?.bottom !== false)\n\t\t\t{\n\t\t\t\tDom.append(conditionNodeBottom, this.popup.getContentContainer());\n\t\t\t}\n\t\t}\n\n\t\treturn this.popup;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetContent()\n\t{\n\t\tif (!this.layout.content)\n\t\t{\n\t\t\tlet iconNode = '';\n\t\t\tif (this.getCurrentStep().getIconSrc())\n\t\t\t{\n\t\t\t\ticonNode = Tag.render`\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-tour-popup-icon\"\n\t\t\t\t\t\tstyle=\"background-image: url(${encodeURI(this.getCurrentStep().getIconSrc())});\"\n\t\t\t\t\t></div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\tlet linkNode = '';\n\t\t\tif(this.getCurrentStep().getLink() || this.getCurrentStep().getArticle())\n\t\t\t{\n\t\t\t\tlinkNode = this.getLink();\n\t\t\t}\n\n\t\t\tthis.layout.content = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-tour-popup ${this.simpleMode ? 'ui-tour-popup-simple' : ''} ${this.onEvents ? 'ui-tour-popup-events' : ''}\"\n\t\t\t\t\tstyle=\"${iconNode ? 'padding-left: 13px;' : ''};\"\n\t\t\t\t>\n\t\t\t\t\t${iconNode}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t${this.getTitle()}\n\t\t\t\t\t\t<div class=\"ui-tour-popup-content\">\n\t\t\t\t\t\t\t${this.getText()}\n\t\t\t\t\t\t\t${linkNode}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${linkNode}\n\t\t\t\t\t\t<div class=\"ui-tour-popup-footer\">\n\t\t\t\t\t\t\t<div class=\"ui-tour-popup-index\">\n\t\t\t\t\t\t\t\t${this.onEvents ? '' : this.getCounterItems()}\n\t\t\t\t\t\t\t\t${this.onEvents ? '' : this.getCurrentCounter()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t${this.onEvents ? '' : this.getBtnContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.content;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetPopupData()\n\t{\n\t\tEvent.unbindAll(this.layout.link, 'click');\n\n\t\tthis.getTitle().innerHTML = this.getCurrentStep().getTitle();\n\t\tthis.getText().innerHTML = this.getCurrentStep().getText();\n\n\t\tif (this.getCurrentStep().getArticle() || this.getCurrentStep().getLink())\n\t\t{\n\t\t\tDom.removeClass(this.layout.link,  \"ui-tour-popup-link-hide\");\n\n\t\t\tif (this.getCurrentStep().getArticle())\n\t\t\t{\n\t\t\t\tEvent.bind(this.layout.link, \"click\", this.handleClickLink.bind(this));\n\t\t\t}\n\n\t\t\tif (this.getCurrentStep().getLink())\n\t\t\t{\n\t\t\t\tthis.getLink().setAttribute('href', this.getCurrentStep().getLink());\n\t\t\t}\n\n\t\t}\n\t\telse {\n\t\t\tDom.addClass(this.layout.link,  \"ui-tour-popup-link-hide\");\n\t\t}\n\n\t\tthis.getCurrentCounter().textContent = Loc.getMessage(\"JS_UI_TOUR_STEP_INDEX_TEXT\")\n\t\t\t.replace('#NUMBER#', this.currentStepIndex + 1)\n\t\t\t.replace('#NUMBER_TOTAL#', this.steps.length);\n\n\t\tfor (let i = 0; i < this.steps.length; i++)\n\t\t{\n\t\t\tif (this.layout.counterItems[i])\n\t\t\t{\n\t\t\t\tDom.removeClass(this.layout.counterItems[i], 'ui-tour-popup-index-item-current');\n\t\t\t\tDom.removeClass(this.layout.counterItems[i], 'ui-tour-popup-index-item-passed');\n\t\t\t}\n\n\t\t\tif (i === this.currentStepIndex)\n\t\t\t{\n\t\t\t\tDom.addClass(this.layout.counterItems[i], 'ui-tour-popup-index-item-current');\n\t\t\t}\n\t\t\telse if (i < this.currentStepIndex)\n\t\t\t{\n\t\t\t\tDom.addClass(this.layout.counterItems[i], 'ui-tour-popup-index-item-passed')\n\t\t\t}\n\t\t}\n\n\t\tthis.setPopupPosition();\n\t}\n\n\t/**\n\t * @public\n\t */\n\thandleClickLink()\n\t{\n\t\tevent.preventDefault();\n\n\t\tif(!this.helper)\n\t\t{\n\t\t\tthis.helper = top.BX.Helper;\n\t\t}\n\n\t\tthis.helper.show(\"redirect=detail&code=\" + this.getCurrentStep().getArticle());\n\n\t\tif(this.onEvent)\n\t\t{\n\t\t\tif(this.helper.isOpen())\n\t\t\t\tthis.getPopup().setAutoHide(false);\n\n\t\t\tEventEmitter.subscribe(this.helper.getSlider(), 'SidePanel.Slider:onCloseComplete', () => {\n\t\t\t\tthis.getPopup().setAutoHide(true);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t */\n\tgetTitle()\n\t{\n\t\tif (this.layout.title === null)\n\t\t{\n\t\t\tthis.layout.title = Tag.render`\n\t\t\t\t<div class=\"ui-tour-popup-title\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.title;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tgetText()\n\t{\n\t\tif (this.layout.text === null)\n\t\t{\n\t\t\tthis.layout.text = Tag.render`\n\t\t\t\t<div class=\"ui-tour-popup-text\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.text;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tgetLink()\n\t{\n\t\tif (!this.layout.link)\n\t\t{\n\t\t\tconst title = this.steps[this.currentStepIndex].getLinkTitle() ?? Loc.getMessage('JS_UI_TOUR_LINK');\n\t\t\tthis.layout.link = Tag.render`\n\t\t\t\t<a target=\"_blank\" href=\"\" class=\"ui-tour-popup-link\">\n\t\t\t\t\t${title}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.link;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tgetCurrentCounter()\n\t{\n\t\tif (this.layout.currentCounter === null)\n\t\t{\n\t\t\tthis.layout.currentCounter = Tag.render`\n\t\t\t\t<span class=\"ui-tour-popup-counter\">\n\t\t\t\t\t${Loc.getMessage(\"JS_UI_TOUR_STEP_INDEX_TEXT\")\n\t\t\t\t\t\t.replace('#NUMBER#', this.currentStepIndex + 1)\n\t\t\t\t\t\t.replace('#NUMBER_TOTAL#', this.steps.length)}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.currentCounter;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetBtnContainer()\n\t{\n\t\tif (this.layout.btnContainer === null)\n\t\t{\n\t\t\tthis.layout.btnContainer = Tag.render`\n\t\t\t\t<div class=\"ui-tour-popup-btn-block\"></div>\n\t\t\t`;\n\n\t\t\tthis.layout.nextBtn = Tag.render`\n\t\t\t\t<button id=\"next\" class=\"ui-tour-popup-btn-next\">\n\t\t\t\t\t${this.simpleMode ? Loc.getMessage(\"JS_UI_TOUR_BUTTON_SIMPLE\") : Loc.getMessage(\"JS_UI_TOUR_BUTTON\")}\n\t\t\t\t</button>\n\t\t\t`;\n\n\n\t\t\tthis.layout.backBtn = Tag.render`\n\t\t\t\t<button id=\"back\" class=\"ui-tour-popup-btn-back\">\n\t\t\t\t</button>\n\t\t\t`;\n\n\t\t\tDom.append(this.layout.backBtn, this.layout.btnContainer);\n\t\t\tDom.append(this.layout.nextBtn, this.layout.btnContainer);\n\n\t\t\tEvent.bind(this.layout.nextBtn, \"click\", this.handleClickOnNextBtn.bind(this));\n\t\t\tEvent.bind(this.layout.backBtn, \"click\", this.handleClickOnBackBtn.bind(this));\n\n\t\t}\n\n\t\treturn this.layout.btnContainer;\n\t}\n\n\tgetCounterItems()\n\t{\n\t\tif (this.layout.counter === null)\n\t\t{\n\t\t\tthis.layout.counter = Tag.render`\n\t\t\t\t<span class=\"ui-tour-popup-index-items\">\n\t\t\t\t</span>\n\t\t\t`;\n\t\t}\n\n\t\tthis.layout.counterItems = [];\n\n\t\tfor (let i = 0; i < this.steps.length; i++)\n\t\t{\n\t\t\tconst currentStepIndex = Tag.render`\n\t\t\t\t<span class=\"ui-tour-popup-index-item\">\n\t\t\t\t</span>\n\t\t\t`;\n\n\t\t\tthis.layout.counterItems.push(currentStepIndex);\n\t\t\tDom.append(currentStepIndex, this.layout.counter);\n\t\t}\n\n\t\treturn this.layout.counter;\n\t}\n\n\t/**\n\t * @returns {Step}\n\t */\n\tgetCurrentStep()\n\t{\n\t\treturn this.steps[this.currentStepIndex];\n\t}\n\n\t/**\n\t * @returns {Step}\n\t */\n\tgetPreviousStep()\n\t{\n\t\tif (this.steps[this.currentStepIndex - 1])\n\t\t{\n\t\t\treturn this.steps[this.currentStepIndex - 1];\n\t\t}\n\t}\n\n\thandleClickOnNextBtn()\n\t{\n\t\tDom.addClass(this.layout.element, \"ui-tour-overlay-element-opacity\");\n\t\tDom.addClass(this.popup.getPopupContainer(), \"popup-window-ui-tour-opacity\");\n\n\t\tthis.clickOnBackBtn = false;\n\t\tif (this.getCurrentStep())\n\t\t{\n\t\t\tthis.closeStep();\n\t\t}\n\n\t\tthis.increaseCurrentStepIndex();\n\n\t\tif (this.getCurrentStep() && this.getCurrentStep().getTarget())\n\t\t{\n\t\t\tDom.addClass(this.getCurrentStep().getTarget(), 'ui-tour-selector');\n\t\t}\n\n\t\tif (this.currentStepIndex === this.steps.length)\n\t\t{\n\t\t\tif (this.finalStep)\n\t\t\t{\n\t\t\t\tthis.setFinalStep()\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.showStep();\n\t\t\t}, 200);\n\n\t\t\tif (Dom.hasClass(this.layout.backBtn, 'ui-tour-popup-btn-hidden'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.layout.backBtn, 'ui-tour-popup-btn-hidden');\n\t\t\t}\n\t\t}\n\n\t}\n\n\thandleClickOnBackBtn()\n\t{\n\t\tDom.addClass(this.layout.element, \"ui-tour-overlay-element-opacity\");\n\t\tDom.addClass(this.popup.getPopupContainer(), \"popup-window-ui-tour-opacity\");\n\n\t\tthis.closeStep();\n\t\tthis.reduceCurrentStepIndex();\n\n\t\tif (this.currentStepIndex === 0)\n\t\t{\n\t\t\tDom.addClass(this.layout.backBtn, 'ui-tour-popup-btn-hidden');\n\t\t}\n\n\t\tthis.clickOnBackBtn = true;\n\t\tsetTimeout(() => {\n\t\t\tthis.layout.backBtn.style.display = \"none\";\n\t\t\tthis.showStep();\n\t\t}, 200);\n\n\t\tif (this.getCurrentStep().getTarget())\n\t\t{\n\t\t\tDom.addClass(this.getCurrentStep().getTarget(), 'ui-tour-selector');\n\t\t}\n\t}\n\n\tsetFinalStep()\n\t{\n\t\tthis.layout.element.style.display = \"none\";\n\t\tthis.getPopup().destroy();\n\n\t\tconst finalPopup = this.getFinalPopup();\n\t\tfinalPopup.show();\n\t\tDom.addClass(finalPopup.getPopupContainer(), \"popup-window-ui-tour-final-show\");\n\t}\n\n\t/**\n\t * @public\n\t */\n\tgetFinalPopup()\n\t{\n\t\tthis.popup = new Popup({\n\t\t\tcontent: this.getFinalContent(),\n\t\t\tclassName: 'popup-window-ui-tour-final',\n\t\t\toffsetTop: this.onEvents ? 0 : 15,\n\t\t\toffsetLeft: 35,\n\t\t\tmaxWidth: 430,\n\t\t\tminWidth: 300\n\t\t});\n\n\t\treturn this.popup;\n\t}\n\n\tgetFinalContent()\n\t{\n\t\tif (!this.layout.finalContent)\n\t\t{\n\t\t\tthis.layout.finalContent = Tag.render`\n\t\t\t\t<div class=\"ui-tour-popup --final\">\n\t\t\t\t\t<div class=\"ui-tour-popup-title\">\n\t\t\t\t\t\t${this.finalTitle}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-tour-popup-content\">\n\t\t\t\t\t\t<div class=\"ui-tour-popup-text\">\n\t\t\t\t\t\t\t${this.finalText}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-tour-popup-footer-btn\">\n\t\t\t\t\t\t${this.getFinalBtn()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.finalContent;\n\t}\n\n\tgetFinalBtn()\n\t{\n\t\tconst buttons = [];\n\n\t\tif (this.buttons !== \"\")\n\t\t{\n\t\t\tfor (let i = 0; i < this.buttons.length; i++)\n\t\t\t{\n\t\t\t\tlet btn = Tag.render`\n\t\t\t\t\t<button class=\"${this.buttons[i].class}\" onclick=\"${this.buttons[i].events.click}\">\n\t\t\t\t\t${this.buttons[i].text}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\n\t\t\t\tbuttons.push(btn);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet btn = Tag.render`\n\t\t\t\t<button class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-round\" onclick=\"${this.close.bind(this)}\">\n\t\t\t\t${Loc.getMessage(\"JS_UI_TOUR_BUTTON_CLOSE\")}\n\t\t\t\t</button>\n\t\t\t`;\n\n\t\t\tbuttons.push(btn);\n\t\t}\n\n\t\treturn buttons;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tisTargetVisible(node)\n\t{\n\t\treturn (\n\t\t\tnode.top >= 0 &&\n\t\t\tnode.left >= 0 &&\n\t\t\tnode.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n\t\t\tnode.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tscrollToTarget(target)\n\t{\n\t\twindow.scrollTo(0, target.y - this.getAreaPadding());\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic getFullEventName(shortName)\n\t{\n\t\treturn \"UI.Tour.Guide:\" + shortName;\n\t}\n\n\tshowCursor()\n\t{\n\t\tthis.setCursorPos();\n\n\t\tsetTimeout(() => {\n\t\t\tthis.animateCursor();\n\t\t}, 1000);\n\t}\n\n\tgetCursor()\n\t{\n\t\tif (!this.layout.cursor)\n\t\t{\n\t\t\tthis.layout.cursor = Tag.render`\n\t\t\t\t<div class=\"ui-tour-cursor\"></div>\n\t\t\t`;\n\t\t\tEvent.bind(this.layout.cursor, 'transitionend', () => {\n\t\t\t\tthis.getCurrentStep().initTargetEvent();\n\t\t\t});\n\t\t\tDom.append(this.layout.cursor, document.body);\n\t\t}\n\n\t\treturn this.layout.cursor;\n\t}\n\n\tsetCursorPos()\n\t{\n\t\tconst targetPos = this.getCurrentStep().getTargetPos();\n\n\t\tlet left = targetPos.left + targetPos.width / 2;\n\n\t\tif (left < 0)\n\t\t{\n\t\t\tleft = 0;\n\t\t}\n\n\t\tthis.cursorPaddingTop = 30;\n\t\tlet top = targetPos.bottom + this.cursorPaddingTop;\n\n\t\tif (top < 0)\n\t\t{\n\t\t\ttop = 0;\n\t\t}\n\n\t\tDom.adjust(this.getCursor(), {\n\t\t\tstyle: {\n\t\t\t\ttop: top + 'px',\n\t\t\t\tleft: left + 'px'\n\t\t\t}\n\t\t});\n\n\t}\n\n\tanimateCursor()\n\t{\n\t\tconst adjustment = this.cursorPaddingTop + this.getCurrentStep().getTargetPos().height / 2;\n\t\tthis.layout.cursor.style.transform = 'translateY(-' + adjustment + 'px)';\n\t}\n}\n","import { Type } from 'main.core';\nimport { Guide } from './guide.js';\n\nclass Manager\n{\n\tconstructor()\n\t{\n\t\tthis.guides = new Map();\n\t\tthis.autoStartQueue = [];\n\t\tthis.currentGuide = null;\n\t}\n\n\tcreate(options)\n\t{\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tconst id = options.id;\n\t\tif (!Type.isString(id) && id !== '')\n\t\t{\n\t\t\tthrow new Error(\"'id' parameter is required.\");\n\t\t}\n\n\t\tif (this.get(id))\n\t\t{\n\t\t\tthrow new Error(\"The tour instance with the same 'id' already exists.\");\n\t\t}\n\n\t\tconst guide = new Guide(options);\n\t\tthis.guides.set(guide, true);\n\n\t\treturn guide;\n\t}\n\n\tadd(options)\n\t{\n\t\tconst guide = this.create(options);\n\n\t\tguide.subscribe('UI.Tour.Guide:onFinish', () => {\n\t\t\tthis.handleTourFinish(guide);\n\t\t});\n\n\t\tif (this.currentGuide)\n\t\t{\n\t\t\tthis.autoStartQueue.push(guide);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.currentGuide = guide;\n\t\t\tguide.start();\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @param {string} id\n\t * @returns {Guide|null}\n\t */\n\tget(id)\n\t{\n\t\treturn this.guides.get(id);\n\t}\n\n\t/**\n\t * @public\n\t * @param {string} id\n\t */\n\tremove(id)\n\t{\n\t\tthis.guides.delete(id);\n\t}\n\n\t/**\n\t * @public\n\t * @returns {Guide|null}\n\t */\n\tgetCurrentGuide()\n\t{\n\t\treturn this.currentGuide;\n\t}\n\n\t/**\n\t * @private\n\t * @param {Guide} guide\n\t */\n\thandleTourFinish(guide)\n\t{\n\t\tthis.currentGuide = null;\n\t\tthis.remove(guide.getId());\n\n\t\tconst autoStartGuide = this.autoStartQueue.shift();\n\t\tif (autoStartGuide)\n\t\t{\n\t\t\tthis.currentGuide = autoStartGuide;\n\t\t\tautoStartGuide.start();\n\t\t}\n\t}\n}\n\nexport default new Manager();\n"],"names":["GuideConditionColor","WARNING","ALERT","PRIMARY","Step","Event","EventEmitter","constructor","options","target","Type","isString","isFunction","isDomNode","id","text","areaPadding","link","linkTitle","rounded","title","iconSrc","article","position","cursorMode","targetEvent","buttons","condition","events","isPlainObject","eventName","callback","Reflection","getClass","subscribe","getFullEventName","getCondition","getTarget","document","querySelector","getTargetPos","Dom","getPosition","getId","getButtons","getAreaPadding","getRounded","getText","getLink","getLinkTitle","getTitle","getIconSrc","getArticle","getCursorMode","getTargetEvent","shortName","setTarget","initTargetEvent","dispatchEvent","MouseEvent","Guide","steps","Array","isArray","forEach","step","push","length","Error","Text","getRandom","setId","autoSave","popup","layout","overlay","element","closeIcon","right","top","btnContainer","nextBtn","backBtn","content","finalContent","counter","currentCounter","counterItems","onEvents","currentStepIndex","targetPos","clickOnBackBtn","helper","BX","Helper","targetContainer","isBoolean","finalStep","finalText","finalTitle","simpleMode","setAutoSave","cb","bind","window","handleResizeWindow","getAutoSave","mode","save","optionName","userOptions","Math","floor","Date","now","send","start","emit","guide","setOverlay","getPopup","show","getPopupContainer","removeClass","showStep","addClass","getCurrentStep","close","closeStep","destroy","cursor","remove","increaseCurrentStepIndex","body","classList","adjustEvents","setTimeout","style","display","setOverlayElementForm","setCoords","setPopupData","showNextStep","showCursor","currentStep","clickEvent","e","isTrusted","unbind","targetPosWindow","isTargetVisible","scrollToTarget","setPopupPosition","setBindElement","setOffset","offsetLeft","offsetTop","setAngle","adjustPosition","angleOffset","anglePosition","bindOptions","forceTop","forceLeft","forceBindPosition","popupWidth","offsetWidth","clientWidth","documentElement","width","height","left","getAttribute","bindElement","offset","Tag","render","append","node","getBoundingClientRect","setAttribute","padding","textContent","Loc","getMessage","reduceCurrentStepIndex","className","toLowerCase","isObject","color","item","PopupWindowButton","click","event","Popup","getContent","autoHide","noAllPaddings","onPopupClose","destroyed","conditionNodeTop","conditionNodeBottom","getContentContainer","bottom","iconNode","encodeURI","linkNode","getCounterItems","getCurrentCounter","getBtnContainer","unbindAll","innerHTML","handleClickLink","replace","i","preventDefault","onEvent","isOpen","setAutoHide","getSlider","handleClickOnNextBtn","handleClickOnBackBtn","getPreviousStep","setFinalStep","hasClass","finalPopup","getFinalPopup","getFinalContent","maxWidth","minWidth","getFinalBtn","btn","class","innerHeight","clientHeight","innerWidth","scrollTo","y","setCursorPos","animateCursor","getCursor","cursorPaddingTop","adjust","adjustment","transform","ConditionColor","Manager","guides","Map","autoStartQueue","currentGuide","create","get","set","add","handleTourFinish","delete","getCurrentGuide","autoStartGuide","shift"],"mappings":"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"}